Namespace(data_dir='../tsp_input/generated_insatnces_3000_size_50/', tb_dir='../atsp_model_train_result', atsp_size=50, to_homo=False, half_st=False, model='HetroGATConcat', input_dim=1, hidden_dim=128, output_dim=1, relation_types='ss st tt pp', n_gnn_layers=4, n_heads=64, jk='cat', lr_init=0.001, lr_decay=0.95, min_delta=0.0001, patience=200, batch_size=15, n_epochs=100, checkpoint_freq=10, seed=4, n_trials=1, n_samples_result_train=30, device='cuda')
Namespace(atsp_size=100, data_path='../tsp_input/generated_insatnces_30_size_100', model_path='../atsp_model_train_result/Oct15_14-45-35_HetroGATConcat_trained_ATSP50/trial_0', time_limit=0.16, perturbation_moves=5, device='cuda')
device = cuda
model: HetroGATConcat trained in ATSP50 for 100 and tested in ATSP100 for 30
  0%|          | 0/30 [00:00<?, ?it/s]  0%|          | 0/30 [00:01<?, ?it/s, Sum_GNN_time:=0.7403, Sum_Search_time:=0.1608, Avg_Gap_init:=13.5182, Avg_Gap_best:=9.1334, Avg_Cost_init:=1.8177, Avg_Cost_best:=1.7475, Avg_Otpimal_best:=1.6012, Avg_counts: =15.0000]  3%|▎         | 1/30 [00:01<00:36,  1.25s/it, Sum_GNN_time:=0.7403, Sum_Search_time:=0.1608, Avg_Gap_init:=13.5182, Avg_Gap_best:=9.1334, Avg_Cost_init:=1.8177, Avg_Cost_best:=1.7475, Avg_Otpimal_best:=1.6012, Avg_counts: =15.0000]  3%|▎         | 1/30 [00:01<00:36,  1.25s/it, Sum_GNN_time:=0.7970, Sum_Search_time:=0.3257, Avg_Gap_init:=14.3272, Avg_Gap_best:=10.6276, Avg_Cost_init:=1.8705, Avg_Cost_best:=1.8102, Avg_Otpimal_best:=1.6358, Avg_counts: =15.0000]  7%|▋         | 2/30 [00:01<00:21,  1.27it/s, Sum_GNN_time:=0.7970, Sum_Search_time:=0.3257, Avg_Gap_init:=14.3272, Avg_Gap_best:=10.6276, Avg_Cost_init:=1.8705, Avg_Cost_best:=1.8102, Avg_Otpimal_best:=1.6358, Avg_counts: =15.0000]  7%|▋         | 2/30 [00:02<00:21,  1.27it/s, Sum_GNN_time:=0.8531, Sum_Search_time:=0.5051, Avg_Gap_init:=12.8256, Avg_Gap_best:=9.3688, Avg_Cost_init:=1.7717, Avg_Cost_best:=1.7173, Avg_Otpimal_best:=1.5684, Avg_counts: =16.0000]  10%|█         | 3/30 [00:02<00:16,  1.63it/s, Sum_GNN_time:=0.8531, Sum_Search_time:=0.5051, Avg_Gap_init:=12.8256, Avg_Gap_best:=9.3688, Avg_Cost_init:=1.7717, Avg_Cost_best:=1.7173, Avg_Otpimal_best:=1.5684, Avg_counts: =16.0000] 10%|█         | 3/30 [00:02<00:16,  1.63it/s, Sum_GNN_time:=0.9092, Sum_Search_time:=0.6700, Avg_Gap_init:=12.1238, Avg_Gap_best:=8.6971, Avg_Cost_init:=1.7355, Avg_Cost_best:=1.6824, Avg_Otpimal_best:=1.5460, Avg_counts: =14.5000] 13%|█▎        | 4/30 [00:02<00:13,  1.89it/s, Sum_GNN_time:=0.9092, Sum_Search_time:=0.6700, Avg_Gap_init:=12.1238, Avg_Gap_best:=8.6971, Avg_Cost_init:=1.7355, Avg_Cost_best:=1.6824, Avg_Otpimal_best:=1.5460, Avg_counts: =14.5000] 13%|█▎        | 4/30 [00:03<00:13,  1.89it/s, Sum_GNN_time:=0.9653, Sum_Search_time:=0.8471, Avg_Gap_init:=13.7221, Avg_Gap_best:=9.4171, Avg_Cost_init:=1.7397, Avg_Cost_best:=1.6743, Avg_Otpimal_best:=1.5292, Avg_counts: =16.4000] 17%|█▋        | 5/30 [00:03<00:12,  1.95it/s, Sum_GNN_time:=0.9653, Sum_Search_time:=0.8471, Avg_Gap_init:=13.7221, Avg_Gap_best:=9.4171, Avg_Cost_init:=1.7397, Avg_Cost_best:=1.6743, Avg_Otpimal_best:=1.5292, Avg_counts: =16.4000] 17%|█▋        | 5/30 [00:03<00:12,  1.95it/s, Sum_GNN_time:=1.0212, Sum_Search_time:=1.0219, Avg_Gap_init:=13.2874, Avg_Gap_best:=8.7099, Avg_Cost_init:=1.7522, Avg_Cost_best:=1.6815, Avg_Otpimal_best:=1.5465, Avg_counts: =16.6667] 20%|██        | 6/30 [00:03<00:11,  2.10it/s, Sum_GNN_time:=1.0212, Sum_Search_time:=1.0219, Avg_Gap_init:=13.2874, Avg_Gap_best:=8.7099, Avg_Cost_init:=1.7522, Avg_Cost_best:=1.6815, Avg_Otpimal_best:=1.5465, Avg_counts: =16.6667] 20%|██        | 6/30 [00:03<00:11,  2.10it/s, Sum_GNN_time:=1.0763, Sum_Search_time:=1.1840, Avg_Gap_init:=12.8755, Avg_Gap_best:=8.7354, Avg_Cost_init:=1.7744, Avg_Cost_best:=1.7102, Avg_Otpimal_best:=1.5725, Avg_counts: =16.8571] 23%|██▎       | 7/30 [00:03<00:10,  2.24it/s, Sum_GNN_time:=1.0763, Sum_Search_time:=1.1840, Avg_Gap_init:=12.8755, Avg_Gap_best:=8.7354, Avg_Cost_init:=1.7744, Avg_Cost_best:=1.7102, Avg_Otpimal_best:=1.5725, Avg_counts: =16.8571] 23%|██▎       | 7/30 [00:04<00:10,  2.24it/s, Sum_GNN_time:=1.1312, Sum_Search_time:=1.3472, Avg_Gap_init:=13.1325, Avg_Gap_best:=8.8566, Avg_Cost_init:=1.8223, Avg_Cost_best:=1.7538, Avg_Otpimal_best:=1.6105, Avg_counts: =16.2500] 27%|██▋       | 8/30 [00:04<00:09,  2.34it/s, Sum_GNN_time:=1.1312, Sum_Search_time:=1.3472, Avg_Gap_init:=13.1325, Avg_Gap_best:=8.8566, Avg_Cost_init:=1.8223, Avg_Cost_best:=1.7538, Avg_Otpimal_best:=1.6105, Avg_counts: =16.2500] 27%|██▋       | 8/30 [00:04<00:09,  2.34it/s, Sum_GNN_time:=1.1867, Sum_Search_time:=1.5110, Avg_Gap_init:=12.8857, Avg_Gap_best:=8.8626, Avg_Cost_init:=1.8113, Avg_Cost_best:=1.7470, Avg_Otpimal_best:=1.6043, Avg_counts: =16.2222] 30%|███       | 9/30 [00:04<00:08,  2.41it/s, Sum_GNN_time:=1.1867, Sum_Search_time:=1.5110, Avg_Gap_init:=12.8857, Avg_Gap_best:=8.8626, Avg_Cost_init:=1.8113, Avg_Cost_best:=1.7470, Avg_Otpimal_best:=1.6043, Avg_counts: =16.2222] 30%|███       | 9/30 [00:05<00:08,  2.41it/s, Sum_GNN_time:=1.2454, Sum_Search_time:=1.6890, Avg_Gap_init:=12.9012, Avg_Gap_best:=9.0399, Avg_Cost_init:=1.8228, Avg_Cost_best:=1.7608, Avg_Otpimal_best:=1.6142, Avg_counts: =17.0000] 33%|███▎      | 10/30 [00:05<00:08,  2.27it/s, Sum_GNN_time:=1.2454, Sum_Search_time:=1.6890, Avg_Gap_init:=12.9012, Avg_Gap_best:=9.0399, Avg_Cost_init:=1.8228, Avg_Cost_best:=1.7608, Avg_Otpimal_best:=1.6142, Avg_counts: =17.0000] 33%|███▎      | 10/30 [00:05<00:08,  2.27it/s, Sum_GNN_time:=1.3044, Sum_Search_time:=1.8545, Avg_Gap_init:=12.8475, Avg_Gap_best:=9.1165, Avg_Cost_init:=1.8369, Avg_Cost_best:=1.7766, Avg_Otpimal_best:=1.6276, Avg_counts: =17.2727] 37%|███▋      | 11/30 [00:05<00:08,  2.32it/s, Sum_GNN_time:=1.3044, Sum_Search_time:=1.8545, Avg_Gap_init:=12.8475, Avg_Gap_best:=9.1165, Avg_Cost_init:=1.8369, Avg_Cost_best:=1.7766, Avg_Otpimal_best:=1.6276, Avg_counts: =17.2727] 37%|███▋      | 11/30 [00:05<00:08,  2.32it/s, Sum_GNN_time:=1.3639, Sum_Search_time:=2.0269, Avg_Gap_init:=12.2208, Avg_Gap_best:=8.6845, Avg_Cost_init:=1.8047, Avg_Cost_best:=1.7479, Avg_Otpimal_best:=1.6067, Avg_counts: =17.3333] 40%|████      | 12/30 [00:05<00:07,  2.36it/s, Sum_GNN_time:=1.3639, Sum_Search_time:=2.0269, Avg_Gap_init:=12.2208, Avg_Gap_best:=8.6845, Avg_Cost_init:=1.8047, Avg_Cost_best:=1.7479, Avg_Otpimal_best:=1.6067, Avg_counts: =17.3333] 40%|████      | 12/30 [00:06<00:07,  2.36it/s, Sum_GNN_time:=1.4231, Sum_Search_time:=2.2086, Avg_Gap_init:=11.9464, Avg_Gap_best:=8.5539, Avg_Cost_init:=1.7896, Avg_Cost_best:=1.7352, Avg_Otpimal_best:=1.5970, Avg_counts: =17.2308] 43%|████▎     | 13/30 [00:06<00:07,  2.36it/s, Sum_GNN_time:=1.4231, Sum_Search_time:=2.2086, Avg_Gap_init:=11.9464, Avg_Gap_best:=8.5539, Avg_Cost_init:=1.7896, Avg_Cost_best:=1.7352, Avg_Otpimal_best:=1.5970, Avg_counts: =17.2308] 43%|████▎     | 13/30 [00:06<00:07,  2.36it/s, Sum_GNN_time:=1.4818, Sum_Search_time:=2.3781, Avg_Gap_init:=11.8336, Avg_Gap_best:=8.5033, Avg_Cost_init:=1.7888, Avg_Cost_best:=1.7354, Avg_Otpimal_best:=1.5980, Avg_counts: =17.2857] 47%|████▋     | 14/30 [00:06<00:07,  2.25it/s, Sum_GNN_time:=1.4818, Sum_Search_time:=2.3781, Avg_Gap_init:=11.8336, Avg_Gap_best:=8.5033, Avg_Cost_init:=1.7888, Avg_Cost_best:=1.7354, Avg_Otpimal_best:=1.5980, Avg_counts: =17.2857] 47%|████▋     | 14/30 [00:07<00:07,  2.25it/s, Sum_GNN_time:=1.5378, Sum_Search_time:=2.5438, Avg_Gap_init:=11.6091, Avg_Gap_best:=8.3412, Avg_Cost_init:=1.7813, Avg_Cost_best:=1.7290, Avg_Otpimal_best:=1.5945, Avg_counts: =16.9333] 50%|█████     | 15/30 [00:07<00:06,  2.34it/s, Sum_GNN_time:=1.5378, Sum_Search_time:=2.5438, Avg_Gap_init:=11.6091, Avg_Gap_best:=8.3412, Avg_Cost_init:=1.7813, Avg_Cost_best:=1.7290, Avg_Otpimal_best:=1.5945, Avg_counts: =16.9333] 50%|█████     | 15/30 [00:07<00:06,  2.34it/s, Sum_GNN_time:=1.5944, Sum_Search_time:=2.7256, Avg_Gap_init:=11.8540, Avg_Gap_best:=8.2699, Avg_Cost_init:=1.7894, Avg_Cost_best:=1.7317, Avg_Otpimal_best:=1.5982, Avg_counts: =17.3750] 53%|█████▎    | 16/30 [00:07<00:05,  2.37it/s, Sum_GNN_time:=1.5944, Sum_Search_time:=2.7256, Avg_Gap_init:=11.8540, Avg_Gap_best:=8.2699, Avg_Cost_init:=1.7894, Avg_Cost_best:=1.7317, Avg_Otpimal_best:=1.5982, Avg_counts: =17.3750] 53%|█████▎    | 16/30 [00:07<00:05,  2.37it/s, Sum_GNN_time:=1.6495, Sum_Search_time:=2.8881, Avg_Gap_init:=11.9716, Avg_Gap_best:=8.2776, Avg_Cost_init:=1.7940, Avg_Cost_best:=1.7345, Avg_Otpimal_best:=1.6007, Avg_counts: =17.4118] 57%|█████▋    | 17/30 [00:07<00:05,  2.44it/s, Sum_GNN_time:=1.6495, Sum_Search_time:=2.8881, Avg_Gap_init:=11.9716, Avg_Gap_best:=8.2776, Avg_Cost_init:=1.7940, Avg_Cost_best:=1.7345, Avg_Otpimal_best:=1.6007, Avg_counts: =17.4118] 57%|█████▋    | 17/30 [00:08<00:05,  2.44it/s, Sum_GNN_time:=1.7060, Sum_Search_time:=3.0552, Avg_Gap_init:=11.8433, Avg_Gap_best:=8.1159, Avg_Cost_init:=1.7883, Avg_Cost_best:=1.7285, Avg_Otpimal_best:=1.5975, Avg_counts: =17.4444] 60%|██████    | 18/30 [00:08<00:04,  2.47it/s, Sum_GNN_time:=1.7060, Sum_Search_time:=3.0552, Avg_Gap_init:=11.8433, Avg_Gap_best:=8.1159, Avg_Cost_init:=1.7883, Avg_Cost_best:=1.7285, Avg_Otpimal_best:=1.5975, Avg_counts: =17.4444] 60%|██████    | 18/30 [00:08<00:04,  2.47it/s, Sum_GNN_time:=1.7630, Sum_Search_time:=3.2206, Avg_Gap_init:=11.8435, Avg_Gap_best:=8.2229, Avg_Cost_init:=1.7787, Avg_Cost_best:=1.7207, Avg_Otpimal_best:=1.5890, Avg_counts: =17.4737] 63%|██████▎   | 19/30 [00:08<00:04,  2.33it/s, Sum_GNN_time:=1.7630, Sum_Search_time:=3.2206, Avg_Gap_init:=11.8435, Avg_Gap_best:=8.2229, Avg_Cost_init:=1.7787, Avg_Cost_best:=1.7207, Avg_Otpimal_best:=1.5890, Avg_counts: =17.4737] 63%|██████▎   | 19/30 [00:09<00:04,  2.33it/s, Sum_GNN_time:=1.8194, Sum_Search_time:=3.3872, Avg_Gap_init:=11.5615, Avg_Gap_best:=8.0959, Avg_Cost_init:=1.7714, Avg_Cost_best:=1.7159, Avg_Otpimal_best:=1.5864, Avg_counts: =17.4000] 67%|██████▋   | 20/30 [00:09<00:04,  2.40it/s, Sum_GNN_time:=1.8194, Sum_Search_time:=3.3872, Avg_Gap_init:=11.5615, Avg_Gap_best:=8.0959, Avg_Cost_init:=1.7714, Avg_Cost_best:=1.7159, Avg_Otpimal_best:=1.5864, Avg_counts: =17.4000] 67%|██████▋   | 20/30 [00:09<00:04,  2.40it/s, Sum_GNN_time:=1.8785, Sum_Search_time:=3.5582, Avg_Gap_init:=11.6122, Avg_Gap_best:=7.9594, Avg_Cost_init:=1.7571, Avg_Cost_best:=1.6997, Avg_Otpimal_best:=1.5731, Avg_counts: =17.4286] 70%|███████   | 21/30 [00:09<00:03,  2.41it/s, Sum_GNN_time:=1.8785, Sum_Search_time:=3.5582, Avg_Gap_init:=11.6122, Avg_Gap_best:=7.9594, Avg_Cost_init:=1.7571, Avg_Cost_best:=1.6997, Avg_Otpimal_best:=1.5731, Avg_counts: =17.4286] 70%|███████   | 21/30 [00:10<00:03,  2.41it/s, Sum_GNN_time:=1.9349, Sum_Search_time:=3.7261, Avg_Gap_init:=11.5174, Avg_Gap_best:=7.8734, Avg_Cost_init:=1.7633, Avg_Cost_best:=1.7057, Avg_Otpimal_best:=1.5801, Avg_counts: =17.4545] 73%|███████▎  | 22/30 [00:10<00:03,  2.43it/s, Sum_GNN_time:=1.9349, Sum_Search_time:=3.7261, Avg_Gap_init:=11.5174, Avg_Gap_best:=7.8734, Avg_Cost_init:=1.7633, Avg_Cost_best:=1.7057, Avg_Otpimal_best:=1.5801, Avg_counts: =17.4545] 73%|███████▎  | 22/30 [00:10<00:03,  2.43it/s, Sum_GNN_time:=1.9941, Sum_Search_time:=3.9062, Avg_Gap_init:=11.2831, Avg_Gap_best:=7.7632, Avg_Cost_init:=1.7581, Avg_Cost_best:=1.7025, Avg_Otpimal_best:=1.5788, Avg_counts: =17.4783] 77%|███████▋  | 23/30 [00:10<00:02,  2.41it/s, Sum_GNN_time:=1.9941, Sum_Search_time:=3.9062, Avg_Gap_init:=11.2831, Avg_Gap_best:=7.7632, Avg_Cost_init:=1.7581, Avg_Cost_best:=1.7025, Avg_Otpimal_best:=1.5788, Avg_counts: =17.4783] 77%|███████▋  | 23/30 [00:10<00:02,  2.41it/s, Sum_GNN_time:=2.0513, Sum_Search_time:=4.0664, Avg_Gap_init:=11.5182, Avg_Gap_best:=7.9654, Avg_Cost_init:=1.7591, Avg_Cost_best:=1.7031, Avg_Otpimal_best:=1.5765, Avg_counts: =17.1667] 80%|████████  | 24/30 [00:10<00:02,  2.30it/s, Sum_GNN_time:=2.0513, Sum_Search_time:=4.0664, Avg_Gap_init:=11.5182, Avg_Gap_best:=7.9654, Avg_Cost_init:=1.7591, Avg_Cost_best:=1.7031, Avg_Otpimal_best:=1.5765, Avg_counts: =17.1667] 80%|████████  | 24/30 [00:11<00:02,  2.30it/s, Sum_GNN_time:=2.1072, Sum_Search_time:=4.2446, Avg_Gap_init:=11.5477, Avg_Gap_best:=7.8798, Avg_Cost_init:=1.7529, Avg_Cost_best:=1.6955, Avg_Otpimal_best:=1.5706, Avg_counts: =17.4400] 83%|████████▎ | 25/30 [00:11<00:02,  2.35it/s, Sum_GNN_time:=2.1072, Sum_Search_time:=4.2446, Avg_Gap_init:=11.5477, Avg_Gap_best:=7.8798, Avg_Cost_init:=1.7529, Avg_Cost_best:=1.6955, Avg_Otpimal_best:=1.5706, Avg_counts: =17.4400] 83%|████████▎ | 25/30 [00:11<00:02,  2.35it/s, Sum_GNN_time:=2.1648, Sum_Search_time:=4.4180, Avg_Gap_init:=11.3578, Avg_Gap_best:=7.8126, Avg_Cost_init:=1.7457, Avg_Cost_best:=1.6902, Avg_Otpimal_best:=1.5667, Avg_counts: =17.4615] 87%|████████▋ | 26/30 [00:11<00:01,  2.39it/s, Sum_GNN_time:=2.1648, Sum_Search_time:=4.4180, Avg_Gap_init:=11.3578, Avg_Gap_best:=7.8126, Avg_Cost_init:=1.7457, Avg_Cost_best:=1.6902, Avg_Otpimal_best:=1.5667, Avg_counts: =17.4615] 87%|████████▋ | 26/30 [00:12<00:01,  2.39it/s, Sum_GNN_time:=2.2198, Sum_Search_time:=4.5791, Avg_Gap_init:=11.3107, Avg_Gap_best:=7.8968, Avg_Cost_init:=1.7399, Avg_Cost_best:=1.6864, Avg_Otpimal_best:=1.5621, Avg_counts: =17.4074] 90%|█████████ | 27/30 [00:12<00:01,  2.45it/s, Sum_GNN_time:=2.2198, Sum_Search_time:=4.5791, Avg_Gap_init:=11.3107, Avg_Gap_best:=7.8968, Avg_Cost_init:=1.7399, Avg_Cost_best:=1.6864, Avg_Otpimal_best:=1.5621, Avg_counts: =17.4074] 90%|█████████ | 27/30 [00:12<00:01,  2.45it/s, Sum_GNN_time:=2.2761, Sum_Search_time:=4.7572, Avg_Gap_init:=11.2604, Avg_Gap_best:=7.8381, Avg_Cost_init:=1.7374, Avg_Cost_best:=1.6839, Avg_Otpimal_best:=1.5606, Avg_counts: =17.6429] 93%|█████████▎| 28/30 [00:12<00:00,  2.45it/s, Sum_GNN_time:=2.2761, Sum_Search_time:=4.7572, Avg_Gap_init:=11.2604, Avg_Gap_best:=7.8381, Avg_Cost_init:=1.7374, Avg_Cost_best:=1.6839, Avg_Otpimal_best:=1.5606, Avg_counts: =17.6429] 93%|█████████▎| 28/30 [00:13<00:00,  2.45it/s, Sum_GNN_time:=2.3344, Sum_Search_time:=4.9305, Avg_Gap_init:=11.3544, Avg_Gap_best:=7.9115, Avg_Cost_init:=1.7421, Avg_Cost_best:=1.6881, Avg_Otpimal_best:=1.5635, Avg_counts: =17.8621] 97%|█████████▋| 29/30 [00:13<00:00,  2.31it/s, Sum_GNN_time:=2.3344, Sum_Search_time:=4.9305, Avg_Gap_init:=11.3544, Avg_Gap_best:=7.9115, Avg_Cost_init:=1.7421, Avg_Cost_best:=1.6881, Avg_Otpimal_best:=1.5635, Avg_counts: =17.8621] 97%|█████████▋| 29/30 [00:13<00:00,  2.31it/s, Sum_GNN_time:=2.3900, Sum_Search_time:=5.1042, Avg_Gap_init:=11.4942, Avg_Gap_best:=7.9839, Avg_Cost_init:=1.7418, Avg_Cost_best:=1.6869, Avg_Otpimal_best:=1.5613, Avg_counts: =18.0667]100%|██████████| 30/30 [00:13<00:00,  2.36it/s, Sum_GNN_time:=2.3900, Sum_Search_time:=5.1042, Avg_Gap_init:=11.4942, Avg_Gap_best:=7.9839, Avg_Cost_init:=1.7418, Avg_Cost_best:=1.6869, Avg_Otpimal_best:=1.5613, Avg_counts: =18.0667]100%|██████████| 30/30 [00:13<00:00,  2.23it/s, Sum_GNN_time:=2.3900, Sum_Search_time:=5.1042, Avg_Gap_init:=11.4942, Avg_Gap_best:=7.9839, Avg_Cost_init:=1.7418, Avg_Cost_best:=1.6869, Avg_Otpimal_best:=1.5613, Avg_counts: =18.0667]
Total time for model prediction: 2.3900 seconds
Total time for guided local search: 5.1042 seconds
