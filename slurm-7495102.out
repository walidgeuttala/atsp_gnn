Namespace(data_dir='../tsp_input/generated_insatnces_3000_size_50/', tb_dir='../atsp_model_train_result', atsp_size=50, to_homo=False, half_st=True, model='HetroGATConcat', input_dim=1, hidden_dim=128, output_dim=1, relation_types='ss st tt pp', n_gnn_layers=4, n_heads=64, jk='cat', lr_init=0.001, lr_decay=0.95, min_delta=0.0001, patience=200, batch_size=15, n_epochs=100, checkpoint_freq=10, seed=4, n_trials=1, n_samples_result_train=30, device='cuda')
Namespace(atsp_size=100, data_path='../tsp_input/generated_insatnces_30_size_100', model_path='../atsp_model_train_result/Oct15_17-24-54_HetroGATConcat_trained_ATSP50/trial_0', time_limit=0.16, perturbation_moves=5, device='cuda')
device = cuda
model: HetroGATConcat trained in ATSP50 for 100 and tested in ATSP100 for 30
  0%|          | 0/30 [00:00<?, ?it/s]  0%|          | 0/30 [00:04<?, ?it/s, Sum_GNN_time:=2.7080, Sum_Search_time:=0.1667, Avg_Gap_init:=10.5934, Avg_Gap_best:=10.1508, Avg_Cost_init:=1.7708, Avg_Cost_best:=1.7638, Avg_Otpimal_best:=1.6012, Avg_counts: =18.0000]  3%|▎         | 1/30 [00:04<01:59,  4.11s/it, Sum_GNN_time:=2.7080, Sum_Search_time:=0.1667, Avg_Gap_init:=10.5934, Avg_Gap_best:=10.1508, Avg_Cost_init:=1.7708, Avg_Cost_best:=1.7638, Avg_Otpimal_best:=1.6012, Avg_counts: =18.0000]  3%|▎         | 1/30 [00:04<01:59,  4.11s/it, Sum_GNN_time:=2.7591, Sum_Search_time:=0.3273, Avg_Gap_init:=13.8056, Avg_Gap_best:=9.2557, Avg_Cost_init:=1.8628, Avg_Cost_best:=1.7869, Avg_Otpimal_best:=1.6358, Avg_counts: =18.0000]   7%|▋         | 2/30 [00:04<00:54,  1.95s/it, Sum_GNN_time:=2.7591, Sum_Search_time:=0.3273, Avg_Gap_init:=13.8056, Avg_Gap_best:=9.2557, Avg_Cost_init:=1.8628, Avg_Cost_best:=1.7869, Avg_Otpimal_best:=1.6358, Avg_counts: =18.0000]  7%|▋         | 2/30 [00:04<00:54,  1.95s/it, Sum_GNN_time:=2.8100, Sum_Search_time:=0.4882, Avg_Gap_init:=12.5406, Avg_Gap_best:=9.3276, Avg_Cost_init:=1.7675, Avg_Cost_best:=1.7143, Avg_Otpimal_best:=1.5684, Avg_counts: =17.3333] 10%|█         | 3/30 [00:04<00:33,  1.24s/it, Sum_GNN_time:=2.8100, Sum_Search_time:=0.4882, Avg_Gap_init:=12.5406, Avg_Gap_best:=9.3276, Avg_Cost_init:=1.7675, Avg_Cost_best:=1.7143, Avg_Otpimal_best:=1.5684, Avg_counts: =17.3333] 10%|█         | 3/30 [00:05<00:33,  1.24s/it, Sum_GNN_time:=2.8615, Sum_Search_time:=0.6488, Avg_Gap_init:=11.6564, Avg_Gap_best:=8.8097, Avg_Cost_init:=1.7286, Avg_Cost_best:=1.6823, Avg_Otpimal_best:=1.5460, Avg_counts: =17.0000] 13%|█▎        | 4/30 [00:05<00:23,  1.11it/s, Sum_GNN_time:=2.8615, Sum_Search_time:=0.6488, Avg_Gap_init:=11.6564, Avg_Gap_best:=8.8097, Avg_Cost_init:=1.7286, Avg_Cost_best:=1.6823, Avg_Otpimal_best:=1.5460, Avg_counts: =17.0000] 13%|█▎        | 4/30 [00:05<00:23,  1.11it/s, Sum_GNN_time:=2.9130, Sum_Search_time:=0.8100, Avg_Gap_init:=10.7917, Avg_Gap_best:=7.9704, Avg_Cost_init:=1.6967, Avg_Cost_best:=1.6517, Avg_Otpimal_best:=1.5292, Avg_counts: =17.2000] 17%|█▋        | 5/30 [00:05<00:18,  1.35it/s, Sum_GNN_time:=2.9130, Sum_Search_time:=0.8100, Avg_Gap_init:=10.7917, Avg_Gap_best:=7.9704, Avg_Cost_init:=1.6967, Avg_Cost_best:=1.6517, Avg_Otpimal_best:=1.5292, Avg_counts: =17.2000] 17%|█▋        | 5/30 [00:06<00:18,  1.35it/s, Sum_GNN_time:=2.9642, Sum_Search_time:=0.9730, Avg_Gap_init:=11.3344, Avg_Gap_best:=8.0148, Avg_Cost_init:=1.7244, Avg_Cost_best:=1.6711, Avg_Otpimal_best:=1.5465, Avg_counts: =16.8333] 20%|██        | 6/30 [00:06<00:14,  1.61it/s, Sum_GNN_time:=2.9642, Sum_Search_time:=0.9730, Avg_Gap_init:=11.3344, Avg_Gap_best:=8.0148, Avg_Cost_init:=1.7244, Avg_Cost_best:=1.6711, Avg_Otpimal_best:=1.5465, Avg_counts: =16.8333] 20%|██        | 6/30 [00:06<00:14,  1.61it/s, Sum_GNN_time:=3.0151, Sum_Search_time:=1.1587, Avg_Gap_init:=10.8823, Avg_Gap_best:=7.6654, Avg_Cost_init:=1.7451, Avg_Cost_best:=1.6930, Avg_Otpimal_best:=1.5725, Avg_counts: =17.5714] 23%|██▎       | 7/30 [00:06<00:12,  1.81it/s, Sum_GNN_time:=3.0151, Sum_Search_time:=1.1587, Avg_Gap_init:=10.8823, Avg_Gap_best:=7.6654, Avg_Cost_init:=1.7451, Avg_Cost_best:=1.6930, Avg_Otpimal_best:=1.5725, Avg_counts: =17.5714] 23%|██▎       | 7/30 [00:06<00:12,  1.81it/s, Sum_GNN_time:=3.0709, Sum_Search_time:=1.3255, Avg_Gap_init:=11.3643, Avg_Gap_best:=7.9732, Avg_Cost_init:=1.7962, Avg_Cost_best:=1.7397, Avg_Otpimal_best:=1.6105, Avg_counts: =17.5000] 27%|██▋       | 8/30 [00:06<00:11,  1.97it/s, Sum_GNN_time:=3.0709, Sum_Search_time:=1.3255, Avg_Gap_init:=11.3643, Avg_Gap_best:=7.9732, Avg_Cost_init:=1.7962, Avg_Cost_best:=1.7397, Avg_Otpimal_best:=1.6105, Avg_counts: =17.5000] 27%|██▋       | 8/30 [00:07<00:11,  1.97it/s, Sum_GNN_time:=3.1235, Sum_Search_time:=1.4879, Avg_Gap_init:=11.8110, Avg_Gap_best:=8.5352, Avg_Cost_init:=1.7958, Avg_Cost_best:=1.7416, Avg_Otpimal_best:=1.6043, Avg_counts: =17.5556] 30%|███       | 9/30 [00:07<00:09,  2.12it/s, Sum_GNN_time:=3.1235, Sum_Search_time:=1.4879, Avg_Gap_init:=11.8110, Avg_Gap_best:=8.5352, Avg_Cost_init:=1.7958, Avg_Cost_best:=1.7416, Avg_Otpimal_best:=1.6043, Avg_counts: =17.5556] 30%|███       | 9/30 [00:07<00:09,  2.12it/s, Sum_GNN_time:=3.1748, Sum_Search_time:=1.6489, Avg_Gap_init:=11.3918, Avg_Gap_best:=8.3979, Avg_Cost_init:=1.7996, Avg_Cost_best:=1.7501, Avg_Otpimal_best:=1.6142, Avg_counts: =17.4000] 33%|███▎      | 10/30 [00:07<00:09,  2.13it/s, Sum_GNN_time:=3.1748, Sum_Search_time:=1.6489, Avg_Gap_init:=11.3918, Avg_Gap_best:=8.3979, Avg_Cost_init:=1.7996, Avg_Cost_best:=1.7501, Avg_Otpimal_best:=1.6142, Avg_counts: =17.4000] 33%|███▎      | 10/30 [00:08<00:09,  2.13it/s, Sum_GNN_time:=3.2260, Sum_Search_time:=1.8091, Avg_Gap_init:=11.6174, Avg_Gap_best:=8.8927, Avg_Cost_init:=1.8183, Avg_Cost_best:=1.7732, Avg_Otpimal_best:=1.6276, Avg_counts: =17.4545] 37%|███▋      | 11/30 [00:08<00:08,  2.26it/s, Sum_GNN_time:=3.2260, Sum_Search_time:=1.8091, Avg_Gap_init:=11.6174, Avg_Gap_best:=8.8927, Avg_Cost_init:=1.8183, Avg_Cost_best:=1.7732, Avg_Otpimal_best:=1.6276, Avg_counts: =17.4545] 37%|███▋      | 11/30 [00:08<00:08,  2.26it/s, Sum_GNN_time:=3.2773, Sum_Search_time:=1.9698, Avg_Gap_init:=11.0201, Avg_Gap_best:=8.5224, Avg_Cost_init:=1.7867, Avg_Cost_best:=1.7453, Avg_Otpimal_best:=1.6067, Avg_counts: =17.3333] 40%|████      | 12/30 [00:08<00:07,  2.36it/s, Sum_GNN_time:=3.2773, Sum_Search_time:=1.9698, Avg_Gap_init:=11.0201, Avg_Gap_best:=8.5224, Avg_Cost_init:=1.7867, Avg_Cost_best:=1.7453, Avg_Otpimal_best:=1.6067, Avg_counts: =17.3333] 40%|████      | 12/30 [00:08<00:07,  2.36it/s, Sum_GNN_time:=3.3284, Sum_Search_time:=2.1308, Avg_Gap_init:=11.1704, Avg_Gap_best:=8.8306, Avg_Cost_init:=1.7779, Avg_Cost_best:=1.7392, Avg_Otpimal_best:=1.5970, Avg_counts: =17.2308] 43%|████▎     | 13/30 [00:08<00:06,  2.43it/s, Sum_GNN_time:=3.3284, Sum_Search_time:=2.1308, Avg_Gap_init:=11.1704, Avg_Gap_best:=8.8306, Avg_Cost_init:=1.7779, Avg_Cost_best:=1.7392, Avg_Otpimal_best:=1.5970, Avg_counts: =17.2308] 43%|████▎     | 13/30 [00:09<00:06,  2.43it/s, Sum_GNN_time:=3.3800, Sum_Search_time:=2.3044, Avg_Gap_init:=11.4696, Avg_Gap_best:=8.8776, Avg_Cost_init:=1.7836, Avg_Cost_best:=1.7409, Avg_Otpimal_best:=1.5980, Avg_counts: =17.7143] 47%|████▋     | 14/30 [00:09<00:06,  2.31it/s, Sum_GNN_time:=3.3800, Sum_Search_time:=2.3044, Avg_Gap_init:=11.4696, Avg_Gap_best:=8.8776, Avg_Cost_init:=1.7836, Avg_Cost_best:=1.7409, Avg_Otpimal_best:=1.5980, Avg_counts: =17.7143] 47%|████▋     | 14/30 [00:09<00:06,  2.31it/s, Sum_GNN_time:=3.4324, Sum_Search_time:=2.4909, Avg_Gap_init:=11.1636, Avg_Gap_best:=8.7444, Avg_Cost_init:=1.7749, Avg_Cost_best:=1.7351, Avg_Otpimal_best:=1.5945, Avg_counts: =17.8667] 50%|█████     | 15/30 [00:09<00:06,  2.34it/s, Sum_GNN_time:=3.4324, Sum_Search_time:=2.4909, Avg_Gap_init:=11.1636, Avg_Gap_best:=8.7444, Avg_Cost_init:=1.7749, Avg_Cost_best:=1.7351, Avg_Otpimal_best:=1.5945, Avg_counts: =17.8667] 50%|█████     | 15/30 [00:10<00:06,  2.34it/s, Sum_GNN_time:=3.4844, Sum_Search_time:=2.6515, Avg_Gap_init:=11.3005, Avg_Gap_best:=8.7353, Avg_Cost_init:=1.7811, Avg_Cost_best:=1.7388, Avg_Otpimal_best:=1.5982, Avg_counts: =17.6250] 53%|█████▎    | 16/30 [00:10<00:05,  2.41it/s, Sum_GNN_time:=3.4844, Sum_Search_time:=2.6515, Avg_Gap_init:=11.3005, Avg_Gap_best:=8.7353, Avg_Cost_init:=1.7811, Avg_Cost_best:=1.7388, Avg_Otpimal_best:=1.5982, Avg_counts: =17.6250] 53%|█████▎    | 16/30 [00:10<00:05,  2.41it/s, Sum_GNN_time:=3.5371, Sum_Search_time:=2.8119, Avg_Gap_init:=11.5557, Avg_Gap_best:=8.8288, Avg_Cost_init:=1.7879, Avg_Cost_best:=1.7430, Avg_Otpimal_best:=1.6007, Avg_counts: =17.6471] 57%|█████▋    | 17/30 [00:10<00:05,  2.46it/s, Sum_GNN_time:=3.5371, Sum_Search_time:=2.8119, Avg_Gap_init:=11.5557, Avg_Gap_best:=8.8288, Avg_Cost_init:=1.7879, Avg_Cost_best:=1.7430, Avg_Otpimal_best:=1.6007, Avg_counts: =17.6471] 57%|█████▋    | 17/30 [00:11<00:05,  2.46it/s, Sum_GNN_time:=3.5881, Sum_Search_time:=2.9740, Avg_Gap_init:=11.5388, Avg_Gap_best:=8.7260, Avg_Cost_init:=1.7840, Avg_Cost_best:=1.7379, Avg_Otpimal_best:=1.5975, Avg_counts: =17.5556] 60%|██████    | 18/30 [00:11<00:04,  2.46it/s, Sum_GNN_time:=3.5881, Sum_Search_time:=2.9740, Avg_Gap_init:=11.5388, Avg_Gap_best:=8.7260, Avg_Cost_init:=1.7840, Avg_Cost_best:=1.7379, Avg_Otpimal_best:=1.5975, Avg_counts: =17.5556] 60%|██████    | 18/30 [00:11<00:04,  2.46it/s, Sum_GNN_time:=3.6396, Sum_Search_time:=3.1416, Avg_Gap_init:=11.3616, Avg_Gap_best:=8.6791, Avg_Cost_init:=1.7718, Avg_Cost_best:=1.7279, Avg_Otpimal_best:=1.5890, Avg_counts: =17.4737] 63%|██████▎   | 19/30 [00:11<00:04,  2.31it/s, Sum_GNN_time:=3.6396, Sum_Search_time:=3.1416, Avg_Gap_init:=11.3616, Avg_Gap_best:=8.6791, Avg_Cost_init:=1.7718, Avg_Cost_best:=1.7279, Avg_Otpimal_best:=1.5890, Avg_counts: =17.4737] 63%|██████▎   | 19/30 [00:11<00:04,  2.31it/s, Sum_GNN_time:=3.6949, Sum_Search_time:=3.3229, Avg_Gap_init:=11.3079, Avg_Gap_best:=8.6256, Avg_Cost_init:=1.7680, Avg_Cost_best:=1.7242, Avg_Otpimal_best:=1.5864, Avg_counts: =17.4000] 67%|██████▋   | 20/30 [00:11<00:04,  2.33it/s, Sum_GNN_time:=3.6949, Sum_Search_time:=3.3229, Avg_Gap_init:=11.3079, Avg_Gap_best:=8.6256, Avg_Cost_init:=1.7680, Avg_Cost_best:=1.7242, Avg_Otpimal_best:=1.5864, Avg_counts: =17.4000] 67%|██████▋   | 20/30 [00:12<00:04,  2.33it/s, Sum_GNN_time:=3.7472, Sum_Search_time:=3.4967, Avg_Gap_init:=12.0033, Avg_Gap_best:=8.9546, Avg_Cost_init:=1.7621, Avg_Cost_best:=1.7140, Avg_Otpimal_best:=1.5731, Avg_counts: =17.7143] 70%|███████   | 21/30 [00:12<00:03,  2.38it/s, Sum_GNN_time:=3.7472, Sum_Search_time:=3.4967, Avg_Gap_init:=12.0033, Avg_Gap_best:=8.9546, Avg_Cost_init:=1.7621, Avg_Cost_best:=1.7140, Avg_Otpimal_best:=1.5731, Avg_counts: =17.7143] 70%|███████   | 21/30 [00:12<00:03,  2.38it/s, Sum_GNN_time:=3.8024, Sum_Search_time:=3.6631, Avg_Gap_init:=11.9769, Avg_Gap_best:=8.9028, Avg_Cost_init:=1.7695, Avg_Cost_best:=1.7207, Avg_Otpimal_best:=1.5801, Avg_counts: =17.5909] 73%|███████▎  | 22/30 [00:12<00:03,  2.42it/s, Sum_GNN_time:=3.8024, Sum_Search_time:=3.6631, Avg_Gap_init:=11.9769, Avg_Gap_best:=8.9028, Avg_Cost_init:=1.7695, Avg_Cost_best:=1.7207, Avg_Otpimal_best:=1.5801, Avg_counts: =17.5909] 73%|███████▎  | 22/30 [00:13<00:03,  2.42it/s, Sum_GNN_time:=3.8552, Sum_Search_time:=3.8455, Avg_Gap_init:=11.6981, Avg_Gap_best:=8.6881, Avg_Cost_init:=1.7637, Avg_Cost_best:=1.7160, Avg_Otpimal_best:=1.5788, Avg_counts: =17.7826] 77%|███████▋  | 23/30 [00:13<00:02,  2.43it/s, Sum_GNN_time:=3.8552, Sum_Search_time:=3.8455, Avg_Gap_init:=11.6981, Avg_Gap_best:=8.6881, Avg_Cost_init:=1.7637, Avg_Cost_best:=1.7160, Avg_Otpimal_best:=1.5788, Avg_counts: =17.7826] 77%|███████▋  | 23/30 [00:13<00:02,  2.43it/s, Sum_GNN_time:=3.9067, Sum_Search_time:=4.0070, Avg_Gap_init:=11.8028, Avg_Gap_best:=8.8524, Avg_Cost_init:=1.7627, Avg_Cost_best:=1.7160, Avg_Otpimal_best:=1.5765, Avg_counts: =17.7917] 80%|████████  | 24/30 [00:13<00:02,  2.32it/s, Sum_GNN_time:=3.9067, Sum_Search_time:=4.0070, Avg_Gap_init:=11.8028, Avg_Gap_best:=8.8524, Avg_Cost_init:=1.7627, Avg_Cost_best:=1.7160, Avg_Otpimal_best:=1.5765, Avg_counts: =17.7917] 80%|████████  | 24/30 [00:14<00:02,  2.32it/s, Sum_GNN_time:=3.9577, Sum_Search_time:=4.1808, Avg_Gap_init:=11.9485, Avg_Gap_best:=8.7202, Avg_Cost_init:=1.7583, Avg_Cost_best:=1.7077, Avg_Otpimal_best:=1.5706, Avg_counts: =18.0400] 83%|████████▎ | 25/30 [00:14<00:02,  2.38it/s, Sum_GNN_time:=3.9577, Sum_Search_time:=4.1808, Avg_Gap_init:=11.9485, Avg_Gap_best:=8.7202, Avg_Cost_init:=1.7583, Avg_Cost_best:=1.7077, Avg_Otpimal_best:=1.5706, Avg_counts: =18.0400] 83%|████████▎ | 25/30 [00:14<00:02,  2.38it/s, Sum_GNN_time:=4.0091, Sum_Search_time:=4.3428, Avg_Gap_init:=11.9070, Avg_Gap_best:=8.6848, Avg_Cost_init:=1.7532, Avg_Cost_best:=1.7029, Avg_Otpimal_best:=1.5667, Avg_counts: =18.0385] 87%|████████▋ | 26/30 [00:14<00:01,  2.45it/s, Sum_GNN_time:=4.0091, Sum_Search_time:=4.3428, Avg_Gap_init:=11.9070, Avg_Gap_best:=8.6848, Avg_Cost_init:=1.7532, Avg_Cost_best:=1.7029, Avg_Otpimal_best:=1.5667, Avg_counts: =18.0385] 87%|████████▋ | 26/30 [00:14<00:01,  2.45it/s, Sum_GNN_time:=4.0606, Sum_Search_time:=4.5046, Avg_Gap_init:=11.9036, Avg_Gap_best:=8.5951, Avg_Cost_init:=1.7480, Avg_Cost_best:=1.6966, Avg_Otpimal_best:=1.5621, Avg_counts: =18.0370] 90%|█████████ | 27/30 [00:14<00:01,  2.49it/s, Sum_GNN_time:=4.0606, Sum_Search_time:=4.5046, Avg_Gap_init:=11.9036, Avg_Gap_best:=8.5951, Avg_Cost_init:=1.7480, Avg_Cost_best:=1.6966, Avg_Otpimal_best:=1.5621, Avg_counts: =18.0370] 90%|█████████ | 27/30 [00:15<00:01,  2.49it/s, Sum_GNN_time:=4.1113, Sum_Search_time:=4.6683, Avg_Gap_init:=11.8396, Avg_Gap_best:=8.6492, Avg_Cost_init:=1.7454, Avg_Cost_best:=1.6958, Avg_Otpimal_best:=1.5606, Avg_counts: =18.0357] 93%|█████████▎| 28/30 [00:15<00:00,  2.52it/s, Sum_GNN_time:=4.1113, Sum_Search_time:=4.6683, Avg_Gap_init:=11.8396, Avg_Gap_best:=8.6492, Avg_Cost_init:=1.7454, Avg_Cost_best:=1.6958, Avg_Otpimal_best:=1.5606, Avg_counts: =18.0357] 93%|█████████▎| 28/30 [00:15<00:00,  2.52it/s, Sum_GNN_time:=4.1628, Sum_Search_time:=4.8343, Avg_Gap_init:=11.9856, Avg_Gap_best:=8.6457, Avg_Cost_init:=1.7510, Avg_Cost_best:=1.6989, Avg_Otpimal_best:=1.5635, Avg_counts: =17.9655] 97%|█████████▋| 29/30 [00:15<00:00,  2.37it/s, Sum_GNN_time:=4.1628, Sum_Search_time:=4.8343, Avg_Gap_init:=11.9856, Avg_Gap_best:=8.6457, Avg_Cost_init:=1.7510, Avg_Cost_best:=1.6989, Avg_Otpimal_best:=1.5635, Avg_counts: =17.9655] 97%|█████████▋| 29/30 [00:16<00:00,  2.37it/s, Sum_GNN_time:=4.2141, Sum_Search_time:=5.0084, Avg_Gap_init:=12.0830, Avg_Gap_best:=8.6943, Avg_Cost_init:=1.7501, Avg_Cost_best:=1.6973, Avg_Otpimal_best:=1.5613, Avg_counts: =18.1667]100%|██████████| 30/30 [00:16<00:00,  2.41it/s, Sum_GNN_time:=4.2141, Sum_Search_time:=5.0084, Avg_Gap_init:=12.0830, Avg_Gap_best:=8.6943, Avg_Cost_init:=1.7501, Avg_Cost_best:=1.6973, Avg_Otpimal_best:=1.5613, Avg_counts: =18.1667]100%|██████████| 30/30 [00:16<00:00,  1.86it/s, Sum_GNN_time:=4.2141, Sum_Search_time:=5.0084, Avg_Gap_init:=12.0830, Avg_Gap_best:=8.6943, Avg_Cost_init:=1.7501, Avg_Cost_best:=1.6973, Avg_Otpimal_best:=1.5613, Avg_counts: =18.1667]
Total time for model prediction: 4.2141 seconds
Total time for guided local search: 5.0084 seconds
