Namespace(data_dir='../tsp_input/generated_insatnces_3000_size_50/', tb_dir='../atsp_model_train_result', atsp_size=50, to_homo=False, half_st=False, model='HetroGATSum', input_dim=1, hidden_dim=128, output_dim=1, relation_types='ss st tt pp', n_gnn_layers=4, n_heads=64, jk='cat', lr_init=0.001, lr_decay=0.95, min_delta=0.0001, patience=200, batch_size=15, n_epochs=100, checkpoint_freq=10, seed=4, n_trials=1, n_samples_result_train=30, device='cuda')
Namespace(atsp_size=100, data_path='../tsp_input/generated_insatnces_30_size_100', model_path='../atsp_model_train_result/Oct15_17-34-03_HetroGATSum_trained_ATSP50/trial_0', time_limit=0.16, perturbation_moves=5, device='cuda')
device = cuda
model: HetroGATSum trained in ATSP50 for 100 and tested in ATSP100 for 30
  0%|          | 0/30 [00:00<?, ?it/s]  0%|          | 0/30 [00:01<?, ?it/s, Sum_GNN_time:=0.6956, Sum_Search_time:=0.1642, Avg_Gap_init:=14.6057, Avg_Gap_best:=13.8399, Avg_Cost_init:=1.8351, Avg_Cost_best:=1.8228, Avg_Otpimal_best:=1.6012, Avg_counts: =18.0000]  3%|▎         | 1/30 [00:01<00:34,  1.18s/it, Sum_GNN_time:=0.6956, Sum_Search_time:=0.1642, Avg_Gap_init:=14.6057, Avg_Gap_best:=13.8399, Avg_Cost_init:=1.8351, Avg_Cost_best:=1.8228, Avg_Otpimal_best:=1.6012, Avg_counts: =18.0000]  3%|▎         | 1/30 [00:01<00:34,  1.18s/it, Sum_GNN_time:=0.7505, Sum_Search_time:=0.3388, Avg_Gap_init:=19.5187, Avg_Gap_best:=12.8104, Avg_Cost_init:=1.9568, Avg_Cost_best:=1.8450, Avg_Otpimal_best:=1.6358, Avg_counts: =21.0000]  7%|▋         | 2/30 [00:01<00:21,  1.33it/s, Sum_GNN_time:=0.7505, Sum_Search_time:=0.3388, Avg_Gap_init:=19.5187, Avg_Gap_best:=12.8104, Avg_Cost_init:=1.9568, Avg_Cost_best:=1.8450, Avg_Otpimal_best:=1.6358, Avg_counts: =21.0000]  7%|▋         | 2/30 [00:02<00:21,  1.33it/s, Sum_GNN_time:=0.8055, Sum_Search_time:=0.5117, Avg_Gap_init:=19.1393, Avg_Gap_best:=12.5114, Avg_Cost_init:=1.8702, Avg_Cost_best:=1.7647, Avg_Otpimal_best:=1.5684, Avg_counts: =22.0000] 10%|█         | 3/30 [00:02<00:15,  1.70it/s, Sum_GNN_time:=0.8055, Sum_Search_time:=0.5117, Avg_Gap_init:=19.1393, Avg_Gap_best:=12.5114, Avg_Cost_init:=1.8702, Avg_Cost_best:=1.7647, Avg_Otpimal_best:=1.5684, Avg_counts: =22.0000] 10%|█         | 3/30 [00:02<00:15,  1.70it/s, Sum_GNN_time:=0.8604, Sum_Search_time:=0.6736, Avg_Gap_init:=18.1434, Avg_Gap_best:=12.4277, Avg_Cost_init:=1.8284, Avg_Cost_best:=1.7383, Avg_Otpimal_best:=1.5460, Avg_counts: =20.5000] 13%|█▎        | 4/30 [00:02<00:13,  1.97it/s, Sum_GNN_time:=0.8604, Sum_Search_time:=0.6736, Avg_Gap_init:=18.1434, Avg_Gap_best:=12.4277, Avg_Cost_init:=1.8284, Avg_Cost_best:=1.7383, Avg_Otpimal_best:=1.5460, Avg_counts: =20.5000] 13%|█▎        | 4/30 [00:02<00:13,  1.97it/s, Sum_GNN_time:=0.9179, Sum_Search_time:=0.8575, Avg_Gap_init:=17.4660, Avg_Gap_best:=12.4396, Avg_Cost_init:=1.7983, Avg_Cost_best:=1.7196, Avg_Otpimal_best:=1.5292, Avg_counts: =20.0000] 17%|█▋        | 5/30 [00:02<00:12,  1.99it/s, Sum_GNN_time:=0.9179, Sum_Search_time:=0.8575, Avg_Gap_init:=17.4660, Avg_Gap_best:=12.4396, Avg_Cost_init:=1.7983, Avg_Cost_best:=1.7196, Avg_Otpimal_best:=1.5292, Avg_counts: =20.0000] 17%|█▋        | 5/30 [00:03<00:12,  1.99it/s, Sum_GNN_time:=0.9773, Sum_Search_time:=1.0215, Avg_Gap_init:=17.2863, Avg_Gap_best:=11.9234, Avg_Cost_init:=1.8154, Avg_Cost_best:=1.7306, Avg_Otpimal_best:=1.5465, Avg_counts: =20.0000] 20%|██        | 6/30 [00:03<00:11,  2.15it/s, Sum_GNN_time:=0.9773, Sum_Search_time:=1.0215, Avg_Gap_init:=17.2863, Avg_Gap_best:=11.9234, Avg_Cost_init:=1.8154, Avg_Cost_best:=1.7306, Avg_Otpimal_best:=1.5465, Avg_counts: =20.0000] 20%|██        | 6/30 [00:03<00:11,  2.15it/s, Sum_GNN_time:=1.0319, Sum_Search_time:=1.1983, Avg_Gap_init:=17.1672, Avg_Gap_best:=11.4964, Avg_Cost_init:=1.8435, Avg_Cost_best:=1.7523, Avg_Otpimal_best:=1.5725, Avg_counts: =20.5714] 23%|██▎       | 7/30 [00:03<00:10,  2.26it/s, Sum_GNN_time:=1.0319, Sum_Search_time:=1.1983, Avg_Gap_init:=17.1672, Avg_Gap_best:=11.4964, Avg_Cost_init:=1.8435, Avg_Cost_best:=1.7523, Avg_Otpimal_best:=1.5725, Avg_counts: =20.5714] 23%|██▎       | 7/30 [00:04<00:10,  2.26it/s, Sum_GNN_time:=1.0876, Sum_Search_time:=1.3619, Avg_Gap_init:=16.7267, Avg_Gap_best:=11.2288, Avg_Cost_init:=1.8797, Avg_Cost_best:=1.7898, Avg_Otpimal_best:=1.6105, Avg_counts: =19.8750] 27%|██▋       | 8/30 [00:04<00:09,  2.36it/s, Sum_GNN_time:=1.0876, Sum_Search_time:=1.3619, Avg_Gap_init:=16.7267, Avg_Gap_best:=11.2288, Avg_Cost_init:=1.8797, Avg_Cost_best:=1.7898, Avg_Otpimal_best:=1.6105, Avg_counts: =19.8750] 27%|██▋       | 8/30 [00:04<00:09,  2.36it/s, Sum_GNN_time:=1.1428, Sum_Search_time:=1.5381, Avg_Gap_init:=17.2231, Avg_Gap_best:=11.4354, Avg_Cost_init:=1.8801, Avg_Cost_best:=1.7862, Avg_Otpimal_best:=1.6043, Avg_counts: =20.3333] 30%|███       | 9/30 [00:04<00:08,  2.41it/s, Sum_GNN_time:=1.1428, Sum_Search_time:=1.5381, Avg_Gap_init:=17.2231, Avg_Gap_best:=11.4354, Avg_Cost_init:=1.8801, Avg_Cost_best:=1.7862, Avg_Otpimal_best:=1.6043, Avg_counts: =20.3333] 30%|███       | 9/30 [00:04<00:08,  2.41it/s, Sum_GNN_time:=1.1987, Sum_Search_time:=1.7136, Avg_Gap_init:=16.9002, Avg_Gap_best:=11.3209, Avg_Cost_init:=1.8864, Avg_Cost_best:=1.7956, Avg_Otpimal_best:=1.6142, Avg_counts: =20.7000] 33%|███▎      | 10/30 [00:04<00:08,  2.28it/s, Sum_GNN_time:=1.1987, Sum_Search_time:=1.7136, Avg_Gap_init:=16.9002, Avg_Gap_best:=11.3209, Avg_Cost_init:=1.8864, Avg_Cost_best:=1.7956, Avg_Otpimal_best:=1.6142, Avg_counts: =20.7000] 33%|███▎      | 10/30 [00:05<00:08,  2.28it/s, Sum_GNN_time:=1.2547, Sum_Search_time:=1.8780, Avg_Gap_init:=17.4017, Avg_Gap_best:=11.3916, Avg_Cost_init:=1.9109, Avg_Cost_best:=1.8118, Avg_Otpimal_best:=1.6276, Avg_counts: =20.6364] 37%|███▋      | 11/30 [00:05<00:08,  2.36it/s, Sum_GNN_time:=1.2547, Sum_Search_time:=1.8780, Avg_Gap_init:=17.4017, Avg_Gap_best:=11.3916, Avg_Cost_init:=1.9109, Avg_Cost_best:=1.8118, Avg_Otpimal_best:=1.6276, Avg_counts: =20.6364] 37%|███▋      | 11/30 [00:05<00:08,  2.36it/s, Sum_GNN_time:=1.3104, Sum_Search_time:=2.0425, Avg_Gap_init:=16.5408, Avg_Gap_best:=10.6912, Avg_Cost_init:=1.8745, Avg_Cost_best:=1.7790, Avg_Otpimal_best:=1.6067, Avg_counts: =20.4167] 40%|████      | 12/30 [00:05<00:07,  2.42it/s, Sum_GNN_time:=1.3104, Sum_Search_time:=2.0425, Avg_Gap_init:=16.5408, Avg_Gap_best:=10.6912, Avg_Cost_init:=1.8745, Avg_Cost_best:=1.7790, Avg_Otpimal_best:=1.6067, Avg_counts: =20.4167] 40%|████      | 12/30 [00:06<00:07,  2.42it/s, Sum_GNN_time:=1.3663, Sum_Search_time:=2.2172, Avg_Gap_init:=17.0330, Avg_Gap_best:=10.9627, Avg_Cost_init:=1.8703, Avg_Cost_best:=1.7722, Avg_Otpimal_best:=1.5970, Avg_counts: =20.6923] 43%|████▎     | 13/30 [00:06<00:06,  2.45it/s, Sum_GNN_time:=1.3663, Sum_Search_time:=2.2172, Avg_Gap_init:=17.0330, Avg_Gap_best:=10.9627, Avg_Cost_init:=1.8703, Avg_Cost_best:=1.7722, Avg_Otpimal_best:=1.5970, Avg_counts: =20.6923] 43%|████▎     | 13/30 [00:06<00:06,  2.45it/s, Sum_GNN_time:=1.4219, Sum_Search_time:=2.3809, Avg_Gap_init:=17.0267, Avg_Gap_best:=11.1104, Avg_Cost_init:=1.8712, Avg_Cost_best:=1.7757, Avg_Otpimal_best:=1.5980, Avg_counts: =20.5000] 47%|████▋     | 14/30 [00:06<00:06,  2.35it/s, Sum_GNN_time:=1.4219, Sum_Search_time:=2.3809, Avg_Gap_init:=17.0267, Avg_Gap_best:=11.1104, Avg_Cost_init:=1.8712, Avg_Cost_best:=1.7757, Avg_Otpimal_best:=1.5980, Avg_counts: =20.5000] 47%|████▋     | 14/30 [00:06<00:06,  2.35it/s, Sum_GNN_time:=1.4771, Sum_Search_time:=2.5556, Avg_Gap_init:=16.9846, Avg_Gap_best:=11.1059, Avg_Cost_init:=1.8665, Avg_Cost_best:=1.7718, Avg_Otpimal_best:=1.5945, Avg_counts: =20.7333] 50%|█████     | 15/30 [00:06<00:06,  2.40it/s, Sum_GNN_time:=1.4771, Sum_Search_time:=2.5556, Avg_Gap_init:=16.9846, Avg_Gap_best:=11.1059, Avg_Cost_init:=1.8665, Avg_Cost_best:=1.7718, Avg_Otpimal_best:=1.5945, Avg_counts: =20.7333] 50%|█████     | 15/30 [00:07<00:06,  2.40it/s, Sum_GNN_time:=1.5338, Sum_Search_time:=2.7208, Avg_Gap_init:=17.1168, Avg_Gap_best:=10.9736, Avg_Cost_init:=1.8729, Avg_Cost_best:=1.7737, Avg_Otpimal_best:=1.5982, Avg_counts: =20.6875] 53%|█████▎    | 16/30 [00:07<00:05,  2.43it/s, Sum_GNN_time:=1.5338, Sum_Search_time:=2.7208, Avg_Gap_init:=17.1168, Avg_Gap_best:=10.9736, Avg_Cost_init:=1.8729, Avg_Cost_best:=1.7737, Avg_Otpimal_best:=1.5982, Avg_counts: =20.6875] 53%|█████▎    | 16/30 [00:07<00:05,  2.43it/s, Sum_GNN_time:=1.5927, Sum_Search_time:=2.8875, Avg_Gap_init:=17.7171, Avg_Gap_best:=11.5758, Avg_Cost_init:=1.8856, Avg_Cost_best:=1.7863, Avg_Otpimal_best:=1.6007, Avg_counts: =20.6471] 57%|█████▋    | 17/30 [00:07<00:05,  2.43it/s, Sum_GNN_time:=1.5927, Sum_Search_time:=2.8875, Avg_Gap_init:=17.7171, Avg_Gap_best:=11.5758, Avg_Cost_init:=1.8856, Avg_Cost_best:=1.7863, Avg_Otpimal_best:=1.6007, Avg_counts: =20.6471] 57%|█████▋    | 17/30 [00:08<00:05,  2.43it/s, Sum_GNN_time:=1.6513, Sum_Search_time:=3.0693, Avg_Gap_init:=17.2835, Avg_Gap_best:=11.2968, Avg_Cost_init:=1.8751, Avg_Cost_best:=1.7784, Avg_Otpimal_best:=1.5975, Avg_counts: =20.5000] 60%|██████    | 18/30 [00:08<00:04,  2.42it/s, Sum_GNN_time:=1.6513, Sum_Search_time:=3.0693, Avg_Gap_init:=17.2835, Avg_Gap_best:=11.2968, Avg_Cost_init:=1.8751, Avg_Cost_best:=1.7784, Avg_Otpimal_best:=1.5975, Avg_counts: =20.5000] 60%|██████    | 18/30 [00:08<00:04,  2.42it/s, Sum_GNN_time:=1.7064, Sum_Search_time:=3.2436, Avg_Gap_init:=17.1617, Avg_Gap_best:=11.1813, Avg_Cost_init:=1.8633, Avg_Cost_best:=1.7673, Avg_Otpimal_best:=1.5890, Avg_counts: =20.6842] 63%|██████▎   | 19/30 [00:08<00:04,  2.30it/s, Sum_GNN_time:=1.7064, Sum_Search_time:=3.2436, Avg_Gap_init:=17.1617, Avg_Gap_best:=11.1813, Avg_Cost_init:=1.8633, Avg_Cost_best:=1.7673, Avg_Otpimal_best:=1.5890, Avg_counts: =20.6842] 63%|██████▎   | 19/30 [00:09<00:04,  2.30it/s, Sum_GNN_time:=1.7609, Sum_Search_time:=3.4076, Avg_Gap_init:=16.6821, Avg_Gap_best:=11.0007, Avg_Cost_init:=1.8528, Avg_Cost_best:=1.7616, Avg_Otpimal_best:=1.5864, Avg_counts: =20.4500] 67%|██████▋   | 20/30 [00:09<00:04,  2.38it/s, Sum_GNN_time:=1.7609, Sum_Search_time:=3.4076, Avg_Gap_init:=16.6821, Avg_Gap_best:=11.0007, Avg_Cost_init:=1.8528, Avg_Cost_best:=1.7616, Avg_Otpimal_best:=1.5864, Avg_counts: =20.4500] 67%|██████▋   | 20/30 [00:09<00:04,  2.38it/s, Sum_GNN_time:=1.8157, Sum_Search_time:=3.5796, Avg_Gap_init:=17.0141, Avg_Gap_best:=11.3466, Avg_Cost_init:=1.8415, Avg_Cost_best:=1.7513, Avg_Otpimal_best:=1.5731, Avg_counts: =20.6190] 70%|███████   | 21/30 [00:09<00:03,  2.43it/s, Sum_GNN_time:=1.8157, Sum_Search_time:=3.5796, Avg_Gap_init:=17.0141, Avg_Gap_best:=11.3466, Avg_Cost_init:=1.8415, Avg_Cost_best:=1.7513, Avg_Otpimal_best:=1.5731, Avg_counts: =20.6190] 70%|███████   | 21/30 [00:09<00:03,  2.43it/s, Sum_GNN_time:=1.8702, Sum_Search_time:=3.7553, Avg_Gap_init:=17.0917, Avg_Gap_best:=11.4218, Avg_Cost_init:=1.8510, Avg_Cost_best:=1.7604, Avg_Otpimal_best:=1.5801, Avg_counts: =20.7727] 73%|███████▎  | 22/30 [00:09<00:03,  2.46it/s, Sum_GNN_time:=1.8702, Sum_Search_time:=3.7553, Avg_Gap_init:=17.0917, Avg_Gap_best:=11.4218, Avg_Cost_init:=1.8510, Avg_Cost_best:=1.7604, Avg_Otpimal_best:=1.5801, Avg_counts: =20.7727] 73%|███████▎  | 22/30 [00:10<00:03,  2.46it/s, Sum_GNN_time:=1.9254, Sum_Search_time:=3.9369, Avg_Gap_init:=17.3622, Avg_Gap_best:=11.5651, Avg_Cost_init:=1.8536, Avg_Cost_best:=1.7611, Avg_Otpimal_best:=1.5788, Avg_counts: =20.9130] 77%|███████▋  | 23/30 [00:10<00:02,  2.47it/s, Sum_GNN_time:=1.9254, Sum_Search_time:=3.9369, Avg_Gap_init:=17.3622, Avg_Gap_best:=11.5651, Avg_Cost_init:=1.8536, Avg_Cost_best:=1.7611, Avg_Otpimal_best:=1.5788, Avg_counts: =20.9130] 77%|███████▋  | 23/30 [00:10<00:02,  2.47it/s, Sum_GNN_time:=1.9808, Sum_Search_time:=4.1128, Avg_Gap_init:=17.6673, Avg_Gap_best:=11.9012, Avg_Cost_init:=1.8555, Avg_Cost_best:=1.7637, Avg_Otpimal_best:=1.5765, Avg_counts: =21.0417] 80%|████████  | 24/30 [00:10<00:02,  2.32it/s, Sum_GNN_time:=1.9808, Sum_Search_time:=4.1128, Avg_Gap_init:=17.6673, Avg_Gap_best:=11.9012, Avg_Cost_init:=1.8555, Avg_Cost_best:=1.7637, Avg_Otpimal_best:=1.5765, Avg_counts: =21.0417] 80%|████████  | 24/30 [00:11<00:02,  2.32it/s, Sum_GNN_time:=2.0360, Sum_Search_time:=4.2884, Avg_Gap_init:=17.5838, Avg_Gap_best:=11.7914, Avg_Cost_init:=1.8474, Avg_Cost_best:=1.7556, Avg_Otpimal_best:=1.5706, Avg_counts: =21.1600] 83%|████████▎ | 25/30 [00:11<00:02,  2.38it/s, Sum_GNN_time:=2.0360, Sum_Search_time:=4.2884, Avg_Gap_init:=17.5838, Avg_Gap_best:=11.7914, Avg_Cost_init:=1.8474, Avg_Cost_best:=1.7556, Avg_Otpimal_best:=1.5706, Avg_counts: =21.1600] 83%|████████▎ | 25/30 [00:11<00:02,  2.38it/s, Sum_GNN_time:=2.0906, Sum_Search_time:=4.4523, Avg_Gap_init:=17.3419, Avg_Gap_best:=11.7262, Avg_Cost_init:=1.8392, Avg_Cost_best:=1.7502, Avg_Otpimal_best:=1.5667, Avg_counts: =21.0385] 87%|████████▋ | 26/30 [00:11<00:01,  2.44it/s, Sum_GNN_time:=2.0906, Sum_Search_time:=4.4523, Avg_Gap_init:=17.3419, Avg_Gap_best:=11.7262, Avg_Cost_init:=1.8392, Avg_Cost_best:=1.7502, Avg_Otpimal_best:=1.5667, Avg_counts: =21.0385] 87%|████████▋ | 26/30 [00:11<00:01,  2.44it/s, Sum_GNN_time:=2.1470, Sum_Search_time:=4.6289, Avg_Gap_init:=17.2888, Avg_Gap_best:=11.5450, Avg_Cost_init:=1.8330, Avg_Cost_best:=1.7425, Avg_Otpimal_best:=1.5621, Avg_counts: =21.1481] 90%|█████████ | 27/30 [00:11<00:01,  2.46it/s, Sum_GNN_time:=2.1470, Sum_Search_time:=4.6289, Avg_Gap_init:=17.2888, Avg_Gap_best:=11.5450, Avg_Cost_init:=1.8330, Avg_Cost_best:=1.7425, Avg_Otpimal_best:=1.5621, Avg_counts: =21.1481] 90%|█████████ | 27/30 [00:12<00:01,  2.46it/s, Sum_GNN_time:=2.2024, Sum_Search_time:=4.7921, Avg_Gap_init:=17.2980, Avg_Gap_best:=11.5864, Avg_Cost_init:=1.8314, Avg_Cost_best:=1.7414, Avg_Otpimal_best:=1.5606, Avg_counts: =20.9286] 93%|█████████▎| 28/30 [00:12<00:00,  2.50it/s, Sum_GNN_time:=2.2024, Sum_Search_time:=4.7921, Avg_Gap_init:=17.2980, Avg_Gap_best:=11.5864, Avg_Cost_init:=1.8314, Avg_Cost_best:=1.7414, Avg_Otpimal_best:=1.5606, Avg_counts: =20.9286] 93%|█████████▎| 28/30 [00:12<00:00,  2.50it/s, Sum_GNN_time:=2.2577, Sum_Search_time:=4.9533, Avg_Gap_init:=17.2905, Avg_Gap_best:=11.5282, Avg_Cost_init:=1.8346, Avg_Cost_best:=1.7437, Avg_Otpimal_best:=1.5635, Avg_counts: =20.8966] 97%|█████████▋| 29/30 [00:12<00:00,  2.35it/s, Sum_GNN_time:=2.2577, Sum_Search_time:=4.9533, Avg_Gap_init:=17.2905, Avg_Gap_best:=11.5282, Avg_Cost_init:=1.8346, Avg_Cost_best:=1.7437, Avg_Otpimal_best:=1.5635, Avg_counts: =20.8966] 97%|█████████▋| 29/30 [00:13<00:00,  2.35it/s, Sum_GNN_time:=2.3175, Sum_Search_time:=5.1169, Avg_Gap_init:=17.3428, Avg_Gap_best:=11.6018, Avg_Cost_init:=1.8328, Avg_Cost_best:=1.7424, Avg_Otpimal_best:=1.5613, Avg_counts: =20.8667]100%|██████████| 30/30 [00:13<00:00,  2.38it/s, Sum_GNN_time:=2.3175, Sum_Search_time:=5.1169, Avg_Gap_init:=17.3428, Avg_Gap_best:=11.6018, Avg_Cost_init:=1.8328, Avg_Cost_best:=1.7424, Avg_Otpimal_best:=1.5613, Avg_counts: =20.8667]100%|██████████| 30/30 [00:13<00:00,  2.27it/s, Sum_GNN_time:=2.3175, Sum_Search_time:=5.1169, Avg_Gap_init:=17.3428, Avg_Gap_best:=11.6018, Avg_Cost_init:=1.8328, Avg_Cost_best:=1.7424, Avg_Otpimal_best:=1.5613, Avg_counts: =20.8667]
Total time for model prediction: 2.3175 seconds
Total time for guided local search: 5.1169 seconds
