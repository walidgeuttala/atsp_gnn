Namespace(data_dir='../tsp_input/generated_insatnces_3000_size_50/', tb_dir='../atsp_model_train_result', atsp_size=50, to_homo=False, half_st=False, model='HetroGATConcat', input_dim=1, hidden_dim=128, output_dim=1, relation_types='ss st tt pp', n_gnn_layers=4, n_heads=64, jk='cat', lr_init=0.001, lr_decay=0.95, min_delta=0.0001, patience=200, batch_size=15, n_epochs=100, checkpoint_freq=10, seed=4, n_trials=1, n_samples_result_train=30, device='cuda')
Namespace(atsp_size=100, data_path='../tsp_input/generated_insatnces_30_size_100', model_path='../atsp_model_train_result/Oct15_14-45-35_HetroGATConcat_trained_ATSP50/trial_0', time_limit=0.16, perturbation_moves=5, device='cuda')
device = cuda
model: HetroGATConcat trained in ATSP50 for 100 and tested in ATSP100 for 30
  0%|          | 0/30 [00:00<?, ?it/s]  0%|          | 0/30 [00:04<?, ?it/s, Sum_GNN_time:=2.5041, Sum_Search_time:=0.1649, Avg_Gap_init:=13.5182, Avg_Gap_best:=9.1334, Avg_Cost_init:=1.8177, Avg_Cost_best:=1.7475, Avg_Otpimal_best:=1.6012, Avg_counts: =15.0000]  3%|▎         | 1/30 [00:04<01:58,  4.08s/it, Sum_GNN_time:=2.5041, Sum_Search_time:=0.1649, Avg_Gap_init:=13.5182, Avg_Gap_best:=9.1334, Avg_Cost_init:=1.8177, Avg_Cost_best:=1.7475, Avg_Otpimal_best:=1.6012, Avg_counts: =15.0000]  3%|▎         | 1/30 [00:04<01:58,  4.08s/it, Sum_GNN_time:=2.5603, Sum_Search_time:=0.3256, Avg_Gap_init:=14.3272, Avg_Gap_best:=10.6276, Avg_Cost_init:=1.8705, Avg_Cost_best:=1.8102, Avg_Otpimal_best:=1.6358, Avg_counts: =15.0000]  7%|▋         | 2/30 [00:04<00:54,  1.94s/it, Sum_GNN_time:=2.5603, Sum_Search_time:=0.3256, Avg_Gap_init:=14.3272, Avg_Gap_best:=10.6276, Avg_Cost_init:=1.8705, Avg_Cost_best:=1.8102, Avg_Otpimal_best:=1.6358, Avg_counts: =15.0000]  7%|▋         | 2/30 [00:04<00:54,  1.94s/it, Sum_GNN_time:=2.6162, Sum_Search_time:=0.4885, Avg_Gap_init:=12.8256, Avg_Gap_best:=9.3688, Avg_Cost_init:=1.7717, Avg_Cost_best:=1.7173, Avg_Otpimal_best:=1.5684, Avg_counts: =16.0000]  10%|█         | 3/30 [00:04<00:33,  1.23s/it, Sum_GNN_time:=2.6162, Sum_Search_time:=0.4885, Avg_Gap_init:=12.8256, Avg_Gap_best:=9.3688, Avg_Cost_init:=1.7717, Avg_Cost_best:=1.7173, Avg_Otpimal_best:=1.5684, Avg_counts: =16.0000] 10%|█         | 3/30 [00:05<00:33,  1.23s/it, Sum_GNN_time:=2.6722, Sum_Search_time:=0.6489, Avg_Gap_init:=12.1238, Avg_Gap_best:=8.6971, Avg_Cost_init:=1.7355, Avg_Cost_best:=1.6824, Avg_Otpimal_best:=1.5460, Avg_counts: =16.0000] 13%|█▎        | 4/30 [00:05<00:23,  1.11it/s, Sum_GNN_time:=2.6722, Sum_Search_time:=0.6489, Avg_Gap_init:=12.1238, Avg_Gap_best:=8.6971, Avg_Cost_init:=1.7355, Avg_Cost_best:=1.6824, Avg_Otpimal_best:=1.5460, Avg_counts: =16.0000] 13%|█▎        | 4/30 [00:05<00:23,  1.11it/s, Sum_GNN_time:=2.7291, Sum_Search_time:=0.8209, Avg_Gap_init:=13.7221, Avg_Gap_best:=9.4171, Avg_Cost_init:=1.7397, Avg_Cost_best:=1.6743, Avg_Otpimal_best:=1.5292, Avg_counts: =17.6000] 17%|█▋        | 5/30 [00:05<00:18,  1.34it/s, Sum_GNN_time:=2.7291, Sum_Search_time:=0.8209, Avg_Gap_init:=13.7221, Avg_Gap_best:=9.4171, Avg_Cost_init:=1.7397, Avg_Cost_best:=1.6743, Avg_Otpimal_best:=1.5292, Avg_counts: =17.6000] 17%|█▋        | 5/30 [00:06<00:18,  1.34it/s, Sum_GNN_time:=2.7857, Sum_Search_time:=0.9849, Avg_Gap_init:=13.2874, Avg_Gap_best:=8.7099, Avg_Cost_init:=1.7522, Avg_Cost_best:=1.6815, Avg_Otpimal_best:=1.5465, Avg_counts: =17.6667] 20%|██        | 6/30 [00:06<00:14,  1.61it/s, Sum_GNN_time:=2.7857, Sum_Search_time:=0.9849, Avg_Gap_init:=13.2874, Avg_Gap_best:=8.7099, Avg_Cost_init:=1.7522, Avg_Cost_best:=1.6815, Avg_Otpimal_best:=1.5465, Avg_counts: =17.6667] 20%|██        | 6/30 [00:06<00:14,  1.61it/s, Sum_GNN_time:=2.8419, Sum_Search_time:=1.1450, Avg_Gap_init:=12.8755, Avg_Gap_best:=8.7354, Avg_Cost_init:=1.7744, Avg_Cost_best:=1.7102, Avg_Otpimal_best:=1.5725, Avg_counts: =17.7143] 23%|██▎       | 7/30 [00:06<00:12,  1.84it/s, Sum_GNN_time:=2.8419, Sum_Search_time:=1.1450, Avg_Gap_init:=12.8755, Avg_Gap_best:=8.7354, Avg_Cost_init:=1.7744, Avg_Cost_best:=1.7102, Avg_Otpimal_best:=1.5725, Avg_counts: =17.7143] 23%|██▎       | 7/30 [00:06<00:12,  1.84it/s, Sum_GNN_time:=2.8991, Sum_Search_time:=1.3092, Avg_Gap_init:=13.1325, Avg_Gap_best:=8.8566, Avg_Cost_init:=1.8223, Avg_Cost_best:=1.7538, Avg_Otpimal_best:=1.6105, Avg_counts: =18.0000] 27%|██▋       | 8/30 [00:06<00:10,  2.00it/s, Sum_GNN_time:=2.8991, Sum_Search_time:=1.3092, Avg_Gap_init:=13.1325, Avg_Gap_best:=8.8566, Avg_Cost_init:=1.8223, Avg_Cost_best:=1.7538, Avg_Otpimal_best:=1.6105, Avg_counts: =18.0000] 27%|██▋       | 8/30 [00:07<00:10,  2.00it/s, Sum_GNN_time:=2.9592, Sum_Search_time:=1.4910, Avg_Gap_init:=12.8857, Avg_Gap_best:=8.8626, Avg_Cost_init:=1.8113, Avg_Cost_best:=1.7470, Avg_Otpimal_best:=1.6043, Avg_counts: =17.7778] 30%|███       | 9/30 [00:07<00:09,  2.12it/s, Sum_GNN_time:=2.9592, Sum_Search_time:=1.4910, Avg_Gap_init:=12.8857, Avg_Gap_best:=8.8626, Avg_Cost_init:=1.8113, Avg_Cost_best:=1.7470, Avg_Otpimal_best:=1.6043, Avg_counts: =17.7778] 30%|███       | 9/30 [00:07<00:09,  2.12it/s, Sum_GNN_time:=3.0160, Sum_Search_time:=1.6614, Avg_Gap_init:=12.9012, Avg_Gap_best:=9.0399, Avg_Cost_init:=1.8228, Avg_Cost_best:=1.7608, Avg_Otpimal_best:=1.6142, Avg_counts: =18.4000] 33%|███▎      | 10/30 [00:07<00:09,  2.11it/s, Sum_GNN_time:=3.0160, Sum_Search_time:=1.6614, Avg_Gap_init:=12.9012, Avg_Gap_best:=9.0399, Avg_Cost_init:=1.8228, Avg_Cost_best:=1.7608, Avg_Otpimal_best:=1.6142, Avg_counts: =18.4000] 33%|███▎      | 10/30 [00:08<00:09,  2.11it/s, Sum_GNN_time:=3.0721, Sum_Search_time:=1.8470, Avg_Gap_init:=12.8475, Avg_Gap_best:=9.1165, Avg_Cost_init:=1.8369, Avg_Cost_best:=1.7766, Avg_Otpimal_best:=1.6276, Avg_counts: =18.5455] 37%|███▋      | 11/30 [00:08<00:08,  2.20it/s, Sum_GNN_time:=3.0721, Sum_Search_time:=1.8470, Avg_Gap_init:=12.8475, Avg_Gap_best:=9.1165, Avg_Cost_init:=1.8369, Avg_Cost_best:=1.7766, Avg_Otpimal_best:=1.6276, Avg_counts: =18.5455] 37%|███▋      | 11/30 [00:08<00:08,  2.20it/s, Sum_GNN_time:=3.1283, Sum_Search_time:=2.0079, Avg_Gap_init:=12.2208, Avg_Gap_best:=8.6845, Avg_Cost_init:=1.8047, Avg_Cost_best:=1.7479, Avg_Otpimal_best:=1.6067, Avg_counts: =18.5000] 40%|████      | 12/30 [00:08<00:07,  2.31it/s, Sum_GNN_time:=3.1283, Sum_Search_time:=2.0079, Avg_Gap_init:=12.2208, Avg_Gap_best:=8.6845, Avg_Cost_init:=1.8047, Avg_Cost_best:=1.7479, Avg_Otpimal_best:=1.6067, Avg_counts: =18.5000] 40%|████      | 12/30 [00:09<00:07,  2.31it/s, Sum_GNN_time:=3.1841, Sum_Search_time:=2.1937, Avg_Gap_init:=11.9464, Avg_Gap_best:=8.5539, Avg_Cost_init:=1.7896, Avg_Cost_best:=1.7352, Avg_Otpimal_best:=1.5970, Avg_counts: =18.4615] 43%|████▎     | 13/30 [00:09<00:07,  2.35it/s, Sum_GNN_time:=3.1841, Sum_Search_time:=2.1937, Avg_Gap_init:=11.9464, Avg_Gap_best:=8.5539, Avg_Cost_init:=1.7896, Avg_Cost_best:=1.7352, Avg_Otpimal_best:=1.5970, Avg_counts: =18.4615] 43%|████▎     | 13/30 [00:09<00:07,  2.35it/s, Sum_GNN_time:=3.2432, Sum_Search_time:=2.3548, Avg_Gap_init:=11.8336, Avg_Gap_best:=8.5033, Avg_Cost_init:=1.7888, Avg_Cost_best:=1.7354, Avg_Otpimal_best:=1.5980, Avg_counts: =18.4286] 47%|████▋     | 14/30 [00:09<00:07,  2.27it/s, Sum_GNN_time:=3.2432, Sum_Search_time:=2.3548, Avg_Gap_init:=11.8336, Avg_Gap_best:=8.5033, Avg_Cost_init:=1.7888, Avg_Cost_best:=1.7354, Avg_Otpimal_best:=1.5980, Avg_counts: =18.4286] 47%|████▋     | 14/30 [00:09<00:07,  2.27it/s, Sum_GNN_time:=3.3005, Sum_Search_time:=2.5410, Avg_Gap_init:=11.6091, Avg_Gap_best:=8.3412, Avg_Cost_init:=1.7813, Avg_Cost_best:=1.7290, Avg_Otpimal_best:=1.5945, Avg_counts: =18.4000] 50%|█████     | 15/30 [00:09<00:06,  2.32it/s, Sum_GNN_time:=3.3005, Sum_Search_time:=2.5410, Avg_Gap_init:=11.6091, Avg_Gap_best:=8.3412, Avg_Cost_init:=1.7813, Avg_Cost_best:=1.7290, Avg_Otpimal_best:=1.5945, Avg_counts: =18.4000] 50%|█████     | 15/30 [00:10<00:06,  2.32it/s, Sum_GNN_time:=3.3567, Sum_Search_time:=2.7145, Avg_Gap_init:=11.8540, Avg_Gap_best:=8.2699, Avg_Cost_init:=1.7894, Avg_Cost_best:=1.7317, Avg_Otpimal_best:=1.5982, Avg_counts: =18.7500] 53%|█████▎    | 16/30 [00:10<00:05,  2.38it/s, Sum_GNN_time:=3.3567, Sum_Search_time:=2.7145, Avg_Gap_init:=11.8540, Avg_Gap_best:=8.2699, Avg_Cost_init:=1.7894, Avg_Cost_best:=1.7317, Avg_Otpimal_best:=1.5982, Avg_counts: =18.7500] 53%|█████▎    | 16/30 [00:10<00:05,  2.38it/s, Sum_GNN_time:=3.4127, Sum_Search_time:=2.8757, Avg_Gap_init:=11.9716, Avg_Gap_best:=8.2776, Avg_Cost_init:=1.7940, Avg_Cost_best:=1.7345, Avg_Otpimal_best:=1.6007, Avg_counts: =18.7059] 57%|█████▋    | 17/30 [00:10<00:05,  2.44it/s, Sum_GNN_time:=3.4127, Sum_Search_time:=2.8757, Avg_Gap_init:=11.9716, Avg_Gap_best:=8.2776, Avg_Cost_init:=1.7940, Avg_Cost_best:=1.7345, Avg_Otpimal_best:=1.6007, Avg_counts: =18.7059] 57%|█████▋    | 17/30 [00:11<00:05,  2.44it/s, Sum_GNN_time:=3.4689, Sum_Search_time:=3.0375, Avg_Gap_init:=11.8433, Avg_Gap_best:=8.1159, Avg_Cost_init:=1.7883, Avg_Cost_best:=1.7285, Avg_Otpimal_best:=1.5975, Avg_counts: =18.6667] 60%|██████    | 18/30 [00:11<00:04,  2.48it/s, Sum_GNN_time:=3.4689, Sum_Search_time:=3.0375, Avg_Gap_init:=11.8433, Avg_Gap_best:=8.1159, Avg_Cost_init:=1.7883, Avg_Cost_best:=1.7285, Avg_Otpimal_best:=1.5975, Avg_counts: =18.6667] 60%|██████    | 18/30 [00:11<00:04,  2.48it/s, Sum_GNN_time:=3.5260, Sum_Search_time:=3.2244, Avg_Gap_init:=11.8435, Avg_Gap_best:=8.2229, Avg_Cost_init:=1.7787, Avg_Cost_best:=1.7207, Avg_Otpimal_best:=1.5890, Avg_counts: =18.7368] 63%|██████▎   | 19/30 [00:11<00:04,  2.31it/s, Sum_GNN_time:=3.5260, Sum_Search_time:=3.2244, Avg_Gap_init:=11.8435, Avg_Gap_best:=8.2229, Avg_Cost_init:=1.7787, Avg_Cost_best:=1.7207, Avg_Otpimal_best:=1.5890, Avg_counts: =18.7368] 63%|██████▎   | 19/30 [00:12<00:04,  2.31it/s, Sum_GNN_time:=3.5861, Sum_Search_time:=3.4032, Avg_Gap_init:=11.5615, Avg_Gap_best:=8.0959, Avg_Cost_init:=1.7714, Avg_Cost_best:=1.7159, Avg_Otpimal_best:=1.5864, Avg_counts: =18.6000] 67%|██████▋   | 20/30 [00:12<00:04,  2.33it/s, Sum_GNN_time:=3.5861, Sum_Search_time:=3.4032, Avg_Gap_init:=11.5615, Avg_Gap_best:=8.0959, Avg_Cost_init:=1.7714, Avg_Cost_best:=1.7159, Avg_Otpimal_best:=1.5864, Avg_counts: =18.6000] 67%|██████▋   | 20/30 [00:12<00:04,  2.33it/s, Sum_GNN_time:=3.6463, Sum_Search_time:=3.5742, Avg_Gap_init:=11.6122, Avg_Gap_best:=7.9594, Avg_Cost_init:=1.7571, Avg_Cost_best:=1.6997, Avg_Otpimal_best:=1.5731, Avg_counts: =18.5714] 70%|███████   | 21/30 [00:12<00:03,  2.33it/s, Sum_GNN_time:=3.6463, Sum_Search_time:=3.5742, Avg_Gap_init:=11.6122, Avg_Gap_best:=7.9594, Avg_Cost_init:=1.7571, Avg_Cost_best:=1.6997, Avg_Otpimal_best:=1.5731, Avg_counts: =18.5714] 70%|███████   | 21/30 [00:12<00:03,  2.33it/s, Sum_GNN_time:=3.7027, Sum_Search_time:=3.7406, Avg_Gap_init:=11.5174, Avg_Gap_best:=7.8734, Avg_Cost_init:=1.7633, Avg_Cost_best:=1.7057, Avg_Otpimal_best:=1.5801, Avg_counts: =18.3636] 73%|███████▎  | 22/30 [00:12<00:03,  2.40it/s, Sum_GNN_time:=3.7027, Sum_Search_time:=3.7406, Avg_Gap_init:=11.5174, Avg_Gap_best:=7.8734, Avg_Cost_init:=1.7633, Avg_Cost_best:=1.7057, Avg_Otpimal_best:=1.5801, Avg_counts: =18.3636] 73%|███████▎  | 22/30 [00:13<00:03,  2.40it/s, Sum_GNN_time:=3.7585, Sum_Search_time:=3.9025, Avg_Gap_init:=11.2831, Avg_Gap_best:=7.7632, Avg_Cost_init:=1.7581, Avg_Cost_best:=1.7025, Avg_Otpimal_best:=1.5788, Avg_counts: =18.3478] 77%|███████▋  | 23/30 [00:13<00:02,  2.46it/s, Sum_GNN_time:=3.7585, Sum_Search_time:=3.9025, Avg_Gap_init:=11.2831, Avg_Gap_best:=7.7632, Avg_Cost_init:=1.7581, Avg_Cost_best:=1.7025, Avg_Otpimal_best:=1.5788, Avg_counts: =18.3478] 77%|███████▋  | 23/30 [00:13<00:02,  2.46it/s, Sum_GNN_time:=3.8152, Sum_Search_time:=4.0896, Avg_Gap_init:=11.5182, Avg_Gap_best:=7.9654, Avg_Cost_init:=1.7591, Avg_Cost_best:=1.7031, Avg_Otpimal_best:=1.5765, Avg_counts: =18.3333] 80%|████████  | 24/30 [00:13<00:02,  2.30it/s, Sum_GNN_time:=3.8152, Sum_Search_time:=4.0896, Avg_Gap_init:=11.5182, Avg_Gap_best:=7.9654, Avg_Cost_init:=1.7591, Avg_Cost_best:=1.7031, Avg_Otpimal_best:=1.5765, Avg_counts: =18.3333] 80%|████████  | 24/30 [00:14<00:02,  2.30it/s, Sum_GNN_time:=3.8712, Sum_Search_time:=4.2624, Avg_Gap_init:=11.5477, Avg_Gap_best:=7.8798, Avg_Cost_init:=1.7529, Avg_Cost_best:=1.6955, Avg_Otpimal_best:=1.5706, Avg_counts: =18.5600] 83%|████████▎ | 25/30 [00:14<00:02,  2.34it/s, Sum_GNN_time:=3.8712, Sum_Search_time:=4.2624, Avg_Gap_init:=11.5477, Avg_Gap_best:=7.8798, Avg_Cost_init:=1.7529, Avg_Cost_best:=1.6955, Avg_Otpimal_best:=1.5706, Avg_counts: =18.5600] 83%|████████▎ | 25/30 [00:14<00:02,  2.34it/s, Sum_GNN_time:=3.9273, Sum_Search_time:=4.4231, Avg_Gap_init:=11.3578, Avg_Gap_best:=7.8126, Avg_Cost_init:=1.7457, Avg_Cost_best:=1.6902, Avg_Otpimal_best:=1.5667, Avg_counts: =18.5385] 87%|████████▋ | 26/30 [00:14<00:01,  2.41it/s, Sum_GNN_time:=3.9273, Sum_Search_time:=4.4231, Avg_Gap_init:=11.3578, Avg_Gap_best:=7.8126, Avg_Cost_init:=1.7457, Avg_Cost_best:=1.6902, Avg_Otpimal_best:=1.5667, Avg_counts: =18.5385] 87%|████████▋ | 26/30 [00:14<00:01,  2.41it/s, Sum_GNN_time:=3.9835, Sum_Search_time:=4.5853, Avg_Gap_init:=11.3107, Avg_Gap_best:=7.8968, Avg_Cost_init:=1.7399, Avg_Cost_best:=1.6864, Avg_Otpimal_best:=1.5621, Avg_counts: =18.4444] 90%|█████████ | 27/30 [00:14<00:01,  2.46it/s, Sum_GNN_time:=3.9835, Sum_Search_time:=4.5853, Avg_Gap_init:=11.3107, Avg_Gap_best:=7.8968, Avg_Cost_init:=1.7399, Avg_Cost_best:=1.6864, Avg_Otpimal_best:=1.5621, Avg_counts: =18.4444] 90%|█████████ | 27/30 [00:15<00:01,  2.46it/s, Sum_GNN_time:=4.0407, Sum_Search_time:=4.7586, Avg_Gap_init:=11.2604, Avg_Gap_best:=7.8381, Avg_Cost_init:=1.7374, Avg_Cost_best:=1.6839, Avg_Otpimal_best:=1.5606, Avg_counts: =18.6429] 93%|█████████▎| 28/30 [00:15<00:00,  2.48it/s, Sum_GNN_time:=4.0407, Sum_Search_time:=4.7586, Avg_Gap_init:=11.2604, Avg_Gap_best:=7.8381, Avg_Cost_init:=1.7374, Avg_Cost_best:=1.6839, Avg_Otpimal_best:=1.5606, Avg_counts: =18.6429] 93%|█████████▎| 28/30 [00:15<00:00,  2.48it/s, Sum_GNN_time:=4.0975, Sum_Search_time:=4.9301, Avg_Gap_init:=11.3544, Avg_Gap_best:=7.9115, Avg_Cost_init:=1.7421, Avg_Cost_best:=1.6881, Avg_Otpimal_best:=1.5635, Avg_counts: =18.8276] 97%|█████████▋| 29/30 [00:15<00:00,  2.33it/s, Sum_GNN_time:=4.0975, Sum_Search_time:=4.9301, Avg_Gap_init:=11.3544, Avg_Gap_best:=7.9115, Avg_Cost_init:=1.7421, Avg_Cost_best:=1.6881, Avg_Otpimal_best:=1.5635, Avg_counts: =18.8276] 97%|█████████▋| 29/30 [00:16<00:00,  2.33it/s, Sum_GNN_time:=4.1545, Sum_Search_time:=5.1024, Avg_Gap_init:=11.4942, Avg_Gap_best:=7.9839, Avg_Cost_init:=1.7418, Avg_Cost_best:=1.6869, Avg_Otpimal_best:=1.5613, Avg_counts: =19.0000]100%|██████████| 30/30 [00:16<00:00,  2.39it/s, Sum_GNN_time:=4.1545, Sum_Search_time:=5.1024, Avg_Gap_init:=11.4942, Avg_Gap_best:=7.9839, Avg_Cost_init:=1.7418, Avg_Cost_best:=1.6869, Avg_Otpimal_best:=1.5613, Avg_counts: =19.0000]100%|██████████| 30/30 [00:16<00:00,  1.85it/s, Sum_GNN_time:=4.1545, Sum_Search_time:=5.1024, Avg_Gap_init:=11.4942, Avg_Gap_best:=7.9839, Avg_Cost_init:=1.7418, Avg_Cost_best:=1.6869, Avg_Otpimal_best:=1.5613, Avg_counts: =19.0000]
Total time for model prediction: 4.1545 seconds
Total time for guided local search: 5.1024 seconds
