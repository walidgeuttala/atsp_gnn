Namespace(data_dir='../tsp_input/generated_insatnces_3000_size_50/', tb_dir='../atsp_model_train_result', atsp_size=50, to_homo=False, half_st=False, model='HetroGATConcat', input_dim=1, hidden_dim=128, output_dim=1, relation_types='ss st tt pp', n_gnn_layers=4, n_heads=64, jk='cat', lr_init=0.001, lr_decay=0.95, min_delta=0.0001, patience=200, batch_size=15, n_epochs=100, checkpoint_freq=10, seed=4, n_trials=1, n_samples_result_train=30, device='cuda')
Namespace(atsp_size=150, data_path='../tsp_input/generated_insatnces_30_size_150', model_path='../atsp_model_train_result/Oct15_14-45-35_HetroGATConcat_trained_ATSP50/trial_0', time_limit=0.16, perturbation_moves=5, device='cuda')
device = cuda
model: HetroGATConcat trained in ATSP50 for 100 and tested in ATSP150 for 30
  0%|          | 0/30 [00:00<?, ?it/s]  0%|          | 0/30 [00:09<?, ?it/s, Sum_GNN_time:=6.6950, Sum_Search_time:=0.1663, Avg_Gap_init:=11.1742, Avg_Gap_best:=7.1196, Avg_Cost_init:=1.7721, Avg_Cost_best:=1.7075, Avg_Otpimal_best:=1.5940, Avg_counts: =8.0000]  3%|▎         | 1/30 [00:09<04:49,  9.97s/it, Sum_GNN_time:=6.6950, Sum_Search_time:=0.1663, Avg_Gap_init:=11.1742, Avg_Gap_best:=7.1196, Avg_Cost_init:=1.7721, Avg_Cost_best:=1.7075, Avg_Otpimal_best:=1.5940, Avg_counts: =8.0000]  3%|▎         | 1/30 [00:10<04:49,  9.97s/it, Sum_GNN_time:=6.9287, Sum_Search_time:=0.3318, Avg_Gap_init:=13.5617, Avg_Gap_best:=10.6518, Avg_Cost_init:=1.7773, Avg_Cost_best:=1.7314, Avg_Otpimal_best:=1.5656, Avg_counts: =8.0000]  7%|▋         | 2/30 [00:10<02:10,  4.65s/it, Sum_GNN_time:=6.9287, Sum_Search_time:=0.3318, Avg_Gap_init:=13.5617, Avg_Gap_best:=10.6518, Avg_Cost_init:=1.7773, Avg_Cost_best:=1.7314, Avg_Otpimal_best:=1.5656, Avg_counts: =8.0000]  7%|▋         | 2/30 [00:11<02:10,  4.65s/it, Sum_GNN_time:=7.1599, Sum_Search_time:=0.4949, Avg_Gap_init:=13.8367, Avg_Gap_best:=10.9660, Avg_Cost_init:=1.7771, Avg_Cost_best:=1.7321, Avg_Otpimal_best:=1.5615, Avg_counts: =8.0000] 10%|█         | 3/30 [00:11<01:17,  2.89s/it, Sum_GNN_time:=7.1599, Sum_Search_time:=0.4949, Avg_Gap_init:=13.8367, Avg_Gap_best:=10.9660, Avg_Cost_init:=1.7771, Avg_Cost_best:=1.7321, Avg_Otpimal_best:=1.5615, Avg_counts: =8.0000] 10%|█         | 3/30 [00:12<01:17,  2.89s/it, Sum_GNN_time:=7.3107, Sum_Search_time:=0.7005, Avg_Gap_init:=13.8127, Avg_Gap_best:=11.6597, Avg_Cost_init:=1.7487, Avg_Cost_best:=1.7149, Avg_Otpimal_best:=1.5368, Avg_counts: =8.5000] 13%|█▎        | 4/30 [00:12<00:54,  2.09s/it, Sum_GNN_time:=7.3107, Sum_Search_time:=0.7005, Avg_Gap_init:=13.8127, Avg_Gap_best:=11.6597, Avg_Cost_init:=1.7487, Avg_Cost_best:=1.7149, Avg_Otpimal_best:=1.5368, Avg_counts: =8.5000] 13%|█▎        | 4/30 [00:13<00:54,  2.09s/it, Sum_GNN_time:=7.4609, Sum_Search_time:=0.8641, Avg_Gap_init:=14.0566, Avg_Gap_best:=11.5390, Avg_Cost_init:=1.7667, Avg_Cost_best:=1.7270, Avg_Otpimal_best:=1.5491, Avg_counts: =8.4000] 17%|█▋        | 5/30 [00:13<00:40,  1.61s/it, Sum_GNN_time:=7.4609, Sum_Search_time:=0.8641, Avg_Gap_init:=14.0566, Avg_Gap_best:=11.5390, Avg_Cost_init:=1.7667, Avg_Cost_best:=1.7270, Avg_Otpimal_best:=1.5491, Avg_counts: =8.4000] 17%|█▋        | 5/30 [00:14<00:40,  1.61s/it, Sum_GNN_time:=7.6107, Sum_Search_time:=1.0288, Avg_Gap_init:=14.7774, Avg_Gap_best:=12.2220, Avg_Cost_init:=1.8163, Avg_Cost_best:=1.7753, Avg_Otpimal_best:=1.5816, Avg_counts: =8.3333] 20%|██        | 6/30 [00:14<00:32,  1.34s/it, Sum_GNN_time:=7.6107, Sum_Search_time:=1.0288, Avg_Gap_init:=14.7774, Avg_Gap_best:=12.2220, Avg_Cost_init:=1.8163, Avg_Cost_best:=1.7753, Avg_Otpimal_best:=1.5816, Avg_counts: =8.3333] 20%|██        | 6/30 [00:14<00:32,  1.34s/it, Sum_GNN_time:=7.7618, Sum_Search_time:=1.1935, Avg_Gap_init:=14.2626, Avg_Gap_best:=11.6763, Avg_Cost_init:=1.8203, Avg_Cost_best:=1.7785, Avg_Otpimal_best:=1.5926, Avg_counts: =8.2857] 23%|██▎       | 7/30 [00:14<00:26,  1.14s/it, Sum_GNN_time:=7.7618, Sum_Search_time:=1.1935, Avg_Gap_init:=14.2626, Avg_Gap_best:=11.6763, Avg_Cost_init:=1.8203, Avg_Cost_best:=1.7785, Avg_Otpimal_best:=1.5926, Avg_counts: =8.2857] 23%|██▎       | 7/30 [00:15<00:26,  1.14s/it, Sum_GNN_time:=7.9121, Sum_Search_time:=1.3598, Avg_Gap_init:=14.0632, Avg_Gap_best:=11.6874, Avg_Cost_init:=1.8248, Avg_Cost_best:=1.7863, Avg_Otpimal_best:=1.5994, Avg_counts: =8.2500] 27%|██▋       | 8/30 [00:15<00:22,  1.02s/it, Sum_GNN_time:=7.9121, Sum_Search_time:=1.3598, Avg_Gap_init:=14.0632, Avg_Gap_best:=11.6874, Avg_Cost_init:=1.8248, Avg_Cost_best:=1.7863, Avg_Otpimal_best:=1.5994, Avg_counts: =8.2500] 27%|██▋       | 8/30 [00:16<00:22,  1.02s/it, Sum_GNN_time:=8.0620, Sum_Search_time:=1.5259, Avg_Gap_init:=14.2175, Avg_Gap_best:=11.9701, Avg_Cost_init:=1.8129, Avg_Cost_best:=1.7767, Avg_Otpimal_best:=1.5871, Avg_counts: =8.2222] 30%|███       | 9/30 [00:16<00:20,  1.03it/s, Sum_GNN_time:=8.0620, Sum_Search_time:=1.5259, Avg_Gap_init:=14.2175, Avg_Gap_best:=11.9701, Avg_Cost_init:=1.8129, Avg_Cost_best:=1.7767, Avg_Otpimal_best:=1.5871, Avg_counts: =8.2222] 30%|███       | 9/30 [00:17<00:20,  1.03it/s, Sum_GNN_time:=8.2118, Sum_Search_time:=1.6909, Avg_Gap_init:=14.1254, Avg_Gap_best:=11.8481, Avg_Cost_init:=1.8117, Avg_Cost_best:=1.7751, Avg_Otpimal_best:=1.5873, Avg_counts: =8.2000] 33%|███▎      | 10/30 [00:17<00:18,  1.11it/s, Sum_GNN_time:=8.2118, Sum_Search_time:=1.6909, Avg_Gap_init:=14.1254, Avg_Gap_best:=11.8481, Avg_Cost_init:=1.8117, Avg_Cost_best:=1.7751, Avg_Otpimal_best:=1.5873, Avg_counts: =8.2000] 33%|███▎      | 10/30 [00:18<00:18,  1.11it/s, Sum_GNN_time:=8.3885, Sum_Search_time:=1.8555, Avg_Gap_init:=13.9449, Avg_Gap_best:=11.5909, Avg_Cost_init:=1.8015, Avg_Cost_best:=1.7639, Avg_Otpimal_best:=1.5808, Avg_counts: =8.1818] 37%|███▋      | 11/30 [00:18<00:16,  1.13it/s, Sum_GNN_time:=8.3885, Sum_Search_time:=1.8555, Avg_Gap_init:=13.9449, Avg_Gap_best:=11.5909, Avg_Cost_init:=1.8015, Avg_Cost_best:=1.7639, Avg_Otpimal_best:=1.5808, Avg_counts: =8.1818] 37%|███▋      | 11/30 [00:18<00:16,  1.13it/s, Sum_GNN_time:=8.5382, Sum_Search_time:=2.0227, Avg_Gap_init:=13.8724, Avg_Gap_best:=11.3570, Avg_Cost_init:=1.7982, Avg_Cost_best:=1.7582, Avg_Otpimal_best:=1.5789, Avg_counts: =8.1667] 40%|████      | 12/30 [00:18<00:15,  1.19it/s, Sum_GNN_time:=8.5382, Sum_Search_time:=2.0227, Avg_Gap_init:=13.8724, Avg_Gap_best:=11.3570, Avg_Cost_init:=1.7982, Avg_Cost_best:=1.7582, Avg_Otpimal_best:=1.5789, Avg_counts: =8.1667] 40%|████      | 12/30 [00:19<00:15,  1.19it/s, Sum_GNN_time:=8.6876, Sum_Search_time:=2.1873, Avg_Gap_init:=13.9613, Avg_Gap_best:=11.3868, Avg_Cost_init:=1.8009, Avg_Cost_best:=1.7599, Avg_Otpimal_best:=1.5800, Avg_counts: =8.1538] 43%|████▎     | 13/30 [00:19<00:13,  1.23it/s, Sum_GNN_time:=8.6876, Sum_Search_time:=2.1873, Avg_Gap_init:=13.9613, Avg_Gap_best:=11.3868, Avg_Cost_init:=1.8009, Avg_Cost_best:=1.7599, Avg_Otpimal_best:=1.5800, Avg_counts: =8.1538] 43%|████▎     | 13/30 [00:20<00:13,  1.23it/s, Sum_GNN_time:=8.8370, Sum_Search_time:=2.3529, Avg_Gap_init:=13.7253, Avg_Gap_best:=11.1664, Avg_Cost_init:=1.8019, Avg_Cost_best:=1.7611, Avg_Otpimal_best:=1.5843, Avg_counts: =8.1429] 47%|████▋     | 14/30 [00:20<00:13,  1.22it/s, Sum_GNN_time:=8.8370, Sum_Search_time:=2.3529, Avg_Gap_init:=13.7253, Avg_Gap_best:=11.1664, Avg_Cost_init:=1.8019, Avg_Cost_best:=1.7611, Avg_Otpimal_best:=1.5843, Avg_counts: =8.1429] 47%|████▋     | 14/30 [00:21<00:13,  1.22it/s, Sum_GNN_time:=8.9872, Sum_Search_time:=2.5174, Avg_Gap_init:=13.4147, Avg_Gap_best:=10.9785, Avg_Cost_init:=1.7946, Avg_Cost_best:=1.7558, Avg_Otpimal_best:=1.5822, Avg_counts: =8.1333] 50%|█████     | 15/30 [00:21<00:11,  1.27it/s, Sum_GNN_time:=8.9872, Sum_Search_time:=2.5174, Avg_Gap_init:=13.4147, Avg_Gap_best:=10.9785, Avg_Cost_init:=1.7946, Avg_Cost_best:=1.7558, Avg_Otpimal_best:=1.5822, Avg_counts: =8.1333] 50%|█████     | 15/30 [00:21<00:11,  1.27it/s, Sum_GNN_time:=9.1364, Sum_Search_time:=2.6844, Avg_Gap_init:=13.4439, Avg_Gap_best:=11.0645, Avg_Cost_init:=1.8025, Avg_Cost_best:=1.7645, Avg_Otpimal_best:=1.5887, Avg_counts: =8.1250] 53%|█████▎    | 16/30 [00:21<00:11,  1.25it/s, Sum_GNN_time:=9.1364, Sum_Search_time:=2.6844, Avg_Gap_init:=13.4439, Avg_Gap_best:=11.0645, Avg_Cost_init:=1.8025, Avg_Cost_best:=1.7645, Avg_Otpimal_best:=1.5887, Avg_counts: =8.1250] 53%|█████▎    | 16/30 [00:22<00:11,  1.25it/s, Sum_GNN_time:=9.2864, Sum_Search_time:=2.8472, Avg_Gap_init:=13.6536, Avg_Gap_best:=11.2015, Avg_Cost_init:=1.8014, Avg_Cost_best:=1.7624, Avg_Otpimal_best:=1.5849, Avg_counts: =8.1176] 57%|█████▋    | 17/30 [00:22<00:10,  1.27it/s, Sum_GNN_time:=9.2864, Sum_Search_time:=2.8472, Avg_Gap_init:=13.6536, Avg_Gap_best:=11.2015, Avg_Cost_init:=1.8014, Avg_Cost_best:=1.7624, Avg_Otpimal_best:=1.5849, Avg_counts: =8.1176] 57%|█████▋    | 17/30 [00:23<00:10,  1.27it/s, Sum_GNN_time:=9.4350, Sum_Search_time:=3.0117, Avg_Gap_init:=13.5548, Avg_Gap_best:=11.1282, Avg_Cost_init:=1.7962, Avg_Cost_best:=1.7577, Avg_Otpimal_best:=1.5817, Avg_counts: =8.1111] 60%|██████    | 18/30 [00:23<00:09,  1.25it/s, Sum_GNN_time:=9.4350, Sum_Search_time:=3.0117, Avg_Gap_init:=13.5548, Avg_Gap_best:=11.1282, Avg_Cost_init:=1.7962, Avg_Cost_best:=1.7577, Avg_Otpimal_best:=1.5817, Avg_counts: =8.1111] 60%|██████    | 18/30 [00:24<00:09,  1.25it/s, Sum_GNN_time:=9.5851, Sum_Search_time:=3.1765, Avg_Gap_init:=13.3347, Avg_Gap_best:=10.9422, Avg_Cost_init:=1.8001, Avg_Cost_best:=1.7620, Avg_Otpimal_best:=1.5885, Avg_counts: =8.1053] 63%|██████▎   | 19/30 [00:24<00:08,  1.30it/s, Sum_GNN_time:=9.5851, Sum_Search_time:=3.1765, Avg_Gap_init:=13.3347, Avg_Gap_best:=10.9422, Avg_Cost_init:=1.8001, Avg_Cost_best:=1.7620, Avg_Otpimal_best:=1.5885, Avg_counts: =8.1053] 63%|██████▎   | 19/30 [00:24<00:08,  1.30it/s, Sum_GNN_time:=9.7352, Sum_Search_time:=3.3436, Avg_Gap_init:=13.2888, Avg_Gap_best:=11.0145, Avg_Cost_init:=1.7989, Avg_Cost_best:=1.7627, Avg_Otpimal_best:=1.5880, Avg_counts: =8.1000] 67%|██████▋   | 20/30 [00:24<00:07,  1.32it/s, Sum_GNN_time:=9.7352, Sum_Search_time:=3.3436, Avg_Gap_init:=13.2888, Avg_Gap_best:=11.0145, Avg_Cost_init:=1.7989, Avg_Cost_best:=1.7627, Avg_Otpimal_best:=1.5880, Avg_counts: =8.1000] 67%|██████▋   | 20/30 [00:25<00:07,  1.32it/s, Sum_GNN_time:=9.8845, Sum_Search_time:=3.5090, Avg_Gap_init:=13.2807, Avg_Gap_best:=10.9790, Avg_Cost_init:=1.7968, Avg_Cost_best:=1.7602, Avg_Otpimal_best:=1.5862, Avg_counts: =8.0952] 70%|███████   | 21/30 [00:25<00:07,  1.27it/s, Sum_GNN_time:=9.8845, Sum_Search_time:=3.5090, Avg_Gap_init:=13.2807, Avg_Gap_best:=10.9790, Avg_Cost_init:=1.7968, Avg_Cost_best:=1.7602, Avg_Otpimal_best:=1.5862, Avg_counts: =8.0952] 70%|███████   | 21/30 [00:26<00:07,  1.27it/s, Sum_GNN_time:=10.0342, Sum_Search_time:=3.6742, Avg_Gap_init:=13.2802, Avg_Gap_best:=10.9817, Avg_Cost_init:=1.7951, Avg_Cost_best:=1.7586, Avg_Otpimal_best:=1.5848, Avg_counts: =8.0909] 73%|███████▎  | 22/30 [00:26<00:06,  1.30it/s, Sum_GNN_time:=10.0342, Sum_Search_time:=3.6742, Avg_Gap_init:=13.2802, Avg_Gap_best:=10.9817, Avg_Cost_init:=1.7951, Avg_Cost_best:=1.7586, Avg_Otpimal_best:=1.5848, Avg_counts: =8.0909] 73%|███████▎  | 22/30 [00:27<00:06,  1.30it/s, Sum_GNN_time:=10.1836, Sum_Search_time:=3.8408, Avg_Gap_init:=13.5131, Avg_Gap_best:=11.1257, Avg_Cost_init:=1.8052, Avg_Cost_best:=1.7670, Avg_Otpimal_best:=1.5902, Avg_counts: =8.0870] 77%|███████▋  | 23/30 [00:27<00:05,  1.26it/s, Sum_GNN_time:=10.1836, Sum_Search_time:=3.8408, Avg_Gap_init:=13.5131, Avg_Gap_best:=11.1257, Avg_Cost_init:=1.8052, Avg_Cost_best:=1.7670, Avg_Otpimal_best:=1.5902, Avg_counts: =8.0870] 77%|███████▋  | 23/30 [00:28<00:05,  1.26it/s, Sum_GNN_time:=10.3330, Sum_Search_time:=4.0066, Avg_Gap_init:=13.5200, Avg_Gap_best:=11.1531, Avg_Cost_init:=1.8110, Avg_Cost_best:=1.7731, Avg_Otpimal_best:=1.5952, Avg_counts: =8.0833] 80%|████████  | 24/30 [00:28<00:04,  1.30it/s, Sum_GNN_time:=10.3330, Sum_Search_time:=4.0066, Avg_Gap_init:=13.5200, Avg_Gap_best:=11.1531, Avg_Cost_init:=1.8110, Avg_Cost_best:=1.7731, Avg_Otpimal_best:=1.5952, Avg_counts: =8.0833] 80%|████████  | 24/30 [00:28<00:04,  1.30it/s, Sum_GNN_time:=10.4824, Sum_Search_time:=4.1731, Avg_Gap_init:=13.4501, Avg_Gap_best:=11.1095, Avg_Cost_init:=1.8142, Avg_Cost_best:=1.7767, Avg_Otpimal_best:=1.5991, Avg_counts: =8.0800] 83%|████████▎ | 25/30 [00:28<00:03,  1.33it/s, Sum_GNN_time:=10.4824, Sum_Search_time:=4.1731, Avg_Gap_init:=13.4501, Avg_Gap_best:=11.1095, Avg_Cost_init:=1.8142, Avg_Cost_best:=1.7767, Avg_Otpimal_best:=1.5991, Avg_counts: =8.0800] 83%|████████▎ | 25/30 [00:29<00:03,  1.33it/s, Sum_GNN_time:=10.6322, Sum_Search_time:=4.3383, Avg_Gap_init:=13.4570, Avg_Gap_best:=11.0918, Avg_Cost_init:=1.8144, Avg_Cost_best:=1.7765, Avg_Otpimal_best:=1.5991, Avg_counts: =8.0769] 87%|████████▋ | 26/30 [00:29<00:03,  1.29it/s, Sum_GNN_time:=10.6322, Sum_Search_time:=4.3383, Avg_Gap_init:=13.4570, Avg_Gap_best:=11.0918, Avg_Cost_init:=1.8144, Avg_Cost_best:=1.7765, Avg_Otpimal_best:=1.5991, Avg_counts: =8.0769] 87%|████████▋ | 26/30 [00:30<00:03,  1.29it/s, Sum_GNN_time:=10.7820, Sum_Search_time:=4.5046, Avg_Gap_init:=13.3883, Avg_Gap_best:=10.9680, Avg_Cost_init:=1.8127, Avg_Cost_best:=1.7739, Avg_Otpimal_best:=1.5986, Avg_counts: =8.0741] 90%|█████████ | 27/30 [00:30<00:02,  1.32it/s, Sum_GNN_time:=10.7820, Sum_Search_time:=4.5046, Avg_Gap_init:=13.3883, Avg_Gap_best:=10.9680, Avg_Cost_init:=1.8127, Avg_Cost_best:=1.7739, Avg_Otpimal_best:=1.5986, Avg_counts: =8.0741] 90%|█████████ | 27/30 [00:31<00:02,  1.32it/s, Sum_GNN_time:=10.9323, Sum_Search_time:=4.6697, Avg_Gap_init:=13.3642, Avg_Gap_best:=10.9835, Avg_Cost_init:=1.8133, Avg_Cost_best:=1.7751, Avg_Otpimal_best:=1.5994, Avg_counts: =8.0714] 93%|█████████▎| 28/30 [00:31<00:01,  1.29it/s, Sum_GNN_time:=10.9323, Sum_Search_time:=4.6697, Avg_Gap_init:=13.3642, Avg_Gap_best:=10.9835, Avg_Cost_init:=1.8133, Avg_Cost_best:=1.7751, Avg_Otpimal_best:=1.5994, Avg_counts: =8.0714] 93%|█████████▎| 28/30 [00:31<00:01,  1.29it/s, Sum_GNN_time:=11.0819, Sum_Search_time:=4.8345, Avg_Gap_init:=13.2845, Avg_Gap_best:=10.9732, Avg_Cost_init:=1.8162, Avg_Cost_best:=1.7791, Avg_Otpimal_best:=1.6032, Avg_counts: =8.0690] 97%|█████████▋| 29/30 [00:31<00:00,  1.32it/s, Sum_GNN_time:=11.0819, Sum_Search_time:=4.8345, Avg_Gap_init:=13.2845, Avg_Gap_best:=10.9732, Avg_Cost_init:=1.8162, Avg_Cost_best:=1.7791, Avg_Otpimal_best:=1.6032, Avg_counts: =8.0690] 97%|█████████▋| 29/30 [00:32<00:00,  1.32it/s, Sum_GNN_time:=11.2304, Sum_Search_time:=5.0010, Avg_Gap_init:=13.0941, Avg_Gap_best:=10.8496, Avg_Cost_init:=1.8133, Avg_Cost_best:=1.7773, Avg_Otpimal_best:=1.6034, Avg_counts: =8.0667]100%|██████████| 30/30 [00:32<00:00,  1.28it/s, Sum_GNN_time:=11.2304, Sum_Search_time:=5.0010, Avg_Gap_init:=13.0941, Avg_Gap_best:=10.8496, Avg_Cost_init:=1.8133, Avg_Cost_best:=1.7773, Avg_Otpimal_best:=1.6034, Avg_counts: =8.0667]100%|██████████| 30/30 [00:32<00:00,  1.09s/it, Sum_GNN_time:=11.2304, Sum_Search_time:=5.0010, Avg_Gap_init:=13.0941, Avg_Gap_best:=10.8496, Avg_Cost_init:=1.8133, Avg_Cost_best:=1.7773, Avg_Otpimal_best:=1.6034, Avg_counts: =8.0667]
Total time for model prediction: 11.2304 seconds
Total time for guided local search: 5.0010 seconds
