device = cuda
  0%|          | 0/100 [00:00<?, ?it/s]initial cost 151 best_tour 151, optimal_tour 1.4238450065458892
initial cost 1.7758520046336344 best_cost 1.680103000064264, optimal_cost 1.4238450065458892
/home/p_gnngw/miniconda3/envs/cuda118/lib/python3.12/site-packages/numpy/lib/function_base.py:2897: RuntimeWarning: invalid value encountered in divide
  c /= stddev[:, None]
/home/p_gnngw/miniconda3/envs/cuda118/lib/python3.12/site-packages/numpy/lib/function_base.py:2898: RuntimeWarning: invalid value encountered in divide
  c /= stddev[None, :]
/project/p_gnn001/code/tsp/tsp_gnn/utils.py:99: RuntimeWarning: invalid value encountered in scalar divide
  similarity = dot_product / (norm_A * norm_B)
  0%|          | 0/100 [00:12<?, ?it/s, Sum GNN time:=10.8005, Sum Search time:=0.5801, Avg Gap init:=24.7223, Avg Gap best:=17.9976, Avg Cost init:=1.7759, Avg Cost best:=1.6801, Avg Otpimal best:=1.4238, Avg counts =32.0000]  1%|          | 1/100 [00:12<20:42, 12.55s/it, Sum GNN time:=10.8005, Sum Search time:=0.5801, Avg Gap init:=24.7223, Avg Gap best:=17.9976, Avg Cost init:=1.7759, Avg Cost best:=1.6801, Avg Otpimal best:=1.4238, Avg counts =32.0000]initial cost 151 best_tour 151, optimal_tour 1.6473829969982035
initial cost 1.8781849932711339 best_cost 1.84239199104195, optimal_cost 1.6473829969982035
/home/p_gnngw/miniconda3/envs/cuda118/lib/python3.12/site-packages/numpy/lib/function_base.py:2897: RuntimeWarning: invalid value encountered in divide
  c /= stddev[:, None]
/home/p_gnngw/miniconda3/envs/cuda118/lib/python3.12/site-packages/numpy/lib/function_base.py:2898: RuntimeWarning: invalid value encountered in divide
  c /= stddev[None, :]
/project/p_gnn001/code/tsp/tsp_gnn/utils.py:99: RuntimeWarning: invalid value encountered in scalar divide
  similarity = dot_product / (norm_A * norm_B)
  1%|          | 1/100 [00:23<20:42, 12.55s/it, Sum GNN time:=21.0234, Sum Search time:=0.8813, Avg Gap init:=19.3663, Avg Gap best:=14.9176, Avg Cost init:=1.8270, Avg Cost best:=1.7612, Avg Otpimal best:=1.5356, Avg counts =24.0000]  2%|▏         | 2/100 [00:23<18:56, 11.60s/it, Sum GNN time:=21.0234, Sum Search time:=0.8813, Avg Gap init:=19.3663, Avg Gap best:=14.9176, Avg Cost init:=1.8270, Avg Cost best:=1.7612, Avg Otpimal best:=1.5356, Avg counts =24.0000]initial cost 151 best_tour 151, optimal_tour 1.6442829948791768
initial cost 1.9361910026345868 best_cost 1.8630329992447514, optimal_cost 1.6442829948791768
/home/p_gnngw/miniconda3/envs/cuda118/lib/python3.12/site-packages/numpy/lib/function_base.py:2897: RuntimeWarning: invalid value encountered in divide
  c /= stddev[:, None]
/home/p_gnngw/miniconda3/envs/cuda118/lib/python3.12/site-packages/numpy/lib/function_base.py:2898: RuntimeWarning: invalid value encountered in divide
  c /= stddev[None, :]
/project/p_gnn001/code/tsp/tsp_gnn/utils.py:99: RuntimeWarning: invalid value encountered in scalar divide
  similarity = dot_product / (norm_A * norm_B)
  2%|▏         | 2/100 [00:34<18:56, 11.60s/it, Sum GNN time:=31.2038, Sum Search time:=1.3209, Avg Gap init:=18.8285, Avg Gap best:=14.3796, Avg Cost init:=1.8634, Avg Cost best:=1.7952, Avg Otpimal best:=1.5718, Avg counts =24.0000]  3%|▎         | 3/100 [00:34<18:21, 11.36s/it, Sum GNN time:=31.2038, Sum Search time:=1.3209, Avg Gap init:=18.8285, Avg Gap best:=14.3796, Avg Cost init:=1.8634, Avg Cost best:=1.7952, Avg Otpimal best:=1.5718, Avg counts =24.0000]initial cost 151 best_tour 151, optimal_tour 1.5385309944758774
initial cost 1.8493030016252305 best_cost 1.7895389954501297, optimal_cost 1.5385309944758774
/home/p_gnngw/miniconda3/envs/cuda118/lib/python3.12/site-packages/numpy/lib/function_base.py:2897: RuntimeWarning: invalid value encountered in divide
  c /= stddev[:, None]
/home/p_gnngw/miniconda3/envs/cuda118/lib/python3.12/site-packages/numpy/lib/function_base.py:2898: RuntimeWarning: invalid value encountered in divide
  c /= stddev[None, :]
/project/p_gnn001/code/tsp/tsp_gnn/utils.py:99: RuntimeWarning: invalid value encountered in scalar divide
  similarity = dot_product / (norm_A * norm_B)
  3%|▎         | 3/100 [00:46<18:21, 11.36s/it, Sum GNN time:=41.1962, Sum Search time:=2.3446, Avg Gap init:=19.1712, Avg Gap best:=14.8634, Avg Cost init:=1.8599, Avg Cost best:=1.7938, Avg Otpimal best:=1.5635, Avg counts =23.0000]  4%|▍         | 4/100 [00:46<18:18, 11.44s/it, Sum GNN time:=41.1962, Sum Search time:=2.3446, Avg Gap init:=19.1712, Avg Gap best:=14.8634, Avg Cost init:=1.8599, Avg Cost best:=1.7938, Avg Otpimal best:=1.5635, Avg counts =23.0000]initial cost 151 best_tour 151, optimal_tour 1.4861699927987502
initial cost 1.780167986113156 best_cost 1.7724339922988293, optimal_cost 1.4861699927987502
/home/p_gnngw/miniconda3/envs/cuda118/lib/python3.12/site-packages/numpy/lib/function_base.py:2897: RuntimeWarning: invalid value encountered in divide
  c /= stddev[:, None]
/home/p_gnngw/miniconda3/envs/cuda118/lib/python3.12/site-packages/numpy/lib/function_base.py:2898: RuntimeWarning: invalid value encountered in divide
  c /= stddev[None, :]
/project/p_gnn001/code/tsp/tsp_gnn/utils.py:99: RuntimeWarning: invalid value encountered in scalar divide
  similarity = dot_product / (norm_A * norm_B)
  4%|▍         | 4/100 [01:03<18:18, 11.44s/it, Sum GNN time:=56.4983, Sum Search time:=3.1785, Avg Gap init:=19.2934, Avg Gap best:=15.7431, Avg Cost init:=1.8439, Avg Cost best:=1.7895, Avg Otpimal best:=1.5480, Avg counts =21.6000]  5%|▌         | 5/100 [01:03<21:18, 13.46s/it, Sum GNN time:=56.4983, Sum Search time:=3.1785, Avg Gap init:=19.2934, Avg Gap best:=15.7431, Avg Cost init:=1.8439, Avg Cost best:=1.7895, Avg Otpimal best:=1.5480, Avg counts =21.6000]initial cost 151 best_tour 151, optimal_tour 1.5584309947043948
initial cost 1.8163019947842258 best_cost 1.6960279928189266, optimal_cost 1.5584309947043948
/home/p_gnngw/miniconda3/envs/cuda118/lib/python3.12/site-packages/numpy/lib/function_base.py:2897: RuntimeWarning: invalid value encountered in divide
  c /= stddev[:, None]
/home/p_gnngw/miniconda3/envs/cuda118/lib/python3.12/site-packages/numpy/lib/function_base.py:2898: RuntimeWarning: invalid value encountered in divide
  c /= stddev[None, :]
/project/p_gnn001/code/tsp/tsp_gnn/utils.py:99: RuntimeWarning: invalid value encountered in scalar divide
  similarity = dot_product / (norm_A * norm_B)
  5%|▌         | 5/100 [01:16<21:18, 13.46s/it, Sum GNN time:=68.8751, Sum Search time:=3.5496, Avg Gap init:=18.8356, Avg Gap best:=14.5908, Avg Cost init:=1.8393, Avg Cost best:=1.7739, Avg Otpimal best:=1.5498, Avg counts =21.3333]  6%|▌         | 6/100 [01:16<20:58, 13.39s/it, Sum GNN time:=68.8751, Sum Search time:=3.5496, Avg Gap init:=18.8356, Avg Gap best:=14.5908, Avg Cost init:=1.8393, Avg Cost best:=1.7739, Avg Otpimal best:=1.5498, Avg counts =21.3333]  6%|▌         | 6/100 [01:26<22:33, 14.40s/it, Sum GNN time:=68.8751, Sum Search time:=3.5496, Avg Gap init:=18.8356, Avg Gap best:=14.5908, Avg Cost init:=1.8393, Avg Cost best:=1.7739, Avg Otpimal best:=1.5498, Avg counts =21.3333]
Traceback (most recent call last):
  File "/project/p_gnn001/code/tsp/tsp_gnn/test.py", line 83, in <module>
    best_tour, best_cost, search_progress_i, cnt_ans = algorithms.guided_local_search(G, init_tour, init_cost,
                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/project/p_gnn001/code/tsp/tsp_gnn/gnngls/algorithms.py", line 166, in guided_local_search
    util = G[e[0]][e[1]][guide] / (1 + G[e[0]][e[1]]['penalty'])
           ~~~~~~~~~~~~~^^^^^^^
KeyError: 'r'
