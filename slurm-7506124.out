Namespace(data_dir='../tsp_input/generated_insatnces_3000_size_50/', tb_dir='../atsp_model_train_result', atsp_size=50, to_homo=False, half_st=False, model='HetroGATConcat', input_dim=1, hidden_dim=128, output_dim=1, relation_types='ss st tt pp', n_gnn_layers=4, n_heads=64, jk='cat', lr_init=0.001, lr_decay=0.95, min_delta=0.0001, patience=200, batch_size=15, n_epochs=100, checkpoint_freq=10, seed=4, n_trials=1, n_samples_result_train=30, device='cuda')
Namespace(atsp_size=150, data_path='../tsp_input/generated_insatnces_30_size_150', model_path='../atsp_model_train_result/Oct15_14-45-35_HetroGATConcat_trained_ATSP50/trial_0', time_limit=0.16, perturbation_moves=5, device='cuda')
device = cuda
model: HetroGATConcat trained in ATSP50 for 100 and tested in ATSP150 for 30
  0%|          | 0/30 [00:00<?, ?it/s]  0%|          | 0/30 [00:01<?, ?it/s, Sum_GNN_time:=0.8747, Sum_Search_time:=0.2137, Avg_Gap_init:=11.1742, Avg_Gap_best:=6.9154, Avg_Cost_init:=1.7721, Avg_Cost_best:=1.7042, Avg_Otpimal_best:=1.5940, Avg_counts: =12.0000]  3%|▎         | 1/30 [00:01<00:49,  1.71s/it, Sum_GNN_time:=0.8747, Sum_Search_time:=0.2137, Avg_Gap_init:=11.1742, Avg_Gap_best:=6.9154, Avg_Cost_init:=1.7721, Avg_Cost_best:=1.7042, Avg_Otpimal_best:=1.5940, Avg_counts: =12.0000]  3%|▎         | 1/30 [00:02<00:49,  1.71s/it, Sum_GNN_time:=1.0224, Sum_Search_time:=0.3752, Avg_Gap_init:=13.5617, Avg_Gap_best:=10.5497, Avg_Cost_init:=1.7773, Avg_Cost_best:=1.7298, Avg_Otpimal_best:=1.5656, Avg_counts: =10.0000]  7%|▋         | 2/30 [00:02<00:32,  1.16s/it, Sum_GNN_time:=1.0224, Sum_Search_time:=0.3752, Avg_Gap_init:=13.5617, Avg_Gap_best:=10.5497, Avg_Cost_init:=1.7773, Avg_Cost_best:=1.7298, Avg_Otpimal_best:=1.5656, Avg_counts: =10.0000]  7%|▋         | 2/30 [00:03<00:32,  1.16s/it, Sum_GNN_time:=1.1707, Sum_Search_time:=0.6032, Avg_Gap_init:=13.8367, Avg_Gap_best:=10.8979, Avg_Cost_init:=1.7771, Avg_Cost_best:=1.7310, Avg_Otpimal_best:=1.5615, Avg_counts: =10.6667] 10%|█         | 3/30 [00:03<00:26,  1.02it/s, Sum_GNN_time:=1.1707, Sum_Search_time:=0.6032, Avg_Gap_init:=13.8367, Avg_Gap_best:=10.8979, Avg_Cost_init:=1.7771, Avg_Cost_best:=1.7310, Avg_Otpimal_best:=1.5615, Avg_counts: =10.6667] 10%|█         | 3/30 [00:04<00:26,  1.02it/s, Sum_GNN_time:=1.3203, Sum_Search_time:=0.8001, Avg_Gap_init:=13.8127, Avg_Gap_best:=11.6086, Avg_Cost_init:=1.7487, Avg_Cost_best:=1.7141, Avg_Otpimal_best:=1.5368, Avg_counts: =10.5000] 13%|█▎        | 4/30 [00:04<00:23,  1.09it/s, Sum_GNN_time:=1.3203, Sum_Search_time:=0.8001, Avg_Gap_init:=13.8127, Avg_Gap_best:=11.6086, Avg_Cost_init:=1.7487, Avg_Cost_best:=1.7141, Avg_Otpimal_best:=1.5368, Avg_counts: =10.5000] 13%|█▎        | 4/30 [00:04<00:23,  1.09it/s, Sum_GNN_time:=1.4702, Sum_Search_time:=0.9603, Avg_Gap_init:=14.0566, Avg_Gap_best:=11.4981, Avg_Cost_init:=1.7667, Avg_Cost_best:=1.7263, Avg_Otpimal_best:=1.5491, Avg_counts: =10.0000] 17%|█▋        | 5/30 [00:04<00:20,  1.19it/s, Sum_GNN_time:=1.4702, Sum_Search_time:=0.9603, Avg_Gap_init:=14.0566, Avg_Gap_best:=11.4981, Avg_Cost_init:=1.7667, Avg_Cost_best:=1.7263, Avg_Otpimal_best:=1.5491, Avg_counts: =10.0000] 17%|█▋        | 5/30 [00:05<00:20,  1.19it/s, Sum_GNN_time:=1.6195, Sum_Search_time:=1.1206, Avg_Gap_init:=14.7774, Avg_Gap_best:=12.1880, Avg_Cost_init:=1.8163, Avg_Cost_best:=1.7747, Avg_Otpimal_best:=1.5816, Avg_counts: =9.6667]  20%|██        | 6/30 [00:05<00:19,  1.20it/s, Sum_GNN_time:=1.6195, Sum_Search_time:=1.1206, Avg_Gap_init:=14.7774, Avg_Gap_best:=12.1880, Avg_Cost_init:=1.8163, Avg_Cost_best:=1.7747, Avg_Otpimal_best:=1.5816, Avg_counts: =9.6667] 20%|██        | 6/30 [00:06<00:19,  1.20it/s, Sum_GNN_time:=1.7684, Sum_Search_time:=1.2815, Avg_Gap_init:=14.2626, Avg_Gap_best:=11.6472, Avg_Cost_init:=1.8203, Avg_Cost_best:=1.7780, Avg_Otpimal_best:=1.5926, Avg_counts: =9.4286] 23%|██▎       | 7/30 [00:06<00:18,  1.25it/s, Sum_GNN_time:=1.7684, Sum_Search_time:=1.2815, Avg_Gap_init:=14.2626, Avg_Gap_best:=11.6472, Avg_Cost_init:=1.8203, Avg_Cost_best:=1.7780, Avg_Otpimal_best:=1.5926, Avg_counts: =9.4286] 23%|██▎       | 7/30 [00:07<00:18,  1.25it/s, Sum_GNN_time:=1.9185, Sum_Search_time:=1.4430, Avg_Gap_init:=14.0632, Avg_Gap_best:=11.6619, Avg_Cost_init:=1.8248, Avg_Cost_best:=1.7859, Avg_Otpimal_best:=1.5994, Avg_counts: =9.2500] 27%|██▋       | 8/30 [00:07<00:17,  1.29it/s, Sum_GNN_time:=1.9185, Sum_Search_time:=1.4430, Avg_Gap_init:=14.0632, Avg_Gap_best:=11.6619, Avg_Cost_init:=1.8248, Avg_Cost_best:=1.7859, Avg_Otpimal_best:=1.5994, Avg_counts: =9.2500] 27%|██▋       | 8/30 [00:07<00:17,  1.29it/s, Sum_GNN_time:=2.0685, Sum_Search_time:=1.6726, Avg_Gap_init:=14.2175, Avg_Gap_best:=11.8758, Avg_Cost_init:=1.8129, Avg_Cost_best:=1.7753, Avg_Otpimal_best:=1.5871, Avg_counts: =9.5556] 30%|███       | 9/30 [00:07<00:16,  1.25it/s, Sum_GNN_time:=2.0685, Sum_Search_time:=1.6726, Avg_Gap_init:=14.2175, Avg_Gap_best:=11.8758, Avg_Cost_init:=1.8129, Avg_Cost_best:=1.7753, Avg_Otpimal_best:=1.5871, Avg_counts: =9.5556] 30%|███       | 9/30 [00:08<00:16,  1.25it/s, Sum_GNN_time:=2.2175, Sum_Search_time:=1.8328, Avg_Gap_init:=14.1254, Avg_Gap_best:=11.7631, Avg_Cost_init:=1.8117, Avg_Cost_best:=1.7739, Avg_Otpimal_best:=1.5873, Avg_counts: =9.4000] 33%|███▎      | 10/30 [00:08<00:15,  1.30it/s, Sum_GNN_time:=2.2175, Sum_Search_time:=1.8328, Avg_Gap_init:=14.1254, Avg_Gap_best:=11.7631, Avg_Cost_init:=1.8117, Avg_Cost_best:=1.7739, Avg_Otpimal_best:=1.5873, Avg_counts: =9.4000] 33%|███▎      | 10/30 [00:09<00:15,  1.30it/s, Sum_GNN_time:=2.3675, Sum_Search_time:=1.9942, Avg_Gap_init:=13.9449, Avg_Gap_best:=11.5137, Avg_Cost_init:=1.8015, Avg_Cost_best:=1.7627, Avg_Otpimal_best:=1.5808, Avg_counts: =9.2727] 37%|███▋      | 11/30 [00:09<00:14,  1.29it/s, Sum_GNN_time:=2.3675, Sum_Search_time:=1.9942, Avg_Gap_init:=13.9449, Avg_Gap_best:=11.5137, Avg_Cost_init:=1.8015, Avg_Cost_best:=1.7627, Avg_Otpimal_best:=1.5808, Avg_counts: =9.2727] 37%|███▋      | 11/30 [00:10<00:14,  1.29it/s, Sum_GNN_time:=2.5177, Sum_Search_time:=2.1561, Avg_Gap_init:=13.8724, Avg_Gap_best:=11.2862, Avg_Cost_init:=1.7982, Avg_Cost_best:=1.7571, Avg_Otpimal_best:=1.5789, Avg_counts: =9.1667] 40%|████      | 12/30 [00:10<00:13,  1.33it/s, Sum_GNN_time:=2.5177, Sum_Search_time:=2.1561, Avg_Gap_init:=13.8724, Avg_Gap_best:=11.2862, Avg_Cost_init:=1.7982, Avg_Cost_best:=1.7571, Avg_Otpimal_best:=1.5789, Avg_counts: =9.1667] 40%|████      | 12/30 [00:10<00:13,  1.33it/s, Sum_GNN_time:=2.6681, Sum_Search_time:=2.3169, Avg_Gap_init:=13.9613, Avg_Gap_best:=11.3215, Avg_Cost_init:=1.8009, Avg_Cost_best:=1.7589, Avg_Otpimal_best:=1.5800, Avg_counts: =9.0769] 43%|████▎     | 13/30 [00:10<00:12,  1.34it/s, Sum_GNN_time:=2.6681, Sum_Search_time:=2.3169, Avg_Gap_init:=13.9613, Avg_Gap_best:=11.3215, Avg_Cost_init:=1.8009, Avg_Cost_best:=1.7589, Avg_Otpimal_best:=1.5800, Avg_counts: =9.0769] 43%|████▎     | 13/30 [00:11<00:12,  1.34it/s, Sum_GNN_time:=2.8177, Sum_Search_time:=2.4781, Avg_Gap_init:=13.7253, Avg_Gap_best:=11.1057, Avg_Cost_init:=1.8019, Avg_Cost_best:=1.7602, Avg_Otpimal_best:=1.5843, Avg_counts: =9.0000] 47%|████▋     | 14/30 [00:11<00:12,  1.31it/s, Sum_GNN_time:=2.8177, Sum_Search_time:=2.4781, Avg_Gap_init:=13.7253, Avg_Gap_best:=11.1057, Avg_Cost_init:=1.8019, Avg_Cost_best:=1.7602, Avg_Otpimal_best:=1.5843, Avg_counts: =9.0000] 47%|████▋     | 14/30 [00:12<00:12,  1.31it/s, Sum_GNN_time:=2.9668, Sum_Search_time:=2.6546, Avg_Gap_init:=13.4147, Avg_Gap_best:=10.9219, Avg_Cost_init:=1.7946, Avg_Cost_best:=1.7550, Avg_Otpimal_best:=1.5822, Avg_counts: =8.6667] 50%|█████     | 15/30 [00:12<00:11,  1.34it/s, Sum_GNN_time:=2.9668, Sum_Search_time:=2.6546, Avg_Gap_init:=13.4147, Avg_Gap_best:=10.9219, Avg_Cost_init:=1.7946, Avg_Cost_best:=1.7550, Avg_Otpimal_best:=1.5822, Avg_counts: =8.6667] 50%|█████     | 15/30 [00:13<00:11,  1.34it/s, Sum_GNN_time:=3.1158, Sum_Search_time:=2.8167, Avg_Gap_init:=13.4439, Avg_Gap_best:=11.0114, Avg_Cost_init:=1.8025, Avg_Cost_best:=1.7637, Avg_Otpimal_best:=1.5887, Avg_counts: =8.6250] 53%|█████▎    | 16/30 [00:13<00:10,  1.32it/s, Sum_GNN_time:=3.1158, Sum_Search_time:=2.8167, Avg_Gap_init:=13.4439, Avg_Gap_best:=11.0114, Avg_Cost_init:=1.8025, Avg_Cost_best:=1.7637, Avg_Otpimal_best:=1.5887, Avg_counts: =8.6250] 53%|█████▎    | 16/30 [00:13<00:10,  1.32it/s, Sum_GNN_time:=3.2660, Sum_Search_time:=3.0450, Avg_Gap_init:=13.6536, Avg_Gap_best:=11.0981, Avg_Cost_init:=1.8014, Avg_Cost_best:=1.7608, Avg_Otpimal_best:=1.5849, Avg_counts: =8.8235] 57%|█████▋    | 17/30 [00:13<00:09,  1.31it/s, Sum_GNN_time:=3.2660, Sum_Search_time:=3.0450, Avg_Gap_init:=13.6536, Avg_Gap_best:=11.0981, Avg_Cost_init:=1.8014, Avg_Cost_best:=1.7608, Avg_Otpimal_best:=1.5849, Avg_counts: =8.8235] 57%|█████▋    | 17/30 [00:14<00:09,  1.31it/s, Sum_GNN_time:=3.4145, Sum_Search_time:=3.2061, Avg_Gap_init:=13.5548, Avg_Gap_best:=11.0305, Avg_Cost_init:=1.7962, Avg_Cost_best:=1.7562, Avg_Otpimal_best:=1.5817, Avg_counts: =8.7778] 60%|██████    | 18/30 [00:14<00:09,  1.29it/s, Sum_GNN_time:=3.4145, Sum_Search_time:=3.2061, Avg_Gap_init:=13.5548, Avg_Gap_best:=11.0305, Avg_Cost_init:=1.7962, Avg_Cost_best:=1.7562, Avg_Otpimal_best:=1.5817, Avg_counts: =8.7778] 60%|██████    | 18/30 [00:15<00:09,  1.29it/s, Sum_GNN_time:=3.5642, Sum_Search_time:=3.3694, Avg_Gap_init:=13.3347, Avg_Gap_best:=10.8497, Avg_Cost_init:=1.8001, Avg_Cost_best:=1.7606, Avg_Otpimal_best:=1.5885, Avg_counts: =8.7368] 63%|██████▎   | 19/30 [00:15<00:08,  1.32it/s, Sum_GNN_time:=3.5642, Sum_Search_time:=3.3694, Avg_Gap_init:=13.3347, Avg_Gap_best:=10.8497, Avg_Cost_init:=1.8001, Avg_Cost_best:=1.7606, Avg_Otpimal_best:=1.5885, Avg_counts: =8.7368] 63%|██████▎   | 19/30 [00:16<00:08,  1.32it/s, Sum_GNN_time:=3.7136, Sum_Search_time:=3.5304, Avg_Gap_init:=13.2888, Avg_Gap_best:=10.9266, Avg_Cost_init:=1.7989, Avg_Cost_best:=1.7613, Avg_Otpimal_best:=1.5880, Avg_counts: =8.7000] 67%|██████▋   | 20/30 [00:16<00:07,  1.35it/s, Sum_GNN_time:=3.7136, Sum_Search_time:=3.5304, Avg_Gap_init:=13.2888, Avg_Gap_best:=10.9266, Avg_Cost_init:=1.7989, Avg_Cost_best:=1.7613, Avg_Otpimal_best:=1.5880, Avg_counts: =8.7000] 67%|██████▋   | 20/30 [00:16<00:07,  1.35it/s, Sum_GNN_time:=3.8643, Sum_Search_time:=3.6927, Avg_Gap_init:=13.2807, Avg_Gap_best:=10.8953, Avg_Cost_init:=1.7968, Avg_Cost_best:=1.7589, Avg_Otpimal_best:=1.5862, Avg_counts: =8.6667] 70%|███████   | 21/30 [00:16<00:06,  1.31it/s, Sum_GNN_time:=3.8643, Sum_Search_time:=3.6927, Avg_Gap_init:=13.2807, Avg_Gap_best:=10.8953, Avg_Cost_init:=1.7968, Avg_Cost_best:=1.7589, Avg_Otpimal_best:=1.5862, Avg_counts: =8.6667] 70%|███████   | 21/30 [00:17<00:06,  1.31it/s, Sum_GNN_time:=4.0135, Sum_Search_time:=3.8538, Avg_Gap_init:=13.2802, Avg_Gap_best:=10.9017, Avg_Cost_init:=1.7951, Avg_Cost_best:=1.7574, Avg_Otpimal_best:=1.5848, Avg_counts: =8.6364] 73%|███████▎  | 22/30 [00:17<00:06,  1.33it/s, Sum_GNN_time:=4.0135, Sum_Search_time:=3.8538, Avg_Gap_init:=13.2802, Avg_Gap_best:=10.9017, Avg_Cost_init:=1.7951, Avg_Cost_best:=1.7574, Avg_Otpimal_best:=1.5848, Avg_counts: =8.6364] 73%|███████▎  | 22/30 [00:18<00:06,  1.33it/s, Sum_GNN_time:=4.1627, Sum_Search_time:=4.0164, Avg_Gap_init:=13.5131, Avg_Gap_best:=11.0493, Avg_Cost_init:=1.8052, Avg_Cost_best:=1.7659, Avg_Otpimal_best:=1.5902, Avg_counts: =8.6087] 77%|███████▋  | 23/30 [00:18<00:05,  1.30it/s, Sum_GNN_time:=4.1627, Sum_Search_time:=4.0164, Avg_Gap_init:=13.5131, Avg_Gap_best:=11.0493, Avg_Cost_init:=1.8052, Avg_Cost_best:=1.7659, Avg_Otpimal_best:=1.5902, Avg_counts: =8.6087] 77%|███████▋  | 23/30 [00:19<00:05,  1.30it/s, Sum_GNN_time:=4.3129, Sum_Search_time:=4.1785, Avg_Gap_init:=13.5200, Avg_Gap_best:=11.0799, Avg_Cost_init:=1.8110, Avg_Cost_best:=1.7720, Avg_Otpimal_best:=1.5952, Avg_counts: =8.5833] 80%|████████  | 24/30 [00:19<00:04,  1.33it/s, Sum_GNN_time:=4.3129, Sum_Search_time:=4.1785, Avg_Gap_init:=13.5200, Avg_Gap_best:=11.0799, Avg_Cost_init:=1.8110, Avg_Cost_best:=1.7720, Avg_Otpimal_best:=1.5952, Avg_counts: =8.5833] 80%|████████  | 24/30 [00:19<00:04,  1.33it/s, Sum_GNN_time:=4.4630, Sum_Search_time:=4.3393, Avg_Gap_init:=13.4501, Avg_Gap_best:=11.0391, Avg_Cost_init:=1.8142, Avg_Cost_best:=1.7756, Avg_Otpimal_best:=1.5991, Avg_counts: =8.5600] 83%|████████▎ | 25/30 [00:19<00:03,  1.36it/s, Sum_GNN_time:=4.4630, Sum_Search_time:=4.3393, Avg_Gap_init:=13.4501, Avg_Gap_best:=11.0391, Avg_Cost_init:=1.8142, Avg_Cost_best:=1.7756, Avg_Otpimal_best:=1.5991, Avg_counts: =8.5600] 83%|████████▎ | 25/30 [00:20<00:03,  1.36it/s, Sum_GNN_time:=4.6124, Sum_Search_time:=4.5003, Avg_Gap_init:=13.4570, Avg_Gap_best:=11.0241, Avg_Cost_init:=1.8144, Avg_Cost_best:=1.7754, Avg_Otpimal_best:=1.5991, Avg_counts: =8.5385] 87%|████████▋ | 26/30 [00:20<00:03,  1.31it/s, Sum_GNN_time:=4.6124, Sum_Search_time:=4.5003, Avg_Gap_init:=13.4570, Avg_Gap_best:=11.0241, Avg_Cost_init:=1.8144, Avg_Cost_best:=1.7754, Avg_Otpimal_best:=1.5991, Avg_counts: =8.5385] 87%|████████▋ | 26/30 [00:21<00:03,  1.31it/s, Sum_GNN_time:=4.7617, Sum_Search_time:=4.6621, Avg_Gap_init:=13.3883, Avg_Gap_best:=10.9029, Avg_Cost_init:=1.8127, Avg_Cost_best:=1.7729, Avg_Otpimal_best:=1.5986, Avg_counts: =8.5185] 90%|█████████ | 27/30 [00:21<00:02,  1.34it/s, Sum_GNN_time:=4.7617, Sum_Search_time:=4.6621, Avg_Gap_init:=13.3883, Avg_Gap_best:=10.9029, Avg_Cost_init:=1.8127, Avg_Cost_best:=1.7729, Avg_Otpimal_best:=1.5986, Avg_counts: =8.5185] 90%|█████████ | 27/30 [00:22<00:02,  1.34it/s, Sum_GNN_time:=4.9128, Sum_Search_time:=4.8226, Avg_Gap_init:=13.3642, Avg_Gap_best:=10.9207, Avg_Cost_init:=1.8133, Avg_Cost_best:=1.7741, Avg_Otpimal_best:=1.5994, Avg_counts: =8.5000] 93%|█████████▎| 28/30 [00:22<00:01,  1.30it/s, Sum_GNN_time:=4.9128, Sum_Search_time:=4.8226, Avg_Gap_init:=13.3642, Avg_Gap_best:=10.9207, Avg_Cost_init:=1.8133, Avg_Cost_best:=1.7741, Avg_Otpimal_best:=1.5994, Avg_counts: =8.5000] 93%|█████████▎| 28/30 [00:22<00:01,  1.30it/s, Sum_GNN_time:=5.0628, Sum_Search_time:=4.9840, Avg_Gap_init:=13.2845, Avg_Gap_best:=10.9126, Avg_Cost_init:=1.8162, Avg_Cost_best:=1.7782, Avg_Otpimal_best:=1.6032, Avg_counts: =8.4828] 97%|█████████▋| 29/30 [00:22<00:00,  1.33it/s, Sum_GNN_time:=5.0628, Sum_Search_time:=4.9840, Avg_Gap_init:=13.2845, Avg_Gap_best:=10.9126, Avg_Cost_init:=1.8162, Avg_Cost_best:=1.7782, Avg_Otpimal_best:=1.6032, Avg_counts: =8.4828] 97%|█████████▋| 29/30 [00:23<00:00,  1.33it/s, Sum_GNN_time:=5.2118, Sum_Search_time:=5.1455, Avg_Gap_init:=13.0941, Avg_Gap_best:=10.7910, Avg_Cost_init:=1.8133, Avg_Cost_best:=1.7764, Avg_Otpimal_best:=1.6034, Avg_counts: =8.4667]100%|██████████| 30/30 [00:23<00:00,  1.30it/s, Sum_GNN_time:=5.2118, Sum_Search_time:=5.1455, Avg_Gap_init:=13.0941, Avg_Gap_best:=10.7910, Avg_Cost_init:=1.8133, Avg_Cost_best:=1.7764, Avg_Otpimal_best:=1.6034, Avg_counts: =8.4667]100%|██████████| 30/30 [00:23<00:00,  1.26it/s, Sum_GNN_time:=5.2118, Sum_Search_time:=5.1455, Avg_Gap_init:=13.0941, Avg_Gap_best:=10.7910, Avg_Cost_init:=1.8133, Avg_Cost_best:=1.7764, Avg_Otpimal_best:=1.6034, Avg_counts: =8.4667]
Total time for model prediction: 5.2118 seconds
Total time for guided local search: 5.1455 seconds
