Namespace(data_dir='../tsp_input/generated_insatnces_3000_size_50/', tb_dir='../atsp_model_train_result', atsp_size=50, to_homo=False, half_st=False, model='HetroGATSum', input_dim=1, hidden_dim=128, output_dim=1, relation_types='ss st tt pp', n_gnn_layers=4, n_heads=64, jk='cat', lr_init=0.001, lr_decay=0.95, min_delta=0.0001, patience=200, batch_size=15, n_epochs=100, checkpoint_freq=10, seed=4, n_trials=1, n_samples_result_train=30, device='cuda')
Namespace(atsp_size=150, data_path='../tsp_input/generated_insatnces_30_size_150', model_path='../atsp_model_train_result/Oct15_17-34-03_HetroGATSum_trained_ATSP50/trial_0', time_limit=0.16, perturbation_moves=5, device='cuda')
device = cuda
model: HetroGATSum trained in ATSP50 for 100 and tested in ATSP150 for 30
  0%|          | 0/30 [00:00<?, ?it/s]  0%|          | 0/30 [00:01<?, ?it/s, Sum_GNN_time:=0.8582, Sum_Search_time:=0.2152, Avg_Gap_init:=22.0369, Avg_Gap_best:=19.2992, Avg_Cost_init:=1.9453, Avg_Cost_best:=1.9016, Avg_Otpimal_best:=1.5940, Avg_counts: =12.0000]  3%|▎         | 1/30 [00:01<00:48,  1.69s/it, Sum_GNN_time:=0.8582, Sum_Search_time:=0.2152, Avg_Gap_init:=22.0369, Avg_Gap_best:=19.2992, Avg_Cost_init:=1.9453, Avg_Cost_best:=1.9016, Avg_Otpimal_best:=1.5940, Avg_counts: =12.0000]  3%|▎         | 1/30 [00:02<00:48,  1.69s/it, Sum_GNN_time:=1.0048, Sum_Search_time:=0.3791, Avg_Gap_init:=20.5525, Avg_Gap_best:=17.4908, Avg_Cost_init:=1.8878, Avg_Cost_best:=1.8400, Avg_Otpimal_best:=1.5656, Avg_counts: =10.0000]  7%|▋         | 2/30 [00:02<00:32,  1.16s/it, Sum_GNN_time:=1.0048, Sum_Search_time:=0.3791, Avg_Gap_init:=20.5525, Avg_Gap_best:=17.4908, Avg_Cost_init:=1.8878, Avg_Cost_best:=1.8400, Avg_Otpimal_best:=1.5656, Avg_counts: =10.0000]  7%|▋         | 2/30 [00:03<00:32,  1.16s/it, Sum_GNN_time:=1.1523, Sum_Search_time:=0.5415, Avg_Gap_init:=19.9189, Avg_Gap_best:=17.1392, Avg_Cost_init:=1.8729, Avg_Cost_best:=1.8295, Avg_Otpimal_best:=1.5615, Avg_counts: =9.3333]  10%|█         | 3/30 [00:03<00:25,  1.04it/s, Sum_GNN_time:=1.1523, Sum_Search_time:=0.5415, Avg_Gap_init:=19.9189, Avg_Gap_best:=17.1392, Avg_Cost_init:=1.8729, Avg_Cost_best:=1.8295, Avg_Otpimal_best:=1.5615, Avg_counts: =9.3333] 10%|█         | 3/30 [00:03<00:25,  1.04it/s, Sum_GNN_time:=1.3007, Sum_Search_time:=0.7064, Avg_Gap_init:=20.0915, Avg_Gap_best:=17.6094, Avg_Cost_init:=1.8457, Avg_Cost_best:=1.8073, Avg_Otpimal_best:=1.5368, Avg_counts: =9.0000] 13%|█▎        | 4/30 [00:03<00:23,  1.12it/s, Sum_GNN_time:=1.3007, Sum_Search_time:=0.7064, Avg_Gap_init:=20.0915, Avg_Gap_best:=17.6094, Avg_Cost_init:=1.8457, Avg_Cost_best:=1.8073, Avg_Otpimal_best:=1.5368, Avg_counts: =9.0000] 13%|█▎        | 4/30 [00:04<00:23,  1.12it/s, Sum_GNN_time:=1.4497, Sum_Search_time:=0.8702, Avg_Gap_init:=18.8468, Avg_Gap_best:=16.4009, Avg_Cost_init:=1.8406, Avg_Cost_best:=1.8025, Avg_Otpimal_best:=1.5491, Avg_counts: =8.8000] 17%|█▋        | 5/30 [00:04<00:20,  1.22it/s, Sum_GNN_time:=1.4497, Sum_Search_time:=0.8702, Avg_Gap_init:=18.8468, Avg_Gap_best:=16.4009, Avg_Cost_init:=1.8406, Avg_Cost_best:=1.8025, Avg_Otpimal_best:=1.5491, Avg_counts: =8.8000] 17%|█▋        | 5/30 [00:05<00:20,  1.22it/s, Sum_GNN_time:=1.5976, Sum_Search_time:=1.0352, Avg_Gap_init:=18.5091, Avg_Gap_best:=15.7320, Avg_Cost_init:=1.8733, Avg_Cost_best:=1.8288, Avg_Otpimal_best:=1.5816, Avg_counts: =8.6667] 20%|██        | 6/30 [00:05<00:19,  1.22it/s, Sum_GNN_time:=1.5976, Sum_Search_time:=1.0352, Avg_Gap_init:=18.5091, Avg_Gap_best:=15.7320, Avg_Cost_init:=1.8733, Avg_Cost_best:=1.8288, Avg_Otpimal_best:=1.5816, Avg_counts: =8.6667] 20%|██        | 6/30 [00:06<00:19,  1.22it/s, Sum_GNN_time:=1.7462, Sum_Search_time:=1.1981, Avg_Gap_init:=18.5171, Avg_Gap_best:=15.8745, Avg_Cost_init:=1.8866, Avg_Cost_best:=1.8441, Avg_Otpimal_best:=1.5926, Avg_counts: =8.5714] 23%|██▎       | 7/30 [00:06<00:18,  1.27it/s, Sum_GNN_time:=1.7462, Sum_Search_time:=1.1981, Avg_Gap_init:=18.5171, Avg_Gap_best:=15.8745, Avg_Cost_init:=1.8866, Avg_Cost_best:=1.8441, Avg_Otpimal_best:=1.5926, Avg_counts: =8.5714] 23%|██▎       | 7/30 [00:06<00:18,  1.27it/s, Sum_GNN_time:=1.8959, Sum_Search_time:=1.3625, Avg_Gap_init:=18.1126, Avg_Gap_best:=15.6749, Avg_Cost_init:=1.8882, Avg_Cost_best:=1.8489, Avg_Otpimal_best:=1.5994, Avg_counts: =8.5000] 27%|██▋       | 8/30 [00:06<00:16,  1.31it/s, Sum_GNN_time:=1.8959, Sum_Search_time:=1.3625, Avg_Gap_init:=18.1126, Avg_Gap_best:=15.6749, Avg_Cost_init:=1.8882, Avg_Cost_best:=1.8489, Avg_Otpimal_best:=1.5994, Avg_counts: =8.5000] 27%|██▋       | 8/30 [00:07<00:16,  1.31it/s, Sum_GNN_time:=2.0447, Sum_Search_time:=1.5264, Avg_Gap_init:=19.0650, Avg_Gap_best:=16.4343, Avg_Cost_init:=1.8879, Avg_Cost_best:=1.8460, Avg_Otpimal_best:=1.5871, Avg_counts: =8.4444] 30%|███       | 9/30 [00:07<00:16,  1.28it/s, Sum_GNN_time:=2.0447, Sum_Search_time:=1.5264, Avg_Gap_init:=19.0650, Avg_Gap_best:=16.4343, Avg_Cost_init:=1.8879, Avg_Cost_best:=1.8460, Avg_Otpimal_best:=1.5871, Avg_counts: =8.4444] 30%|███       | 9/30 [00:08<00:16,  1.28it/s, Sum_GNN_time:=2.1932, Sum_Search_time:=1.6884, Avg_Gap_init:=19.9511, Avg_Gap_best:=17.3946, Avg_Cost_init:=1.9025, Avg_Cost_best:=1.8618, Avg_Otpimal_best:=1.5873, Avg_counts: =8.4000] 33%|███▎      | 10/30 [00:08<00:15,  1.32it/s, Sum_GNN_time:=2.1932, Sum_Search_time:=1.6884, Avg_Gap_init:=19.9511, Avg_Gap_best:=17.3946, Avg_Cost_init:=1.9025, Avg_Cost_best:=1.8618, Avg_Otpimal_best:=1.5873, Avg_counts: =8.4000] 33%|███▎      | 10/30 [00:09<00:15,  1.32it/s, Sum_GNN_time:=2.3412, Sum_Search_time:=1.8529, Avg_Gap_init:=19.1383, Avg_Gap_best:=16.6991, Avg_Cost_init:=1.8824, Avg_Cost_best:=1.8437, Avg_Otpimal_best:=1.5808, Avg_counts: =8.3636] 37%|███▋      | 11/30 [00:09<00:14,  1.29it/s, Sum_GNN_time:=2.3412, Sum_Search_time:=1.8529, Avg_Gap_init:=19.1383, Avg_Gap_best:=16.6991, Avg_Cost_init:=1.8824, Avg_Cost_best:=1.8437, Avg_Otpimal_best:=1.5808, Avg_counts: =8.3636] 37%|███▋      | 11/30 [00:09<00:14,  1.29it/s, Sum_GNN_time:=2.4894, Sum_Search_time:=2.0179, Avg_Gap_init:=19.2396, Avg_Gap_best:=16.7956, Avg_Cost_init:=1.8818, Avg_Cost_best:=1.8431, Avg_Otpimal_best:=1.5789, Avg_counts: =8.3333] 40%|████      | 12/30 [00:09<00:13,  1.32it/s, Sum_GNN_time:=2.4894, Sum_Search_time:=2.0179, Avg_Gap_init:=19.2396, Avg_Gap_best:=16.7956, Avg_Cost_init:=1.8818, Avg_Cost_best:=1.8431, Avg_Otpimal_best:=1.5789, Avg_counts: =8.3333] 40%|████      | 12/30 [00:10<00:13,  1.32it/s, Sum_GNN_time:=2.6381, Sum_Search_time:=2.1831, Avg_Gap_init:=19.5610, Avg_Gap_best:=17.1053, Avg_Cost_init:=1.8884, Avg_Cost_best:=1.8494, Avg_Otpimal_best:=1.5800, Avg_counts: =8.3077] 43%|████▎     | 13/30 [00:10<00:12,  1.34it/s, Sum_GNN_time:=2.6381, Sum_Search_time:=2.1831, Avg_Gap_init:=19.5610, Avg_Gap_best:=17.1053, Avg_Cost_init:=1.8884, Avg_Cost_best:=1.8494, Avg_Otpimal_best:=1.5800, Avg_counts: =8.3077] 43%|████▎     | 13/30 [00:11<00:12,  1.34it/s, Sum_GNN_time:=2.7872, Sum_Search_time:=2.3471, Avg_Gap_init:=19.6165, Avg_Gap_best:=17.1220, Avg_Cost_init:=1.8945, Avg_Cost_best:=1.8548, Avg_Otpimal_best:=1.5843, Avg_counts: =8.2857] 47%|████▋     | 14/30 [00:11<00:12,  1.31it/s, Sum_GNN_time:=2.7872, Sum_Search_time:=2.3471, Avg_Gap_init:=19.6165, Avg_Gap_best:=17.1220, Avg_Cost_init:=1.8945, Avg_Cost_best:=1.8548, Avg_Otpimal_best:=1.5843, Avg_counts: =8.2857] 47%|████▋     | 14/30 [00:12<00:12,  1.31it/s, Sum_GNN_time:=2.9350, Sum_Search_time:=2.5138, Avg_Gap_init:=19.5636, Avg_Gap_best:=17.0384, Avg_Cost_init:=1.8912, Avg_Cost_best:=1.8511, Avg_Otpimal_best:=1.5822, Avg_counts: =8.2667] 50%|█████     | 15/30 [00:12<00:11,  1.34it/s, Sum_GNN_time:=2.9350, Sum_Search_time:=2.5138, Avg_Gap_init:=19.5636, Avg_Gap_best:=17.0384, Avg_Cost_init:=1.8912, Avg_Cost_best:=1.8511, Avg_Otpimal_best:=1.5822, Avg_counts: =8.2667] 50%|█████     | 15/30 [00:13<00:11,  1.34it/s, Sum_GNN_time:=3.0830, Sum_Search_time:=2.6775, Avg_Gap_init:=19.5175, Avg_Gap_best:=17.0247, Avg_Cost_init:=1.8982, Avg_Cost_best:=1.8585, Avg_Otpimal_best:=1.5887, Avg_counts: =8.2500] 53%|█████▎    | 16/30 [00:13<00:10,  1.30it/s, Sum_GNN_time:=3.0830, Sum_Search_time:=2.6775, Avg_Gap_init:=19.5175, Avg_Gap_best:=17.0247, Avg_Cost_init:=1.8982, Avg_Cost_best:=1.8585, Avg_Otpimal_best:=1.5887, Avg_counts: =8.2500] 53%|█████▎    | 16/30 [00:13<00:10,  1.30it/s, Sum_GNN_time:=3.2313, Sum_Search_time:=2.8422, Avg_Gap_init:=19.3459, Avg_Gap_best:=16.6875, Avg_Cost_init:=1.8911, Avg_Cost_best:=1.8490, Avg_Otpimal_best:=1.5849, Avg_counts: =8.2353] 57%|█████▋    | 17/30 [00:13<00:09,  1.33it/s, Sum_GNN_time:=3.2313, Sum_Search_time:=2.8422, Avg_Gap_init:=19.3459, Avg_Gap_best:=16.6875, Avg_Cost_init:=1.8911, Avg_Cost_best:=1.8490, Avg_Otpimal_best:=1.5849, Avg_counts: =8.2353] 57%|█████▋    | 17/30 [00:14<00:09,  1.33it/s, Sum_GNN_time:=3.3790, Sum_Search_time:=3.0069, Avg_Gap_init:=19.5412, Avg_Gap_best:=16.8351, Avg_Cost_init:=1.8902, Avg_Cost_best:=1.8475, Avg_Otpimal_best:=1.5817, Avg_counts: =8.2222] 60%|██████    | 18/30 [00:14<00:09,  1.29it/s, Sum_GNN_time:=3.3790, Sum_Search_time:=3.0069, Avg_Gap_init:=19.5412, Avg_Gap_best:=16.8351, Avg_Cost_init:=1.8902, Avg_Cost_best:=1.8475, Avg_Otpimal_best:=1.5817, Avg_counts: =8.2222] 60%|██████    | 18/30 [00:15<00:09,  1.29it/s, Sum_GNN_time:=3.5271, Sum_Search_time:=3.1698, Avg_Gap_init:=19.2711, Avg_Gap_best:=16.5118, Avg_Cost_init:=1.8937, Avg_Cost_best:=1.8499, Avg_Otpimal_best:=1.5885, Avg_counts: =8.2105] 63%|██████▎   | 19/30 [00:15<00:08,  1.33it/s, Sum_GNN_time:=3.5271, Sum_Search_time:=3.1698, Avg_Gap_init:=19.2711, Avg_Gap_best:=16.5118, Avg_Cost_init:=1.8937, Avg_Cost_best:=1.8499, Avg_Otpimal_best:=1.5885, Avg_counts: =8.2105] 63%|██████▎   | 19/30 [00:15<00:08,  1.33it/s, Sum_GNN_time:=3.6746, Sum_Search_time:=3.3342, Avg_Gap_init:=19.3643, Avg_Gap_best:=16.5772, Avg_Cost_init:=1.8947, Avg_Cost_best:=1.8504, Avg_Otpimal_best:=1.5880, Avg_counts: =8.2000] 67%|██████▋   | 20/30 [00:15<00:07,  1.36it/s, Sum_GNN_time:=3.6746, Sum_Search_time:=3.3342, Avg_Gap_init:=19.3643, Avg_Gap_best:=16.5772, Avg_Cost_init:=1.8947, Avg_Cost_best:=1.8504, Avg_Otpimal_best:=1.5880, Avg_counts: =8.2000] 67%|██████▋   | 20/30 [00:16<00:07,  1.36it/s, Sum_GNN_time:=3.8225, Sum_Search_time:=3.4984, Avg_Gap_init:=18.9700, Avg_Gap_best:=16.2294, Avg_Cost_init:=1.8865, Avg_Cost_best:=1.8430, Avg_Otpimal_best:=1.5862, Avg_counts: =8.1905] 70%|███████   | 21/30 [00:16<00:06,  1.32it/s, Sum_GNN_time:=3.8225, Sum_Search_time:=3.4984, Avg_Gap_init:=18.9700, Avg_Gap_best:=16.2294, Avg_Cost_init:=1.8865, Avg_Cost_best:=1.8430, Avg_Otpimal_best:=1.5862, Avg_counts: =8.1905] 70%|███████   | 21/30 [00:17<00:06,  1.32it/s, Sum_GNN_time:=3.9711, Sum_Search_time:=3.6623, Avg_Gap_init:=18.7808, Avg_Gap_best:=16.0516, Avg_Cost_init:=1.8819, Avg_Cost_best:=1.8386, Avg_Otpimal_best:=1.5848, Avg_counts: =8.1818] 73%|███████▎  | 22/30 [00:17<00:05,  1.35it/s, Sum_GNN_time:=3.9711, Sum_Search_time:=3.6623, Avg_Gap_init:=18.7808, Avg_Gap_best:=16.0516, Avg_Cost_init:=1.8819, Avg_Cost_best:=1.8386, Avg_Otpimal_best:=1.5848, Avg_counts: =8.1818] 73%|███████▎  | 22/30 [00:18<00:05,  1.35it/s, Sum_GNN_time:=4.1197, Sum_Search_time:=3.8272, Avg_Gap_init:=19.0227, Avg_Gap_best:=16.2136, Avg_Cost_init:=1.8924, Avg_Cost_best:=1.8476, Avg_Otpimal_best:=1.5902, Avg_counts: =8.1739] 77%|███████▋  | 23/30 [00:18<00:05,  1.30it/s, Sum_GNN_time:=4.1197, Sum_Search_time:=3.8272, Avg_Gap_init:=19.0227, Avg_Gap_best:=16.2136, Avg_Cost_init:=1.8924, Avg_Cost_best:=1.8476, Avg_Otpimal_best:=1.5902, Avg_counts: =8.1739] 77%|███████▋  | 23/30 [00:19<00:05,  1.30it/s, Sum_GNN_time:=4.2686, Sum_Search_time:=3.9928, Avg_Gap_init:=18.9113, Avg_Gap_best:=16.0815, Avg_Cost_init:=1.8965, Avg_Cost_best:=1.8512, Avg_Otpimal_best:=1.5952, Avg_counts: =8.1667] 80%|████████  | 24/30 [00:19<00:04,  1.33it/s, Sum_GNN_time:=4.2686, Sum_Search_time:=3.9928, Avg_Gap_init:=18.9113, Avg_Gap_best:=16.0815, Avg_Cost_init:=1.8965, Avg_Cost_best:=1.8512, Avg_Otpimal_best:=1.5952, Avg_counts: =8.1667] 80%|████████  | 24/30 [00:19<00:04,  1.33it/s, Sum_GNN_time:=4.4167, Sum_Search_time:=4.1590, Avg_Gap_init:=19.0486, Avg_Gap_best:=16.2166, Avg_Cost_init:=1.9034, Avg_Cost_best:=1.8580, Avg_Otpimal_best:=1.5991, Avg_counts: =8.1600] 83%|████████▎ | 25/30 [00:19<00:03,  1.36it/s, Sum_GNN_time:=4.4167, Sum_Search_time:=4.1590, Avg_Gap_init:=19.0486, Avg_Gap_best:=16.2166, Avg_Cost_init:=1.9034, Avg_Cost_best:=1.8580, Avg_Otpimal_best:=1.5991, Avg_counts: =8.1600] 83%|████████▎ | 25/30 [00:20<00:03,  1.36it/s, Sum_GNN_time:=4.5670, Sum_Search_time:=4.3239, Avg_Gap_init:=19.2465, Avg_Gap_best:=16.4241, Avg_Cost_init:=1.9067, Avg_Cost_best:=1.8614, Avg_Otpimal_best:=1.5991, Avg_counts: =8.1538] 87%|████████▋ | 26/30 [00:20<00:03,  1.31it/s, Sum_GNN_time:=4.5670, Sum_Search_time:=4.3239, Avg_Gap_init:=19.2465, Avg_Gap_best:=16.4241, Avg_Cost_init:=1.9067, Avg_Cost_best:=1.8614, Avg_Otpimal_best:=1.5991, Avg_counts: =8.1538] 87%|████████▋ | 26/30 [00:21<00:03,  1.31it/s, Sum_GNN_time:=4.7162, Sum_Search_time:=4.4877, Avg_Gap_init:=19.2144, Avg_Gap_best:=16.3722, Avg_Cost_init:=1.9055, Avg_Cost_best:=1.8600, Avg_Otpimal_best:=1.5986, Avg_counts: =8.1481] 90%|█████████ | 27/30 [00:21<00:02,  1.33it/s, Sum_GNN_time:=4.7162, Sum_Search_time:=4.4877, Avg_Gap_init:=19.2144, Avg_Gap_best:=16.3722, Avg_Cost_init:=1.9055, Avg_Cost_best:=1.8600, Avg_Otpimal_best:=1.5986, Avg_counts: =8.1481] 90%|█████████ | 27/30 [00:22<00:02,  1.33it/s, Sum_GNN_time:=4.8651, Sum_Search_time:=4.6522, Avg_Gap_init:=19.6171, Avg_Gap_best:=16.6903, Avg_Cost_init:=1.9131, Avg_Cost_best:=1.8662, Avg_Otpimal_best:=1.5994, Avg_counts: =8.1429] 93%|█████████▎| 28/30 [00:22<00:01,  1.29it/s, Sum_GNN_time:=4.8651, Sum_Search_time:=4.6522, Avg_Gap_init:=19.6171, Avg_Gap_best:=16.6903, Avg_Cost_init:=1.9131, Avg_Cost_best:=1.8662, Avg_Otpimal_best:=1.5994, Avg_counts: =8.1429] 93%|█████████▎| 28/30 [00:22<00:01,  1.29it/s, Sum_GNN_time:=5.0149, Sum_Search_time:=4.8179, Avg_Gap_init:=19.6146, Avg_Gap_best:=16.7241, Avg_Cost_init:=1.9176, Avg_Cost_best:=1.8712, Avg_Otpimal_best:=1.6032, Avg_counts: =8.1379] 97%|█████████▋| 29/30 [00:22<00:00,  1.31it/s, Sum_GNN_time:=5.0149, Sum_Search_time:=4.8179, Avg_Gap_init:=19.6146, Avg_Gap_best:=16.7241, Avg_Cost_init:=1.9176, Avg_Cost_best:=1.8712, Avg_Otpimal_best:=1.6032, Avg_counts: =8.1379] 97%|█████████▋| 29/30 [00:23<00:00,  1.31it/s, Sum_GNN_time:=5.1638, Sum_Search_time:=4.9823, Avg_Gap_init:=19.5823, Avg_Gap_best:=16.6348, Avg_Cost_init:=1.9173, Avg_Cost_best:=1.8699, Avg_Otpimal_best:=1.6034, Avg_counts: =8.1333]100%|██████████| 30/30 [00:23<00:00,  1.27it/s, Sum_GNN_time:=5.1638, Sum_Search_time:=4.9823, Avg_Gap_init:=19.5823, Avg_Gap_best:=16.6348, Avg_Cost_init:=1.9173, Avg_Cost_best:=1.8699, Avg_Otpimal_best:=1.6034, Avg_counts: =8.1333]100%|██████████| 30/30 [00:23<00:00,  1.27it/s, Sum_GNN_time:=5.1638, Sum_Search_time:=4.9823, Avg_Gap_init:=19.5823, Avg_Gap_best:=16.6348, Avg_Cost_init:=1.9173, Avg_Cost_best:=1.8699, Avg_Otpimal_best:=1.6034, Avg_counts: =8.1333]
Total time for model prediction: 5.1638 seconds
Total time for guided local search: 4.9823 seconds
