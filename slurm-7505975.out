Namespace(data_dir='../tsp_input/generated_insatnces_3000_size_50/', tb_dir='../atsp_model_train_result', atsp_size=50, to_homo=False, half_st=False, model='HetroGATConcat', input_dim=1, hidden_dim=128, output_dim=1, relation_types='ss st tt pp', n_gnn_layers=4, n_heads=64, jk='cat', lr_init=0.001, lr_decay=0.95, min_delta=0.0001, patience=200, batch_size=15, n_epochs=100, checkpoint_freq=10, seed=4, n_trials=1, n_samples_result_train=30, device='cuda')
Namespace(atsp_size=250, data_path='../tsp_input/generated_insatnces_30_size_250', model_path='../atsp_model_train_result/Oct15_14-45-35_HetroGATConcat_trained_ATSP50/trial_0', time_limit=0.16, perturbation_moves=5, device='cuda')
device = cuda
model: HetroGATConcat trained in ATSP50 for 100 and tested in ATSP250 for 30
  0%|          | 0/30 [00:00<?, ?it/s]  0%|          | 0/30 [00:06<?, ?it/s, Sum_GNN_time:=4.0038, Sum_Search_time:=0.2372, Avg_Gap_init:=13.3989, Avg_Gap_best:=12.1849, Avg_Cost_init:=1.7531, Avg_Cost_best:=1.7344, Avg_Otpimal_best:=1.5460, Avg_counts: =4.0000]  3%|▎         | 1/30 [00:06<03:11,  6.60s/it, Sum_GNN_time:=4.0038, Sum_Search_time:=0.2372, Avg_Gap_init:=13.3989, Avg_Gap_best:=12.1849, Avg_Cost_init:=1.7531, Avg_Cost_best:=1.7344, Avg_Otpimal_best:=1.5460, Avg_counts: =4.0000]  3%|▎         | 1/30 [00:08<03:11,  6.60s/it, Sum_GNN_time:=4.5080, Sum_Search_time:=0.4955, Avg_Gap_init:=12.0556, Avg_Gap_best:=11.1438, Avg_Cost_init:=1.7174, Avg_Cost_best:=1.7034, Avg_Otpimal_best:=1.5325, Avg_counts: =4.0000]  7%|▋         | 2/30 [00:08<01:49,  3.90s/it, Sum_GNN_time:=4.5080, Sum_Search_time:=0.4955, Avg_Gap_init:=12.0556, Avg_Gap_best:=11.1438, Avg_Cost_init:=1.7174, Avg_Cost_best:=1.7034, Avg_Otpimal_best:=1.5325, Avg_counts: =4.0000]  7%|▋         | 2/30 [00:10<01:49,  3.90s/it, Sum_GNN_time:=5.0373, Sum_Search_time:=0.7511, Avg_Gap_init:=12.0407, Avg_Gap_best:=11.0226, Avg_Cost_init:=1.7741, Avg_Cost_best:=1.7578, Avg_Otpimal_best:=1.5833, Avg_counts: =4.0000] 10%|█         | 3/30 [00:10<01:22,  3.06s/it, Sum_GNN_time:=5.0373, Sum_Search_time:=0.7511, Avg_Gap_init:=12.0407, Avg_Gap_best:=11.0226, Avg_Cost_init:=1.7741, Avg_Cost_best:=1.7578, Avg_Otpimal_best:=1.5833, Avg_counts: =4.0000] 10%|█         | 3/30 [00:12<01:22,  3.06s/it, Sum_GNN_time:=5.5657, Sum_Search_time:=1.0086, Avg_Gap_init:=12.2761, Avg_Gap_best:=11.2316, Avg_Cost_init:=1.7888, Avg_Cost_best:=1.7721, Avg_Otpimal_best:=1.5931, Avg_counts: =4.0000] 13%|█▎        | 4/30 [00:12<01:09,  2.66s/it, Sum_GNN_time:=5.5657, Sum_Search_time:=1.0086, Avg_Gap_init:=12.2761, Avg_Gap_best:=11.2316, Avg_Cost_init:=1.7888, Avg_Cost_best:=1.7721, Avg_Otpimal_best:=1.5931, Avg_counts: =4.0000] 13%|█▎        | 4/30 [00:14<01:09,  2.66s/it, Sum_GNN_time:=6.0759, Sum_Search_time:=1.2660, Avg_Gap_init:=13.1449, Avg_Gap_best:=12.1598, Avg_Cost_init:=1.7930, Avg_Cost_best:=1.7772, Avg_Otpimal_best:=1.5848, Avg_counts: =4.0000] 17%|█▋        | 5/30 [00:14<01:01,  2.46s/it, Sum_GNN_time:=6.0759, Sum_Search_time:=1.2660, Avg_Gap_init:=13.1449, Avg_Gap_best:=12.1598, Avg_Cost_init:=1.7930, Avg_Cost_best:=1.7772, Avg_Otpimal_best:=1.5848, Avg_counts: =4.0000] 17%|█▋        | 5/30 [00:16<01:01,  2.46s/it, Sum_GNN_time:=6.5854, Sum_Search_time:=1.5250, Avg_Gap_init:=13.3826, Avg_Gap_best:=12.4565, Avg_Cost_init:=1.7870, Avg_Cost_best:=1.7723, Avg_Otpimal_best:=1.5763, Avg_counts: =4.0000] 20%|██        | 6/30 [00:16<00:54,  2.28s/it, Sum_GNN_time:=6.5854, Sum_Search_time:=1.5250, Avg_Gap_init:=13.3826, Avg_Gap_best:=12.4565, Avg_Cost_init:=1.7870, Avg_Cost_best:=1.7723, Avg_Otpimal_best:=1.5763, Avg_counts: =4.0000] 20%|██        | 6/30 [00:18<00:54,  2.28s/it, Sum_GNN_time:=7.0931, Sum_Search_time:=1.7802, Avg_Gap_init:=13.5334, Avg_Gap_best:=12.6569, Avg_Cost_init:=1.8004, Avg_Cost_best:=1.7864, Avg_Otpimal_best:=1.5859, Avg_counts: =4.0000] 23%|██▎       | 7/30 [00:18<00:50,  2.21s/it, Sum_GNN_time:=7.0931, Sum_Search_time:=1.7802, Avg_Gap_init:=13.5334, Avg_Gap_best:=12.6569, Avg_Cost_init:=1.8004, Avg_Cost_best:=1.7864, Avg_Otpimal_best:=1.5859, Avg_counts: =4.0000] 23%|██▎       | 7/30 [00:20<00:50,  2.21s/it, Sum_GNN_time:=7.6012, Sum_Search_time:=2.0381, Avg_Gap_init:=13.7029, Avg_Gap_best:=12.5875, Avg_Cost_init:=1.8013, Avg_Cost_best:=1.7836, Avg_Otpimal_best:=1.5843, Avg_counts: =4.0000] 27%|██▋       | 8/30 [00:20<00:47,  2.16s/it, Sum_GNN_time:=7.6012, Sum_Search_time:=2.0381, Avg_Gap_init:=13.7029, Avg_Gap_best:=12.5875, Avg_Cost_init:=1.8013, Avg_Cost_best:=1.7836, Avg_Otpimal_best:=1.5843, Avg_counts: =4.0000] 27%|██▋       | 8/30 [00:22<00:47,  2.16s/it, Sum_GNN_time:=8.1227, Sum_Search_time:=2.2976, Avg_Gap_init:=13.0826, Avg_Gap_best:=11.9702, Avg_Cost_init:=1.7783, Avg_Cost_best:=1.7608, Avg_Otpimal_best:=1.5721, Avg_counts: =4.0000] 30%|███       | 9/30 [00:22<00:44,  2.13s/it, Sum_GNN_time:=8.1227, Sum_Search_time:=2.2976, Avg_Gap_init:=13.0826, Avg_Gap_best:=11.9702, Avg_Cost_init:=1.7783, Avg_Cost_best:=1.7608, Avg_Otpimal_best:=1.5721, Avg_counts: =4.0000] 30%|███       | 9/30 [00:25<00:44,  2.13s/it, Sum_GNN_time:=8.6372, Sum_Search_time:=2.5541, Avg_Gap_init:=13.1946, Avg_Gap_best:=12.0848, Avg_Cost_init:=1.7842, Avg_Cost_best:=1.7666, Avg_Otpimal_best:=1.5758, Avg_counts: =4.0000] 33%|███▎      | 10/30 [00:25<00:42,  2.11s/it, Sum_GNN_time:=8.6372, Sum_Search_time:=2.5541, Avg_Gap_init:=13.1946, Avg_Gap_best:=12.0848, Avg_Cost_init:=1.7842, Avg_Cost_best:=1.7666, Avg_Otpimal_best:=1.5758, Avg_counts: =4.0000] 33%|███▎      | 10/30 [00:27<00:42,  2.11s/it, Sum_GNN_time:=9.1396, Sum_Search_time:=2.8126, Avg_Gap_init:=13.3156, Avg_Gap_best:=12.2336, Avg_Cost_init:=1.7963, Avg_Cost_best:=1.7791, Avg_Otpimal_best:=1.5847, Avg_counts: =4.0000] 37%|███▋      | 11/30 [00:27<00:39,  2.10s/it, Sum_GNN_time:=9.1396, Sum_Search_time:=2.8126, Avg_Gap_init:=13.3156, Avg_Gap_best:=12.2336, Avg_Cost_init:=1.7963, Avg_Cost_best:=1.7791, Avg_Otpimal_best:=1.5847, Avg_counts: =4.0000] 37%|███▋      | 11/30 [00:29<00:39,  2.10s/it, Sum_GNN_time:=9.6496, Sum_Search_time:=3.0711, Avg_Gap_init:=13.3366, Avg_Gap_best:=12.2225, Avg_Cost_init:=1.7888, Avg_Cost_best:=1.7712, Avg_Otpimal_best:=1.5779, Avg_counts: =4.0000] 40%|████      | 12/30 [00:29<00:37,  2.09s/it, Sum_GNN_time:=9.6496, Sum_Search_time:=3.0711, Avg_Gap_init:=13.3366, Avg_Gap_best:=12.2225, Avg_Cost_init:=1.7888, Avg_Cost_best:=1.7712, Avg_Otpimal_best:=1.5779, Avg_counts: =4.0000] 40%|████      | 12/30 [00:31<00:37,  2.09s/it, Sum_GNN_time:=10.1527, Sum_Search_time:=3.3321, Avg_Gap_init:=13.0356, Avg_Gap_best:=11.9112, Avg_Cost_init:=1.7881, Avg_Cost_best:=1.7703, Avg_Otpimal_best:=1.5816, Avg_counts: =4.0000] 43%|████▎     | 13/30 [00:31<00:35,  2.06s/it, Sum_GNN_time:=10.1527, Sum_Search_time:=3.3321, Avg_Gap_init:=13.0356, Avg_Gap_best:=11.9112, Avg_Cost_init:=1.7881, Avg_Cost_best:=1.7703, Avg_Otpimal_best:=1.5816, Avg_counts: =4.0000] 43%|████▎     | 13/30 [00:33<00:35,  2.06s/it, Sum_GNN_time:=10.6747, Sum_Search_time:=3.5922, Avg_Gap_init:=13.0909, Avg_Gap_best:=12.0199, Avg_Cost_init:=1.7991, Avg_Cost_best:=1.7821, Avg_Otpimal_best:=1.5905, Avg_counts: =4.0000] 47%|████▋     | 14/30 [00:33<00:33,  2.07s/it, Sum_GNN_time:=10.6747, Sum_Search_time:=3.5922, Avg_Gap_init:=13.0909, Avg_Gap_best:=12.0199, Avg_Cost_init:=1.7991, Avg_Cost_best:=1.7821, Avg_Otpimal_best:=1.5905, Avg_counts: =4.0000] 47%|████▋     | 14/30 [00:35<00:33,  2.07s/it, Sum_GNN_time:=11.1751, Sum_Search_time:=3.8495, Avg_Gap_init:=13.0367, Avg_Gap_best:=11.9999, Avg_Cost_init:=1.7811, Avg_Cost_best:=1.7648, Avg_Otpimal_best:=1.5753, Avg_counts: =4.0000] 50%|█████     | 15/30 [00:35<00:31,  2.08s/it, Sum_GNN_time:=11.1751, Sum_Search_time:=3.8495, Avg_Gap_init:=13.0367, Avg_Gap_best:=11.9999, Avg_Cost_init:=1.7811, Avg_Cost_best:=1.7648, Avg_Otpimal_best:=1.5753, Avg_counts: =4.0000] 50%|█████     | 15/30 [00:37<00:31,  2.08s/it, Sum_GNN_time:=11.6954, Sum_Search_time:=4.1085, Avg_Gap_init:=12.9653, Avg_Gap_best:=11.9694, Avg_Cost_init:=1.7666, Avg_Cost_best:=1.7509, Avg_Otpimal_best:=1.5633, Avg_counts: =4.0000] 53%|█████▎    | 16/30 [00:37<00:29,  2.09s/it, Sum_GNN_time:=11.6954, Sum_Search_time:=4.1085, Avg_Gap_init:=12.9653, Avg_Gap_best:=11.9694, Avg_Cost_init:=1.7666, Avg_Cost_best:=1.7509, Avg_Otpimal_best:=1.5633, Avg_counts: =4.0000] 53%|█████▎    | 16/30 [00:39<00:29,  2.09s/it, Sum_GNN_time:=12.1959, Sum_Search_time:=4.3673, Avg_Gap_init:=13.0361, Avg_Gap_best:=12.0609, Avg_Cost_init:=1.7733, Avg_Cost_best:=1.7580, Avg_Otpimal_best:=1.5683, Avg_counts: =4.0000] 57%|█████▋    | 17/30 [00:39<00:27,  2.08s/it, Sum_GNN_time:=12.1959, Sum_Search_time:=4.3673, Avg_Gap_init:=13.0361, Avg_Gap_best:=12.0609, Avg_Cost_init:=1.7733, Avg_Cost_best:=1.7580, Avg_Otpimal_best:=1.5683, Avg_counts: =4.0000] 57%|█████▋    | 17/30 [00:41<00:27,  2.08s/it, Sum_GNN_time:=12.6994, Sum_Search_time:=4.6248, Avg_Gap_init:=12.8885, Avg_Gap_best:=11.9420, Avg_Cost_init:=1.7706, Avg_Cost_best:=1.7557, Avg_Otpimal_best:=1.5680, Avg_counts: =4.0000] 60%|██████    | 18/30 [00:41<00:24,  2.08s/it, Sum_GNN_time:=12.6994, Sum_Search_time:=4.6248, Avg_Gap_init:=12.8885, Avg_Gap_best:=11.9420, Avg_Cost_init:=1.7706, Avg_Cost_best:=1.7557, Avg_Otpimal_best:=1.5680, Avg_counts: =4.0000] 60%|██████    | 18/30 [00:43<00:24,  2.08s/it, Sum_GNN_time:=13.1966, Sum_Search_time:=4.8851, Avg_Gap_init:=12.8946, Avg_Gap_best:=11.9441, Avg_Cost_init:=1.7747, Avg_Cost_best:=1.7597, Avg_Otpimal_best:=1.5715, Avg_counts: =4.0000] 63%|██████▎   | 19/30 [00:43<00:22,  2.04s/it, Sum_GNN_time:=13.1966, Sum_Search_time:=4.8851, Avg_Gap_init:=12.8946, Avg_Gap_best:=11.9441, Avg_Cost_init:=1.7747, Avg_Cost_best:=1.7597, Avg_Otpimal_best:=1.5715, Avg_counts: =4.0000] 63%|██████▎   | 19/30 [00:45<00:22,  2.04s/it, Sum_GNN_time:=13.7048, Sum_Search_time:=5.1436, Avg_Gap_init:=12.7620, Avg_Gap_best:=11.8122, Avg_Cost_init:=1.7700, Avg_Cost_best:=1.7551, Avg_Otpimal_best:=1.5692, Avg_counts: =4.0000] 67%|██████▋   | 20/30 [00:45<00:20,  2.06s/it, Sum_GNN_time:=13.7048, Sum_Search_time:=5.1436, Avg_Gap_init:=12.7620, Avg_Gap_best:=11.8122, Avg_Cost_init:=1.7700, Avg_Cost_best:=1.7551, Avg_Otpimal_best:=1.5692, Avg_counts: =4.0000] 67%|██████▋   | 20/30 [00:47<00:20,  2.06s/it, Sum_GNN_time:=14.2317, Sum_Search_time:=5.4030, Avg_Gap_init:=12.7119, Avg_Gap_best:=11.7737, Avg_Cost_init:=1.7658, Avg_Cost_best:=1.7511, Avg_Otpimal_best:=1.5662, Avg_counts: =4.0000] 70%|███████   | 21/30 [00:47<00:18,  2.06s/it, Sum_GNN_time:=14.2317, Sum_Search_time:=5.4030, Avg_Gap_init:=12.7119, Avg_Gap_best:=11.7737, Avg_Cost_init:=1.7658, Avg_Cost_best:=1.7511, Avg_Otpimal_best:=1.5662, Avg_counts: =4.0000] 70%|███████   | 21/30 [00:49<00:18,  2.06s/it, Sum_GNN_time:=14.7345, Sum_Search_time:=5.6593, Avg_Gap_init:=12.7897, Avg_Gap_best:=11.8352, Avg_Cost_init:=1.7713, Avg_Cost_best:=1.7562, Avg_Otpimal_best:=1.5699, Avg_counts: =4.0000] 73%|███████▎  | 22/30 [00:49<00:16,  2.07s/it, Sum_GNN_time:=14.7345, Sum_Search_time:=5.6593, Avg_Gap_init:=12.7897, Avg_Gap_best:=11.8352, Avg_Cost_init:=1.7713, Avg_Cost_best:=1.7562, Avg_Otpimal_best:=1.5699, Avg_counts: =4.0000] 73%|███████▎  | 22/30 [00:51<00:16,  2.07s/it, Sum_GNN_time:=15.2589, Sum_Search_time:=5.9171, Avg_Gap_init:=12.8267, Avg_Gap_best:=11.8632, Avg_Cost_init:=1.7714, Avg_Cost_best:=1.7562, Avg_Otpimal_best:=1.5695, Avg_counts: =4.0000] 77%|███████▋  | 23/30 [00:51<00:14,  2.08s/it, Sum_GNN_time:=15.2589, Sum_Search_time:=5.9171, Avg_Gap_init:=12.8267, Avg_Gap_best:=11.8632, Avg_Cost_init:=1.7714, Avg_Cost_best:=1.7562, Avg_Otpimal_best:=1.5695, Avg_counts: =4.0000] 77%|███████▋  | 23/30 [00:53<00:14,  2.08s/it, Sum_GNN_time:=15.7641, Sum_Search_time:=6.1834, Avg_Gap_init:=12.8676, Avg_Gap_best:=11.9000, Avg_Cost_init:=1.7688, Avg_Cost_best:=1.7536, Avg_Otpimal_best:=1.5667, Avg_counts: =4.0000] 80%|████████  | 24/30 [00:53<00:12,  2.04s/it, Sum_GNN_time:=15.7641, Sum_Search_time:=6.1834, Avg_Gap_init:=12.8676, Avg_Gap_best:=11.9000, Avg_Cost_init:=1.7688, Avg_Cost_best:=1.7536, Avg_Otpimal_best:=1.5667, Avg_counts: =4.0000] 80%|████████  | 24/30 [00:55<00:12,  2.04s/it, Sum_GNN_time:=16.2856, Sum_Search_time:=6.4431, Avg_Gap_init:=12.9678, Avg_Gap_best:=11.9697, Avg_Cost_init:=1.7708, Avg_Cost_best:=1.7551, Avg_Otpimal_best:=1.5671, Avg_counts: =4.0000] 83%|████████▎ | 25/30 [00:55<00:10,  2.07s/it, Sum_GNN_time:=16.2856, Sum_Search_time:=6.4431, Avg_Gap_init:=12.9678, Avg_Gap_best:=11.9697, Avg_Cost_init:=1.7708, Avg_Cost_best:=1.7551, Avg_Otpimal_best:=1.5671, Avg_counts: =4.0000] 83%|████████▎ | 25/30 [00:58<00:10,  2.07s/it, Sum_GNN_time:=16.7935, Sum_Search_time:=6.7023, Avg_Gap_init:=13.0502, Avg_Gap_best:=12.0395, Avg_Cost_init:=1.7719, Avg_Cost_best:=1.7560, Avg_Otpimal_best:=1.5669, Avg_counts: =4.0000] 87%|████████▋ | 26/30 [00:58<00:08,  2.07s/it, Sum_GNN_time:=16.7935, Sum_Search_time:=6.7023, Avg_Gap_init:=13.0502, Avg_Gap_best:=12.0395, Avg_Cost_init:=1.7719, Avg_Cost_best:=1.7560, Avg_Otpimal_best:=1.5669, Avg_counts: =4.0000] 87%|████████▋ | 26/30 [01:00<00:08,  2.07s/it, Sum_GNN_time:=17.3089, Sum_Search_time:=6.9612, Avg_Gap_init:=13.1111, Avg_Gap_best:=12.0999, Avg_Cost_init:=1.7717, Avg_Cost_best:=1.7559, Avg_Otpimal_best:=1.5660, Avg_counts: =4.0000] 90%|█████████ | 27/30 [01:00<00:06,  2.07s/it, Sum_GNN_time:=17.3089, Sum_Search_time:=6.9612, Avg_Gap_init:=13.1111, Avg_Gap_best:=12.0999, Avg_Cost_init:=1.7717, Avg_Cost_best:=1.7559, Avg_Otpimal_best:=1.5660, Avg_counts: =4.0000] 90%|█████████ | 27/30 [01:02<00:06,  2.07s/it, Sum_GNN_time:=17.8353, Sum_Search_time:=7.2206, Avg_Gap_init:=13.1716, Avg_Gap_best:=12.1778, Avg_Cost_init:=1.7720, Avg_Cost_best:=1.7564, Avg_Otpimal_best:=1.5654, Avg_counts: =4.0000] 93%|█████████▎| 28/30 [01:02<00:04,  2.17s/it, Sum_GNN_time:=17.8353, Sum_Search_time:=7.2206, Avg_Gap_init:=13.1716, Avg_Gap_best:=12.1778, Avg_Cost_init:=1.7720, Avg_Cost_best:=1.7564, Avg_Otpimal_best:=1.5654, Avg_counts: =4.0000] 93%|█████████▎| 28/30 [01:04<00:04,  2.17s/it, Sum_GNN_time:=18.3626, Sum_Search_time:=7.4748, Avg_Gap_init:=13.0039, Avg_Gap_best:=12.0027, Avg_Cost_init:=1.7660, Avg_Cost_best:=1.7503, Avg_Otpimal_best:=1.5623, Avg_counts: =4.0000] 97%|█████████▋| 29/30 [01:04<00:02,  2.14s/it, Sum_GNN_time:=18.3626, Sum_Search_time:=7.4748, Avg_Gap_init:=13.0039, Avg_Gap_best:=12.0027, Avg_Cost_init:=1.7660, Avg_Cost_best:=1.7503, Avg_Otpimal_best:=1.5623, Avg_counts: =4.0000] 97%|█████████▋| 29/30 [01:06<00:02,  2.14s/it, Sum_GNN_time:=18.8717, Sum_Search_time:=7.7232, Avg_Gap_init:=13.0372, Avg_Gap_best:=12.0051, Avg_Cost_init:=1.7663, Avg_Cost_best:=1.7502, Avg_Otpimal_best:=1.5621, Avg_counts: =4.0000]100%|██████████| 30/30 [01:06<00:00,  2.12s/it, Sum_GNN_time:=18.8717, Sum_Search_time:=7.7232, Avg_Gap_init:=13.0372, Avg_Gap_best:=12.0051, Avg_Cost_init:=1.7663, Avg_Cost_best:=1.7502, Avg_Otpimal_best:=1.5621, Avg_counts: =4.0000]100%|██████████| 30/30 [01:06<00:00,  2.22s/it, Sum_GNN_time:=18.8717, Sum_Search_time:=7.7232, Avg_Gap_init:=13.0372, Avg_Gap_best:=12.0051, Avg_Cost_init:=1.7663, Avg_Cost_best:=1.7502, Avg_Otpimal_best:=1.5621, Avg_counts: =4.0000]
Total time for model prediction: 18.8717 seconds
Total time for guided local search: 7.7232 seconds
