/project/c_gnn_001/conda_envs/cuda121/lib/python3.11/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator MinMaxScaler from version 1.3.0 when using version 1.5.2. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(
Namespace(data_dir='../tsp_input/generated_insatnces_3000_size_50/', tb_dir='../atsp_model_train_result', atsp_size=50, to_homo=True, half_st=False, model='EdgePropertyPredictionModel1', input_dim=1, hidden_dim=128, output_dim=1, relation_types='ss tt pp', n_gnn_layers=4, n_heads=64, jk='cat', lr_init=0.001, lr_decay=0.95, min_delta=0.0001, patience=200, batch_size=15, n_epochs=100, checkpoint_freq=10, seed=4, n_trials=1, n_samples_result_train=30, device='cuda')
Namespace(atsp_size=100, data_path='../tsp_input/generated_insatnces_30_size_100', model_path='../atsp_model_train_result/Oct24_01-14-09_EdgePropertyPredictionModel1_trained_ATSP50/trial_0', time_limit=0.16, perturbation_moves=5, device='cuda', half_st=False, relation_types='ss tt pp st')
model: EdgePropertyPredictionModel1 trained in ATSP100 for 100 and tested in ATSP100 for 30
device = cuda
  0%|          | 0/30 [00:00<?, ?it/s]  0%|          | 0/30 [00:02<?, ?it/s]
Traceback (most recent call last):
  File "/project/c_gnn_001/code/tsp/atsp_gnn/test.py", line 193, in <module>
    main(args_test)
  File "/project/c_gnn_001/code/tsp/atsp_gnn/test.py", line 98, in main
    features_transformed = to_square_with_inf_diagonal(H.ndata['weight'])
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/project/c_gnn_001/code/tsp/atsp_gnn/test.py", line 46, in to_square_with_inf_diagonal
    matrix[mask] = reshaped_tensor.flatten()
    ~~~~~~^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
