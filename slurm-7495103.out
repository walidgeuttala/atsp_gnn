Namespace(data_dir='../tsp_input/generated_insatnces_3000_size_50/', tb_dir='../atsp_model_train_result', atsp_size=50, to_homo=False, half_st=True, model='HetroGATConcat', input_dim=1, hidden_dim=128, output_dim=1, relation_types='ss st tt pp', n_gnn_layers=4, n_heads=64, jk='cat', lr_init=0.001, lr_decay=0.95, min_delta=0.0001, patience=200, batch_size=15, n_epochs=100, checkpoint_freq=10, seed=4, n_trials=1, n_samples_result_train=30, device='cuda')
Namespace(atsp_size=100, data_path='../tsp_input/generated_insatnces_30_size_100', model_path='../atsp_model_train_result/Oct15_17-24-54_HetroGATConcat_trained_ATSP50/trial_0', time_limit=0.16, perturbation_moves=5, device='cuda')
device = cuda
model: HetroGATConcat trained in ATSP50 for 100 and tested in ATSP100 for 30
  0%|          | 0/30 [00:00<?, ?it/s]  0%|          | 0/30 [00:01<?, ?it/s, Sum_GNN_time:=0.7407, Sum_Search_time:=0.1610, Avg_Gap_init:=10.5934, Avg_Gap_best:=10.1508, Avg_Cost_init:=1.7708, Avg_Cost_best:=1.7638, Avg_Otpimal_best:=1.6012, Avg_counts: =18.0000]  3%|▎         | 1/30 [00:01<00:36,  1.25s/it, Sum_GNN_time:=0.7407, Sum_Search_time:=0.1610, Avg_Gap_init:=10.5934, Avg_Gap_best:=10.1508, Avg_Cost_init:=1.7708, Avg_Cost_best:=1.7638, Avg_Otpimal_best:=1.6012, Avg_counts: =18.0000]  3%|▎         | 1/30 [00:01<00:36,  1.25s/it, Sum_GNN_time:=0.7960, Sum_Search_time:=0.3410, Avg_Gap_init:=13.8056, Avg_Gap_best:=9.2557, Avg_Cost_init:=1.8628, Avg_Cost_best:=1.7869, Avg_Otpimal_best:=1.6358, Avg_counts: =18.0000]   7%|▋         | 2/30 [00:01<00:22,  1.25it/s, Sum_GNN_time:=0.7960, Sum_Search_time:=0.3410, Avg_Gap_init:=13.8056, Avg_Gap_best:=9.2557, Avg_Cost_init:=1.8628, Avg_Cost_best:=1.7869, Avg_Otpimal_best:=1.6358, Avg_counts: =18.0000]  7%|▋         | 2/30 [00:02<00:22,  1.25it/s, Sum_GNN_time:=0.8518, Sum_Search_time:=0.5172, Avg_Gap_init:=12.5406, Avg_Gap_best:=9.3276, Avg_Cost_init:=1.7675, Avg_Cost_best:=1.7143, Avg_Otpimal_best:=1.5684, Avg_counts: =17.3333] 10%|█         | 3/30 [00:02<00:16,  1.62it/s, Sum_GNN_time:=0.8518, Sum_Search_time:=0.5172, Avg_Gap_init:=12.5406, Avg_Gap_best:=9.3276, Avg_Cost_init:=1.7675, Avg_Cost_best:=1.7143, Avg_Otpimal_best:=1.5684, Avg_counts: =17.3333] 10%|█         | 3/30 [00:02<00:16,  1.62it/s, Sum_GNN_time:=0.9039, Sum_Search_time:=0.6775, Avg_Gap_init:=11.6564, Avg_Gap_best:=8.8097, Avg_Cost_init:=1.7286, Avg_Cost_best:=1.6823, Avg_Otpimal_best:=1.5460, Avg_counts: =17.0000] 13%|█▎        | 4/30 [00:02<00:13,  1.91it/s, Sum_GNN_time:=0.9039, Sum_Search_time:=0.6775, Avg_Gap_init:=11.6564, Avg_Gap_best:=8.8097, Avg_Cost_init:=1.7286, Avg_Cost_best:=1.6823, Avg_Otpimal_best:=1.5460, Avg_counts: =17.0000] 13%|█▎        | 4/30 [00:02<00:13,  1.91it/s, Sum_GNN_time:=0.9565, Sum_Search_time:=0.8400, Avg_Gap_init:=10.7917, Avg_Gap_best:=7.9704, Avg_Cost_init:=1.6967, Avg_Cost_best:=1.6517, Avg_Otpimal_best:=1.5292, Avg_counts: =17.2000] 17%|█▋        | 5/30 [00:02<00:12,  2.00it/s, Sum_GNN_time:=0.9565, Sum_Search_time:=0.8400, Avg_Gap_init:=10.7917, Avg_Gap_best:=7.9704, Avg_Cost_init:=1.6967, Avg_Cost_best:=1.6517, Avg_Otpimal_best:=1.5292, Avg_counts: =17.2000] 17%|█▋        | 5/30 [00:03<00:12,  2.00it/s, Sum_GNN_time:=1.0084, Sum_Search_time:=1.0011, Avg_Gap_init:=11.3344, Avg_Gap_best:=8.0148, Avg_Cost_init:=1.7244, Avg_Cost_best:=1.6711, Avg_Otpimal_best:=1.5465, Avg_counts: =16.8333] 20%|██        | 6/30 [00:03<00:10,  2.18it/s, Sum_GNN_time:=1.0084, Sum_Search_time:=1.0011, Avg_Gap_init:=11.3344, Avg_Gap_best:=8.0148, Avg_Cost_init:=1.7244, Avg_Cost_best:=1.6711, Avg_Otpimal_best:=1.5465, Avg_counts: =16.8333] 20%|██        | 6/30 [00:03<00:10,  2.18it/s, Sum_GNN_time:=1.0601, Sum_Search_time:=1.1783, Avg_Gap_init:=10.8823, Avg_Gap_best:=7.6654, Avg_Cost_init:=1.7451, Avg_Cost_best:=1.6930, Avg_Otpimal_best:=1.5725, Avg_counts: =17.5714] 23%|██▎       | 7/30 [00:03<00:10,  2.29it/s, Sum_GNN_time:=1.0601, Sum_Search_time:=1.1783, Avg_Gap_init:=10.8823, Avg_Gap_best:=7.6654, Avg_Cost_init:=1.7451, Avg_Cost_best:=1.6930, Avg_Otpimal_best:=1.5725, Avg_counts: =17.5714] 23%|██▎       | 7/30 [00:04<00:10,  2.29it/s, Sum_GNN_time:=1.1119, Sum_Search_time:=1.3563, Avg_Gap_init:=11.3643, Avg_Gap_best:=7.9732, Avg_Cost_init:=1.7962, Avg_Cost_best:=1.7397, Avg_Otpimal_best:=1.6105, Avg_counts: =18.1250] 27%|██▋       | 8/30 [00:04<00:09,  2.36it/s, Sum_GNN_time:=1.1119, Sum_Search_time:=1.3563, Avg_Gap_init:=11.3643, Avg_Gap_best:=7.9732, Avg_Cost_init:=1.7962, Avg_Cost_best:=1.7397, Avg_Otpimal_best:=1.6105, Avg_counts: =18.1250] 27%|██▋       | 8/30 [00:04<00:09,  2.36it/s, Sum_GNN_time:=1.1643, Sum_Search_time:=1.5199, Avg_Gap_init:=11.8110, Avg_Gap_best:=8.5352, Avg_Cost_init:=1.7958, Avg_Cost_best:=1.7416, Avg_Otpimal_best:=1.6043, Avg_counts: =18.1111] 30%|███       | 9/30 [00:04<00:08,  2.43it/s, Sum_GNN_time:=1.1643, Sum_Search_time:=1.5199, Avg_Gap_init:=11.8110, Avg_Gap_best:=8.5352, Avg_Cost_init:=1.7958, Avg_Cost_best:=1.7416, Avg_Otpimal_best:=1.6043, Avg_counts: =18.1111] 30%|███       | 9/30 [00:04<00:08,  2.43it/s, Sum_GNN_time:=1.2170, Sum_Search_time:=1.6821, Avg_Gap_init:=11.3918, Avg_Gap_best:=8.3979, Avg_Cost_init:=1.7996, Avg_Cost_best:=1.7501, Avg_Otpimal_best:=1.6142, Avg_counts: =17.9000] 33%|███▎      | 10/30 [00:04<00:08,  2.33it/s, Sum_GNN_time:=1.2170, Sum_Search_time:=1.6821, Avg_Gap_init:=11.3918, Avg_Gap_best:=8.3979, Avg_Cost_init:=1.7996, Avg_Cost_best:=1.7501, Avg_Otpimal_best:=1.6142, Avg_counts: =17.9000] 33%|███▎      | 10/30 [00:05<00:08,  2.33it/s, Sum_GNN_time:=1.2691, Sum_Search_time:=1.8686, Avg_Gap_init:=11.6174, Avg_Gap_best:=8.8927, Avg_Cost_init:=1.8183, Avg_Cost_best:=1.7732, Avg_Otpimal_best:=1.6276, Avg_counts: =18.0909] 37%|███▋      | 11/30 [00:05<00:08,  2.37it/s, Sum_GNN_time:=1.2691, Sum_Search_time:=1.8686, Avg_Gap_init:=11.6174, Avg_Gap_best:=8.8927, Avg_Cost_init:=1.8183, Avg_Cost_best:=1.7732, Avg_Otpimal_best:=1.6276, Avg_counts: =18.0909] 37%|███▋      | 11/30 [00:05<00:08,  2.37it/s, Sum_GNN_time:=1.3209, Sum_Search_time:=2.0293, Avg_Gap_init:=11.0201, Avg_Gap_best:=8.5224, Avg_Cost_init:=1.7867, Avg_Cost_best:=1.7453, Avg_Otpimal_best:=1.6067, Avg_counts: =17.9167] 40%|████      | 12/30 [00:05<00:07,  2.45it/s, Sum_GNN_time:=1.3209, Sum_Search_time:=2.0293, Avg_Gap_init:=11.0201, Avg_Gap_best:=8.5224, Avg_Cost_init:=1.7867, Avg_Cost_best:=1.7453, Avg_Otpimal_best:=1.6067, Avg_counts: =17.9167] 40%|████      | 12/30 [00:06<00:07,  2.45it/s, Sum_GNN_time:=1.3726, Sum_Search_time:=2.2166, Avg_Gap_init:=11.1704, Avg_Gap_best:=8.8306, Avg_Cost_init:=1.7779, Avg_Cost_best:=1.7392, Avg_Otpimal_best:=1.5970, Avg_counts: =17.9231] 43%|████▎     | 13/30 [00:06<00:06,  2.45it/s, Sum_GNN_time:=1.3726, Sum_Search_time:=2.2166, Avg_Gap_init:=11.1704, Avg_Gap_best:=8.8306, Avg_Cost_init:=1.7779, Avg_Cost_best:=1.7392, Avg_Otpimal_best:=1.5970, Avg_counts: =17.9231] 43%|████▎     | 13/30 [00:06<00:06,  2.45it/s, Sum_GNN_time:=1.4252, Sum_Search_time:=2.3772, Avg_Gap_init:=11.4696, Avg_Gap_best:=8.8827, Avg_Cost_init:=1.7836, Avg_Cost_best:=1.7410, Avg_Otpimal_best:=1.5980, Avg_counts: =18.0714] 47%|████▋     | 14/30 [00:06<00:06,  2.33it/s, Sum_GNN_time:=1.4252, Sum_Search_time:=2.3772, Avg_Gap_init:=11.4696, Avg_Gap_best:=8.8827, Avg_Cost_init:=1.7836, Avg_Cost_best:=1.7410, Avg_Otpimal_best:=1.5980, Avg_counts: =18.0714] 47%|████▋     | 14/30 [00:07<00:06,  2.33it/s, Sum_GNN_time:=1.4815, Sum_Search_time:=2.5555, Avg_Gap_init:=11.1636, Avg_Gap_best:=8.7491, Avg_Cost_init:=1.7749, Avg_Cost_best:=1.7351, Avg_Otpimal_best:=1.5945, Avg_counts: =18.0667] 50%|█████     | 15/30 [00:07<00:06,  2.36it/s, Sum_GNN_time:=1.4815, Sum_Search_time:=2.5555, Avg_Gap_init:=11.1636, Avg_Gap_best:=8.7491, Avg_Cost_init:=1.7749, Avg_Cost_best:=1.7351, Avg_Otpimal_best:=1.5945, Avg_counts: =18.0667] 50%|█████     | 15/30 [00:07<00:06,  2.36it/s, Sum_GNN_time:=1.5332, Sum_Search_time:=2.7160, Avg_Gap_init:=11.3005, Avg_Gap_best:=8.7397, Avg_Cost_init:=1.7811, Avg_Cost_best:=1.7389, Avg_Otpimal_best:=1.5982, Avg_counts: =17.8125] 53%|█████▎    | 16/30 [00:07<00:05,  2.44it/s, Sum_GNN_time:=1.5332, Sum_Search_time:=2.7160, Avg_Gap_init:=11.3005, Avg_Gap_best:=8.7397, Avg_Cost_init:=1.7811, Avg_Cost_best:=1.7389, Avg_Otpimal_best:=1.5982, Avg_counts: =17.8125] 53%|█████▎    | 16/30 [00:07<00:05,  2.44it/s, Sum_GNN_time:=1.5859, Sum_Search_time:=2.8763, Avg_Gap_init:=11.5557, Avg_Gap_best:=8.8330, Avg_Cost_init:=1.7879, Avg_Cost_best:=1.7431, Avg_Otpimal_best:=1.6007, Avg_counts: =17.7647] 57%|█████▋    | 17/30 [00:07<00:05,  2.50it/s, Sum_GNN_time:=1.5859, Sum_Search_time:=2.8763, Avg_Gap_init:=11.5557, Avg_Gap_best:=8.8330, Avg_Cost_init:=1.7879, Avg_Cost_best:=1.7431, Avg_Otpimal_best:=1.6007, Avg_counts: =17.7647] 57%|█████▋    | 17/30 [00:08<00:05,  2.50it/s, Sum_GNN_time:=1.6379, Sum_Search_time:=3.0373, Avg_Gap_init:=11.5388, Avg_Gap_best:=8.7300, Avg_Cost_init:=1.7840, Avg_Cost_best:=1.7380, Avg_Otpimal_best:=1.5975, Avg_counts: =17.6667] 60%|██████    | 18/30 [00:08<00:04,  2.53it/s, Sum_GNN_time:=1.6379, Sum_Search_time:=3.0373, Avg_Gap_init:=11.5388, Avg_Gap_best:=8.7300, Avg_Cost_init:=1.7840, Avg_Cost_best:=1.7380, Avg_Otpimal_best:=1.5975, Avg_counts: =17.6667] 60%|██████    | 18/30 [00:08<00:04,  2.53it/s, Sum_GNN_time:=1.6907, Sum_Search_time:=3.1996, Avg_Gap_init:=11.3616, Avg_Gap_best:=8.6828, Avg_Cost_init:=1.7718, Avg_Cost_best:=1.7280, Avg_Otpimal_best:=1.5890, Avg_counts: =17.5789] 63%|██████▎   | 19/30 [00:08<00:04,  2.39it/s, Sum_GNN_time:=1.6907, Sum_Search_time:=3.1996, Avg_Gap_init:=11.3616, Avg_Gap_best:=8.6828, Avg_Cost_init:=1.7718, Avg_Cost_best:=1.7280, Avg_Otpimal_best:=1.5890, Avg_counts: =17.5789] 63%|██████▎   | 19/30 [00:09<00:04,  2.39it/s, Sum_GNN_time:=1.7441, Sum_Search_time:=3.3604, Avg_Gap_init:=11.3079, Avg_Gap_best:=8.6291, Avg_Cost_init:=1.7680, Avg_Cost_best:=1.7243, Avg_Otpimal_best:=1.5864, Avg_counts: =17.5000] 67%|██████▋   | 20/30 [00:09<00:04,  2.45it/s, Sum_GNN_time:=1.7441, Sum_Search_time:=3.3604, Avg_Gap_init:=11.3079, Avg_Gap_best:=8.6291, Avg_Cost_init:=1.7680, Avg_Cost_best:=1.7243, Avg_Otpimal_best:=1.5864, Avg_counts: =17.5000] 67%|██████▋   | 20/30 [00:09<00:04,  2.45it/s, Sum_GNN_time:=1.7962, Sum_Search_time:=3.5356, Avg_Gap_init:=12.0033, Avg_Gap_best:=8.9580, Avg_Cost_init:=1.7621, Avg_Cost_best:=1.7141, Avg_Otpimal_best:=1.5731, Avg_counts: =17.8095] 70%|███████   | 21/30 [00:09<00:03,  2.48it/s, Sum_GNN_time:=1.7962, Sum_Search_time:=3.5356, Avg_Gap_init:=12.0033, Avg_Gap_best:=8.9580, Avg_Cost_init:=1.7621, Avg_Cost_best:=1.7141, Avg_Otpimal_best:=1.5731, Avg_counts: =17.8095] 70%|███████   | 21/30 [00:09<00:03,  2.48it/s, Sum_GNN_time:=1.8480, Sum_Search_time:=3.6966, Avg_Gap_init:=11.9769, Avg_Gap_best:=8.9061, Avg_Cost_init:=1.7695, Avg_Cost_best:=1.7208, Avg_Otpimal_best:=1.5801, Avg_counts: =17.6818] 73%|███████▎  | 22/30 [00:09<00:03,  2.53it/s, Sum_GNN_time:=1.8480, Sum_Search_time:=3.6966, Avg_Gap_init:=11.9769, Avg_Gap_best:=8.9061, Avg_Cost_init:=1.7695, Avg_Cost_best:=1.7208, Avg_Otpimal_best:=1.5801, Avg_counts: =17.6818] 73%|███████▎  | 22/30 [00:10<00:03,  2.53it/s, Sum_GNN_time:=1.9002, Sum_Search_time:=3.8736, Avg_Gap_init:=11.6981, Avg_Gap_best:=8.6912, Avg_Cost_init:=1.7637, Avg_Cost_best:=1.7160, Avg_Otpimal_best:=1.5788, Avg_counts: =17.8696] 77%|███████▋  | 23/30 [00:10<00:02,  2.53it/s, Sum_GNN_time:=1.9002, Sum_Search_time:=3.8736, Avg_Gap_init:=11.6981, Avg_Gap_best:=8.6912, Avg_Cost_init:=1.7637, Avg_Cost_best:=1.7160, Avg_Otpimal_best:=1.5788, Avg_counts: =17.8696] 77%|███████▋  | 23/30 [00:10<00:02,  2.53it/s, Sum_GNN_time:=1.9530, Sum_Search_time:=4.0348, Avg_Gap_init:=11.8028, Avg_Gap_best:=8.8553, Avg_Cost_init:=1.7627, Avg_Cost_best:=1.7160, Avg_Otpimal_best:=1.5765, Avg_counts: =17.8750] 80%|████████  | 24/30 [00:10<00:02,  2.39it/s, Sum_GNN_time:=1.9530, Sum_Search_time:=4.0348, Avg_Gap_init:=11.8028, Avg_Gap_best:=8.8553, Avg_Cost_init:=1.7627, Avg_Cost_best:=1.7160, Avg_Otpimal_best:=1.5765, Avg_counts: =17.8750] 80%|████████  | 24/30 [00:11<00:02,  2.39it/s, Sum_GNN_time:=2.0066, Sum_Search_time:=4.2094, Avg_Gap_init:=11.9485, Avg_Gap_best:=8.7230, Avg_Cost_init:=1.7583, Avg_Cost_best:=1.7078, Avg_Otpimal_best:=1.5706, Avg_counts: =18.1200] 83%|████████▎ | 25/30 [00:11<00:02,  2.43it/s, Sum_GNN_time:=2.0066, Sum_Search_time:=4.2094, Avg_Gap_init:=11.9485, Avg_Gap_best:=8.7230, Avg_Cost_init:=1.7583, Avg_Cost_best:=1.7078, Avg_Otpimal_best:=1.5706, Avg_counts: =18.1200] 83%|████████▎ | 25/30 [00:11<00:02,  2.43it/s, Sum_GNN_time:=2.0585, Sum_Search_time:=4.3723, Avg_Gap_init:=11.9070, Avg_Gap_best:=8.6875, Avg_Cost_init:=1.7532, Avg_Cost_best:=1.7029, Avg_Otpimal_best:=1.5667, Avg_counts: =18.1154] 87%|████████▋ | 26/30 [00:11<00:01,  2.47it/s, Sum_GNN_time:=2.0585, Sum_Search_time:=4.3723, Avg_Gap_init:=11.9070, Avg_Gap_best:=8.6875, Avg_Cost_init:=1.7532, Avg_Cost_best:=1.7029, Avg_Otpimal_best:=1.5667, Avg_counts: =18.1154] 87%|████████▋ | 26/30 [00:11<00:01,  2.47it/s, Sum_GNN_time:=2.1147, Sum_Search_time:=4.5533, Avg_Gap_init:=11.9036, Avg_Gap_best:=8.5977, Avg_Cost_init:=1.7480, Avg_Cost_best:=1.6967, Avg_Otpimal_best:=1.5621, Avg_counts: =18.1111] 90%|█████████ | 27/30 [00:11<00:01,  2.44it/s, Sum_GNN_time:=2.1147, Sum_Search_time:=4.5533, Avg_Gap_init:=11.9036, Avg_Gap_best:=8.5977, Avg_Cost_init:=1.7480, Avg_Cost_best:=1.6967, Avg_Otpimal_best:=1.5621, Avg_counts: =18.1111] 90%|█████████ | 27/30 [00:12<00:01,  2.44it/s, Sum_GNN_time:=2.1707, Sum_Search_time:=4.7285, Avg_Gap_init:=11.8396, Avg_Gap_best:=8.6517, Avg_Cost_init:=1.7454, Avg_Cost_best:=1.6958, Avg_Otpimal_best:=1.5606, Avg_counts: =18.1071] 93%|█████████▎| 28/30 [00:12<00:00,  2.46it/s, Sum_GNN_time:=2.1707, Sum_Search_time:=4.7285, Avg_Gap_init:=11.8396, Avg_Gap_best:=8.6517, Avg_Cost_init:=1.7454, Avg_Cost_best:=1.6958, Avg_Otpimal_best:=1.5606, Avg_counts: =18.1071] 93%|█████████▎| 28/30 [00:12<00:00,  2.46it/s, Sum_GNN_time:=2.2274, Sum_Search_time:=4.8995, Avg_Gap_init:=11.9856, Avg_Gap_best:=8.6482, Avg_Cost_init:=1.7510, Avg_Cost_best:=1.6989, Avg_Otpimal_best:=1.5635, Avg_counts: =18.0345] 97%|█████████▋| 29/30 [00:12<00:00,  2.31it/s, Sum_GNN_time:=2.2274, Sum_Search_time:=4.8995, Avg_Gap_init:=11.9856, Avg_Gap_best:=8.6482, Avg_Cost_init:=1.7510, Avg_Cost_best:=1.6989, Avg_Otpimal_best:=1.5635, Avg_counts: =18.0345] 97%|█████████▋| 29/30 [00:13<00:00,  2.31it/s, Sum_GNN_time:=2.2804, Sum_Search_time:=5.0724, Avg_Gap_init:=12.0830, Avg_Gap_best:=8.6967, Avg_Cost_init:=1.7501, Avg_Cost_best:=1.6973, Avg_Otpimal_best:=1.5613, Avg_counts: =18.2333]100%|██████████| 30/30 [00:13<00:00,  2.37it/s, Sum_GNN_time:=2.2804, Sum_Search_time:=5.0724, Avg_Gap_init:=12.0830, Avg_Gap_best:=8.6967, Avg_Cost_init:=1.7501, Avg_Cost_best:=1.6973, Avg_Otpimal_best:=1.5613, Avg_counts: =18.2333]100%|██████████| 30/30 [00:13<00:00,  2.27it/s, Sum_GNN_time:=2.2804, Sum_Search_time:=5.0724, Avg_Gap_init:=12.0830, Avg_Gap_best:=8.6967, Avg_Cost_init:=1.7501, Avg_Cost_best:=1.6973, Avg_Otpimal_best:=1.5613, Avg_counts: =18.2333]
Total time for model prediction: 2.2804 seconds
Total time for guided local search: 5.0724 seconds
