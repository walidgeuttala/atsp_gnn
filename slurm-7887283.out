/project/c_gnn_001/conda_envs/cuda121/lib/python3.11/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator MinMaxScaler from version 1.3.0 when using version 1.5.2. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(
Namespace(data_dir='../tsp_input/generated_insatnces_3000_size_50/', tb_dir='../atsp_model_train_result', atsp_size=50, to_homo=False, half_st=False, model='HetroGATSum', input_dim=1, hidden_dim=128, output_dim=1, relation_types='ss tt pp', n_gnn_layers=4, n_heads=64, jk='cat', lr_init=0.001, lr_decay=0.95, min_delta=0.0001, patience=200, batch_size=15, n_epochs=100, checkpoint_freq=10, seed=4, n_trials=1, n_samples_result_train=30, device='cuda')
device = cuda
  0%|          | 0/100 [00:00<?, ?it/s]  0%|          | 0/100 [00:46<?, ?it/s, avg_corr=0.6904, avg_corr_cosin=0.9525, avg_gap=28.2623, avg_init_cost=2062172.3000, avg_opt_cost=1607611.0333, epoch=0.0000, train_loss=0.0163, val_loss=0.0287]  1%|          | 1/100 [00:46<1:16:52, 46.59s/it, avg_corr=0.6904, avg_corr_cosin=0.9525, avg_gap=28.2623, avg_init_cost=2062172.3000, avg_opt_cost=1607611.0333, epoch=0.0000, train_loss=0.0163, val_loss=0.0287]  1%|          | 1/100 [01:13<1:16:52, 46.59s/it, avg_corr=0.7559, avg_corr_cosin=0.9635, avg_gap=22.0684, avg_init_cost=1960452.0333, avg_opt_cost=1607611.0333, epoch=1.0000, train_loss=0.0065, val_loss=0.0159]  2%|▏         | 2/100 [01:13<57:20, 35.11s/it, avg_corr=0.7559, avg_corr_cosin=0.9635, avg_gap=22.0684, avg_init_cost=1960452.0333, avg_opt_cost=1607611.0333, epoch=1.0000, train_loss=0.0065, val_loss=0.0159]    2%|▏         | 2/100 [01:40<57:20, 35.11s/it, avg_corr=0.7268, avg_corr_cosin=0.9568, avg_gap=24.7578, avg_init_cost=2005806.6000, avg_opt_cost=1607611.0333, epoch=2.0000, train_loss=0.0056, val_loss=0.0263]  3%|▎         | 3/100 [01:40<50:20, 31.14s/it, avg_corr=0.7268, avg_corr_cosin=0.9568, avg_gap=24.7578, avg_init_cost=2005806.6000, avg_opt_cost=1607611.0333, epoch=2.0000, train_loss=0.0056, val_loss=0.0263]  3%|▎         | 3/100 [02:06<50:20, 31.14s/it, avg_corr=0.8033, avg_corr_cosin=0.9696, avg_gap=21.4595, avg_init_cost=1948009.3667, avg_opt_cost=1607611.0333, epoch=3.0000, train_loss=0.0054, val_loss=0.0120]  4%|▍         | 4/100 [02:06<46:58, 29.36s/it, avg_corr=0.8033, avg_corr_cosin=0.9696, avg_gap=21.4595, avg_init_cost=1948009.3667, avg_opt_cost=1607611.0333, epoch=3.0000, train_loss=0.0054, val_loss=0.0120]  4%|▍         | 4/100 [02:33<46:58, 29.36s/it, avg_corr=0.8065, avg_corr_cosin=0.9696, avg_gap=19.3707, avg_init_cost=1919555.0000, avg_opt_cost=1607611.0333, epoch=4.0000, train_loss=0.0050, val_loss=0.0158]  5%|▌         | 5/100 [02:33<45:07, 28.50s/it, avg_corr=0.8065, avg_corr_cosin=0.9696, avg_gap=19.3707, avg_init_cost=1919555.0000, avg_opt_cost=1607611.0333, epoch=4.0000, train_loss=0.0050, val_loss=0.0158]  5%|▌         | 5/100 [03:00<45:07, 28.50s/it, avg_corr=0.8502, avg_corr_cosin=0.9751, avg_gap=19.7712, avg_init_cost=1925355.7000, avg_opt_cost=1607611.0333, epoch=5.0000, train_loss=0.0044, val_loss=0.0057]  6%|▌         | 6/100 [03:00<43:39, 27.87s/it, avg_corr=0.8502, avg_corr_cosin=0.9751, avg_gap=19.7712, avg_init_cost=1925355.7000, avg_opt_cost=1607611.0333, epoch=5.0000, train_loss=0.0044, val_loss=0.0057]  6%|▌         | 6/100 [03:27<43:39, 27.87s/it, avg_corr=0.8593, avg_corr_cosin=0.9777, avg_gap=15.6148, avg_init_cost=1860215.2333, avg_opt_cost=1607611.0333, epoch=6.0000, train_loss=0.0042, val_loss=0.0047]  7%|▋         | 7/100 [03:27<42:44, 27.58s/it, avg_corr=0.8593, avg_corr_cosin=0.9777, avg_gap=15.6148, avg_init_cost=1860215.2333, avg_opt_cost=1607611.0333, epoch=6.0000, train_loss=0.0042, val_loss=0.0047]  7%|▋         | 7/100 [03:53<42:44, 27.58s/it, avg_corr=0.8662, avg_corr_cosin=0.9788, avg_gap=15.0631, avg_init_cost=1852452.8667, avg_opt_cost=1607611.0333, epoch=7.0000, train_loss=0.0041, val_loss=0.0046]  8%|▊         | 8/100 [03:53<41:44, 27.22s/it, avg_corr=0.8662, avg_corr_cosin=0.9788, avg_gap=15.0631, avg_init_cost=1852452.8667, avg_opt_cost=1607611.0333, epoch=7.0000, train_loss=0.0041, val_loss=0.0046]  8%|▊         | 8/100 [04:20<41:44, 27.22s/it, avg_corr=0.8603, avg_corr_cosin=0.9781, avg_gap=15.4770, avg_init_cost=1859728.3667, avg_opt_cost=1607611.0333, epoch=8.0000, train_loss=0.0038, val_loss=0.0064]  9%|▉         | 9/100 [04:20<41:00, 27.04s/it, avg_corr=0.8603, avg_corr_cosin=0.9781, avg_gap=15.4770, avg_init_cost=1859728.3667, avg_opt_cost=1607611.0333, epoch=8.0000, train_loss=0.0038, val_loss=0.0064]  9%|▉         | 9/100 [04:47<41:00, 27.04s/it, avg_corr=0.8334, avg_corr_cosin=0.9738, avg_gap=18.7844, avg_init_cost=1913693.3000, avg_opt_cost=1607611.0333, epoch=9.0000, train_loss=0.0038, val_loss=0.0115] 10%|█         | 10/100 [04:47<40:25, 26.95s/it, avg_corr=0.8334, avg_corr_cosin=0.9738, avg_gap=18.7844, avg_init_cost=1913693.3000, avg_opt_cost=1607611.0333, epoch=9.0000, train_loss=0.0038, val_loss=0.0115] 10%|█         | 10/100 [05:14<40:25, 26.95s/it, avg_corr=0.8538, avg_corr_cosin=0.9773, avg_gap=19.1080, avg_init_cost=1917641.5000, avg_opt_cost=1607611.0333, epoch=10.0000, train_loss=0.0035, val_loss=0.0063] 11%|█         | 11/100 [05:14<39:56, 26.93s/it, avg_corr=0.8538, avg_corr_cosin=0.9773, avg_gap=19.1080, avg_init_cost=1917641.5000, avg_opt_cost=1607611.0333, epoch=10.0000, train_loss=0.0035, val_loss=0.0063] 11%|█         | 11/100 [05:40<39:56, 26.93s/it, avg_corr=0.8907, avg_corr_cosin=0.9817, avg_gap=13.6900, avg_init_cost=1829671.3667, avg_opt_cost=1607611.0333, epoch=11.0000, train_loss=0.0041, val_loss=0.0050] 12%|█▏        | 12/100 [05:40<39:21, 26.83s/it, avg_corr=0.8907, avg_corr_cosin=0.9817, avg_gap=13.6900, avg_init_cost=1829671.3667, avg_opt_cost=1607611.0333, epoch=11.0000, train_loss=0.0041, val_loss=0.0050] 12%|█▏        | 12/100 [06:07<39:21, 26.83s/it, avg_corr=0.8855, avg_corr_cosin=0.9816, avg_gap=14.7370, avg_init_cost=1847202.8000, avg_opt_cost=1607611.0333, epoch=12.0000, train_loss=0.0032, val_loss=0.0048] 13%|█▎        | 13/100 [06:07<38:49, 26.78s/it, avg_corr=0.8855, avg_corr_cosin=0.9816, avg_gap=14.7370, avg_init_cost=1847202.8000, avg_opt_cost=1607611.0333, epoch=12.0000, train_loss=0.0032, val_loss=0.0048] 13%|█▎        | 13/100 [06:34<38:49, 26.78s/it, avg_corr=0.8884, avg_corr_cosin=0.9817, avg_gap=13.8833, avg_init_cost=1829966.8000, avg_opt_cost=1607611.0333, epoch=13.0000, train_loss=0.0035, val_loss=0.0038] 14%|█▍        | 14/100 [06:34<38:26, 26.82s/it, avg_corr=0.8884, avg_corr_cosin=0.9817, avg_gap=13.8833, avg_init_cost=1829966.8000, avg_opt_cost=1607611.0333, epoch=13.0000, train_loss=0.0035, val_loss=0.0038] 14%|█▍        | 14/100 [07:00<38:26, 26.82s/it, avg_corr=0.8808, avg_corr_cosin=0.9807, avg_gap=15.3053, avg_init_cost=1855363.9333, avg_opt_cost=1607611.0333, epoch=14.0000, train_loss=0.0035, val_loss=0.0054] 15%|█▌        | 15/100 [07:00<37:47, 26.67s/it, avg_corr=0.8808, avg_corr_cosin=0.9807, avg_gap=15.3053, avg_init_cost=1855363.9333, avg_opt_cost=1607611.0333, epoch=14.0000, train_loss=0.0035, val_loss=0.0054] 15%|█▌        | 15/100 [07:27<37:47, 26.67s/it, avg_corr=0.8862, avg_corr_cosin=0.9804, avg_gap=16.0478, avg_init_cost=1868339.4333, avg_opt_cost=1607611.0333, epoch=15.0000, train_loss=0.0036, val_loss=0.0047] 16%|█▌        | 16/100 [07:27<37:22, 26.70s/it, avg_corr=0.8862, avg_corr_cosin=0.9804, avg_gap=16.0478, avg_init_cost=1868339.4333, avg_opt_cost=1607611.0333, epoch=15.0000, train_loss=0.0036, val_loss=0.0047] 16%|█▌        | 16/100 [07:53<37:22, 26.70s/it, avg_corr=0.8776, avg_corr_cosin=0.9805, avg_gap=15.2919, avg_init_cost=1854133.2000, avg_opt_cost=1607611.0333, epoch=16.0000, train_loss=0.0032, val_loss=0.0079] 17%|█▋        | 17/100 [07:53<36:49, 26.62s/it, avg_corr=0.8776, avg_corr_cosin=0.9805, avg_gap=15.2919, avg_init_cost=1854133.2000, avg_opt_cost=1607611.0333, epoch=16.0000, train_loss=0.0032, val_loss=0.0079] 17%|█▋        | 17/100 [08:20<36:49, 26.62s/it, avg_corr=0.8890, avg_corr_cosin=0.9820, avg_gap=16.9420, avg_init_cost=1880787.9667, avg_opt_cost=1607611.0333, epoch=17.0000, train_loss=0.0032, val_loss=0.0042] 18%|█▊        | 18/100 [08:20<36:27, 26.67s/it, avg_corr=0.8890, avg_corr_cosin=0.9820, avg_gap=16.9420, avg_init_cost=1880787.9667, avg_opt_cost=1607611.0333, epoch=17.0000, train_loss=0.0032, val_loss=0.0042] 18%|█▊        | 18/100 [08:47<36:27, 26.67s/it, avg_corr=0.8959, avg_corr_cosin=0.9829, avg_gap=14.3232, avg_init_cost=1838682.9667, avg_opt_cost=1607611.0333, epoch=18.0000, train_loss=0.0032, val_loss=0.0035] 19%|█▉        | 19/100 [08:47<36:11, 26.80s/it, avg_corr=0.8959, avg_corr_cosin=0.9829, avg_gap=14.3232, avg_init_cost=1838682.9667, avg_opt_cost=1607611.0333, epoch=18.0000, train_loss=0.0032, val_loss=0.0035] 19%|█▉        | 19/100 [09:14<36:11, 26.80s/it, avg_corr=0.8897, avg_corr_cosin=0.9819, avg_gap=14.7793, avg_init_cost=1848725.9333, avg_opt_cost=1607611.0333, epoch=19.0000, train_loss=0.0036, val_loss=0.0046] 20%|██        | 20/100 [09:14<35:37, 26.72s/it, avg_corr=0.8897, avg_corr_cosin=0.9819, avg_gap=14.7793, avg_init_cost=1848725.9333, avg_opt_cost=1607611.0333, epoch=19.0000, train_loss=0.0036, val_loss=0.0046] 20%|██        | 20/100 [09:40<35:37, 26.72s/it, avg_corr=0.8853, avg_corr_cosin=0.9816, avg_gap=15.4774, avg_init_cost=1857561.8333, avg_opt_cost=1607611.0333, epoch=20.0000, train_loss=0.0033, val_loss=0.0047] 21%|██        | 21/100 [09:40<35:11, 26.73s/it, avg_corr=0.8853, avg_corr_cosin=0.9816, avg_gap=15.4774, avg_init_cost=1857561.8333, avg_opt_cost=1607611.0333, epoch=20.0000, train_loss=0.0033, val_loss=0.0047] 21%|██        | 21/100 [10:07<35:11, 26.73s/it, avg_corr=0.8789, avg_corr_cosin=0.9805, avg_gap=16.1063, avg_init_cost=1868664.8000, avg_opt_cost=1607611.0333, epoch=21.0000, train_loss=0.0032, val_loss=0.0057] 22%|██▏       | 22/100 [10:07<34:38, 26.65s/it, avg_corr=0.8789, avg_corr_cosin=0.9805, avg_gap=16.1063, avg_init_cost=1868664.8000, avg_opt_cost=1607611.0333, epoch=21.0000, train_loss=0.0032, val_loss=0.0057] 22%|██▏       | 22/100 [10:34<34:38, 26.65s/it, avg_corr=0.8972, avg_corr_cosin=0.9835, avg_gap=15.8406, avg_init_cost=1864283.2333, avg_opt_cost=1607611.0333, epoch=22.0000, train_loss=0.0032, val_loss=0.0029] 23%|██▎       | 23/100 [10:34<34:18, 26.73s/it, avg_corr=0.8972, avg_corr_cosin=0.9835, avg_gap=15.8406, avg_init_cost=1864283.2333, avg_opt_cost=1607611.0333, epoch=22.0000, train_loss=0.0032, val_loss=0.0029] 23%|██▎       | 23/100 [11:00<34:18, 26.73s/it, avg_corr=0.9010, avg_corr_cosin=0.9839, avg_gap=16.4182, avg_init_cost=1872936.7333, avg_opt_cost=1607611.0333, epoch=23.0000, train_loss=0.0032, val_loss=0.0036] 24%|██▍       | 24/100 [11:00<33:41, 26.60s/it, avg_corr=0.9010, avg_corr_cosin=0.9839, avg_gap=16.4182, avg_init_cost=1872936.7333, avg_opt_cost=1607611.0333, epoch=23.0000, train_loss=0.0032, val_loss=0.0036] 24%|██▍       | 24/100 [11:27<33:41, 26.60s/it, avg_corr=0.8898, avg_corr_cosin=0.9824, avg_gap=15.8624, avg_init_cost=1869159.3667, avg_opt_cost=1607611.0333, epoch=24.0000, train_loss=0.0030, val_loss=0.0039] 25%|██▌       | 25/100 [11:27<33:17, 26.63s/it, avg_corr=0.8898, avg_corr_cosin=0.9824, avg_gap=15.8624, avg_init_cost=1869159.3667, avg_opt_cost=1607611.0333, epoch=24.0000, train_loss=0.0030, val_loss=0.0039] 25%|██▌       | 25/100 [11:54<33:17, 26.63s/it, avg_corr=0.8846, avg_corr_cosin=0.9817, avg_gap=14.6859, avg_init_cost=1848625.6667, avg_opt_cost=1607611.0333, epoch=25.0000, train_loss=0.0034, val_loss=0.0033] 26%|██▌       | 26/100 [11:54<33:02, 26.79s/it, avg_corr=0.8846, avg_corr_cosin=0.9817, avg_gap=14.6859, avg_init_cost=1848625.6667, avg_opt_cost=1607611.0333, epoch=25.0000, train_loss=0.0034, val_loss=0.0033] 26%|██▌       | 26/100 [12:21<33:02, 26.79s/it, avg_corr=0.8966, avg_corr_cosin=0.9836, avg_gap=14.2165, avg_init_cost=1842993.6667, avg_opt_cost=1607611.0333, epoch=26.0000, train_loss=0.0030, val_loss=0.0039] 27%|██▋       | 27/100 [12:21<32:32, 26.75s/it, avg_corr=0.8966, avg_corr_cosin=0.9836, avg_gap=14.2165, avg_init_cost=1842993.6667, avg_opt_cost=1607611.0333, epoch=26.0000, train_loss=0.0030, val_loss=0.0039] 27%|██▋       | 27/100 [12:47<32:32, 26.75s/it, avg_corr=0.9074, avg_corr_cosin=0.9852, avg_gap=14.7391, avg_init_cost=1846755.2000, avg_opt_cost=1607611.0333, epoch=27.0000, train_loss=0.0029, val_loss=0.0053] 28%|██▊       | 28/100 [12:47<32:03, 26.71s/it, avg_corr=0.9074, avg_corr_cosin=0.9852, avg_gap=14.7391, avg_init_cost=1846755.2000, avg_opt_cost=1607611.0333, epoch=27.0000, train_loss=0.0029, val_loss=0.0053] 28%|██▊       | 28/100 [13:14<32:03, 26.71s/it, avg_corr=0.8999, avg_corr_cosin=0.9837, avg_gap=15.0622, avg_init_cost=1853783.6000, avg_opt_cost=1607611.0333, epoch=28.0000, train_loss=0.0028, val_loss=0.0034] 29%|██▉       | 29/100 [13:14<31:35, 26.70s/it, avg_corr=0.8999, avg_corr_cosin=0.9837, avg_gap=15.0622, avg_init_cost=1853783.6000, avg_opt_cost=1607611.0333, epoch=28.0000, train_loss=0.0028, val_loss=0.0034] 29%|██▉       | 29/100 [13:41<31:35, 26.70s/it, avg_corr=0.9035, avg_corr_cosin=0.9844, avg_gap=13.3655, avg_init_cost=1821403.4667, avg_opt_cost=1607611.0333, epoch=29.0000, train_loss=0.0029, val_loss=0.0045] 30%|███       | 30/100 [13:42<31:35, 27.07s/it, avg_corr=0.9035, avg_corr_cosin=0.9844, avg_gap=13.3655, avg_init_cost=1821403.4667, avg_opt_cost=1607611.0333, epoch=29.0000, train_loss=0.0029, val_loss=0.0045] 30%|███       | 30/100 [14:09<31:35, 27.07s/it, avg_corr=0.9061, avg_corr_cosin=0.9844, avg_gap=12.3280, avg_init_cost=1806099.2667, avg_opt_cost=1607611.0333, epoch=30.0000, train_loss=0.0032, val_loss=0.0040] 31%|███       | 31/100 [14:09<31:11, 27.12s/it, avg_corr=0.9061, avg_corr_cosin=0.9844, avg_gap=12.3280, avg_init_cost=1806099.2667, avg_opt_cost=1607611.0333, epoch=30.0000, train_loss=0.0032, val_loss=0.0040] 31%|███       | 31/100 [14:35<31:11, 27.12s/it, avg_corr=0.9025, avg_corr_cosin=0.9843, avg_gap=12.0389, avg_init_cost=1800384.6333, avg_opt_cost=1607611.0333, epoch=31.0000, train_loss=0.0031, val_loss=0.0042] 32%|███▏      | 32/100 [14:35<30:28, 26.89s/it, avg_corr=0.9025, avg_corr_cosin=0.9843, avg_gap=12.0389, avg_init_cost=1800384.6333, avg_opt_cost=1607611.0333, epoch=31.0000, train_loss=0.0031, val_loss=0.0042] 32%|███▏      | 32/100 [15:02<30:28, 26.89s/it, avg_corr=0.9045, avg_corr_cosin=0.9843, avg_gap=13.7770, avg_init_cost=1830326.3333, avg_opt_cost=1607611.0333, epoch=32.0000, train_loss=0.0030, val_loss=0.0038] 33%|███▎      | 33/100 [15:02<29:58, 26.85s/it, avg_corr=0.9045, avg_corr_cosin=0.9843, avg_gap=13.7770, avg_init_cost=1830326.3333, avg_opt_cost=1607611.0333, epoch=32.0000, train_loss=0.0030, val_loss=0.0038] 33%|███▎      | 33/100 [15:29<29:58, 26.85s/it, avg_corr=0.9077, avg_corr_cosin=0.9851, avg_gap=12.3301, avg_init_cost=1807721.9333, avg_opt_cost=1607611.0333, epoch=33.0000, train_loss=0.0030, val_loss=0.0046] 34%|███▍      | 34/100 [15:29<29:26, 26.76s/it, avg_corr=0.9077, avg_corr_cosin=0.9851, avg_gap=12.3301, avg_init_cost=1807721.9333, avg_opt_cost=1607611.0333, epoch=33.0000, train_loss=0.0030, val_loss=0.0046] 34%|███▍      | 34/100 [15:55<29:26, 26.76s/it, avg_corr=0.9055, avg_corr_cosin=0.9845, avg_gap=12.4007, avg_init_cost=1807161.6667, avg_opt_cost=1607611.0333, epoch=34.0000, train_loss=0.0028, val_loss=0.0030] 35%|███▌      | 35/100 [15:55<28:57, 26.74s/it, avg_corr=0.9055, avg_corr_cosin=0.9845, avg_gap=12.4007, avg_init_cost=1807161.6667, avg_opt_cost=1607611.0333, epoch=34.0000, train_loss=0.0028, val_loss=0.0030] 35%|███▌      | 35/100 [16:22<28:57, 26.74s/it, avg_corr=0.9093, avg_corr_cosin=0.9851, avg_gap=15.3376, avg_init_cost=1854047.7667, avg_opt_cost=1607611.0333, epoch=35.0000, train_loss=0.0030, val_loss=0.0035] 36%|███▌      | 36/100 [16:22<28:23, 26.61s/it, avg_corr=0.9093, avg_corr_cosin=0.9851, avg_gap=15.3376, avg_init_cost=1854047.7667, avg_opt_cost=1607611.0333, epoch=35.0000, train_loss=0.0030, val_loss=0.0035] 36%|███▌      | 36/100 [16:48<28:23, 26.61s/it, avg_corr=0.9103, avg_corr_cosin=0.9853, avg_gap=15.4937, avg_init_cost=1859517.1667, avg_opt_cost=1607611.0333, epoch=36.0000, train_loss=0.0028, val_loss=0.0036] 37%|███▋      | 37/100 [16:48<27:56, 26.62s/it, avg_corr=0.9103, avg_corr_cosin=0.9853, avg_gap=15.4937, avg_init_cost=1859517.1667, avg_opt_cost=1607611.0333, epoch=36.0000, train_loss=0.0028, val_loss=0.0036] 37%|███▋      | 37/100 [17:15<27:56, 26.62s/it, avg_corr=0.9095, avg_corr_cosin=0.9854, avg_gap=13.6169, avg_init_cost=1828562.4333, avg_opt_cost=1607611.0333, epoch=37.0000, train_loss=0.0028, val_loss=0.0037] 38%|███▊      | 38/100 [17:15<27:23, 26.50s/it, avg_corr=0.9095, avg_corr_cosin=0.9854, avg_gap=13.6169, avg_init_cost=1828562.4333, avg_opt_cost=1607611.0333, epoch=37.0000, train_loss=0.0028, val_loss=0.0037]