Namespace(data_dir='../tsp_input/generated_insatnces_3000_size_50/', tb_dir='../atsp_model_train_result', atsp_size=50, to_homo=False, half_st=False, model='HetroGATSum', input_dim=1, hidden_dim=128, output_dim=1, relation_types='ss st tt pp', n_gnn_layers=4, n_heads=64, jk='cat', lr_init=0.001, lr_decay=0.95, min_delta=0.0001, patience=200, batch_size=15, n_epochs=100, checkpoint_freq=10, seed=4, n_trials=1, n_samples_result_train=30, device='cuda')
Namespace(atsp_size=250, data_path='../tsp_input/generated_insatnces_30_size_250', model_path='../atsp_model_train_result/Oct15_17-34-03_HetroGATSum_trained_ATSP50/trial_0', time_limit=0.16, perturbation_moves=5, device='cuda')
device = cuda
model: HetroGATSum trained in ATSP50 for 100 and tested in ATSP250 for 30
  0%|          | 0/30 [00:00<?, ?it/s]  0%|          | 0/30 [00:02<?, ?it/s, Sum_GNN_time:=1.1596, Sum_Search_time:=0.2279, Avg_Gap_init:=22.6669, Avg_Gap_best:=21.7597, Avg_Cost_init:=1.8964, Avg_Cost_best:=1.8824, Avg_Otpimal_best:=1.5460, Avg_counts: =4.0000]  3%|▎         | 1/30 [00:02<01:19,  2.74s/it, Sum_GNN_time:=1.1596, Sum_Search_time:=0.2279, Avg_Gap_init:=22.6669, Avg_Gap_best:=21.7597, Avg_Cost_init:=1.8964, Avg_Cost_best:=1.8824, Avg_Otpimal_best:=1.5460, Avg_counts: =4.0000]  3%|▎         | 1/30 [00:04<01:19,  2.74s/it, Sum_GNN_time:=1.6603, Sum_Search_time:=0.4570, Avg_Gap_init:=25.1963, Avg_Gap_best:=24.0264, Avg_Cost_init:=1.9183, Avg_Cost_best:=1.9004, Avg_Otpimal_best:=1.5325, Avg_counts: =4.0000]  7%|▋         | 2/30 [00:04<01:03,  2.28s/it, Sum_GNN_time:=1.6603, Sum_Search_time:=0.4570, Avg_Gap_init:=25.1963, Avg_Gap_best:=24.0264, Avg_Cost_init:=1.9183, Avg_Cost_best:=1.9004, Avg_Otpimal_best:=1.5325, Avg_counts: =4.0000]  7%|▋         | 2/30 [00:06<01:03,  2.28s/it, Sum_GNN_time:=2.1558, Sum_Search_time:=0.6844, Avg_Gap_init:=23.4501, Avg_Gap_best:=22.4452, Avg_Cost_init:=1.9526, Avg_Cost_best:=1.9369, Avg_Otpimal_best:=1.5833, Avg_counts: =4.0000] 10%|█         | 3/30 [00:06<00:57,  2.13s/it, Sum_GNN_time:=2.1558, Sum_Search_time:=0.6844, Avg_Gap_init:=23.4501, Avg_Gap_best:=22.4452, Avg_Cost_init:=1.9526, Avg_Cost_best:=1.9369, Avg_Otpimal_best:=1.5833, Avg_counts: =4.0000] 10%|█         | 3/30 [00:08<00:57,  2.13s/it, Sum_GNN_time:=2.6517, Sum_Search_time:=0.9119, Avg_Gap_init:=22.9048, Avg_Gap_best:=21.8060, Avg_Cost_init:=1.9563, Avg_Cost_best:=1.9389, Avg_Otpimal_best:=1.5931, Avg_counts: =4.0000] 13%|█▎        | 4/30 [00:08<00:53,  2.06s/it, Sum_GNN_time:=2.6517, Sum_Search_time:=0.9119, Avg_Gap_init:=22.9048, Avg_Gap_best:=21.8060, Avg_Cost_init:=1.9563, Avg_Cost_best:=1.9389, Avg_Otpimal_best:=1.5931, Avg_counts: =4.0000] 13%|█▎        | 4/30 [00:10<00:53,  2.06s/it, Sum_GNN_time:=3.1455, Sum_Search_time:=1.1403, Avg_Gap_init:=22.6181, Avg_Gap_best:=21.5949, Avg_Cost_init:=1.9420, Avg_Cost_best:=1.9259, Avg_Otpimal_best:=1.5848, Avg_counts: =4.0000] 17%|█▋        | 5/30 [00:10<00:50,  2.03s/it, Sum_GNN_time:=3.1455, Sum_Search_time:=1.1403, Avg_Gap_init:=22.6181, Avg_Gap_best:=21.5949, Avg_Cost_init:=1.9420, Avg_Cost_best:=1.9259, Avg_Otpimal_best:=1.5848, Avg_counts: =4.0000] 17%|█▋        | 5/30 [00:12<00:50,  2.03s/it, Sum_GNN_time:=3.6422, Sum_Search_time:=1.3668, Avg_Gap_init:=22.0097, Avg_Gap_best:=21.0157, Avg_Cost_init:=1.9225, Avg_Cost_best:=1.9068, Avg_Otpimal_best:=1.5763, Avg_counts: =4.0000] 20%|██        | 6/30 [00:12<00:47,  1.98s/it, Sum_GNN_time:=3.6422, Sum_Search_time:=1.3668, Avg_Gap_init:=22.0097, Avg_Gap_best:=21.0157, Avg_Cost_init:=1.9225, Avg_Cost_best:=1.9068, Avg_Otpimal_best:=1.5763, Avg_counts: =4.0000] 20%|██        | 6/30 [00:14<00:47,  1.98s/it, Sum_GNN_time:=4.1525, Sum_Search_time:=1.6150, Avg_Gap_init:=20.6644, Avg_Gap_best:=19.6418, Avg_Cost_init:=1.9122, Avg_Cost_best:=1.8960, Avg_Otpimal_best:=1.5859, Avg_counts: =4.0000] 23%|██▎       | 7/30 [00:14<00:45,  1.99s/it, Sum_GNN_time:=4.1525, Sum_Search_time:=1.6150, Avg_Gap_init:=20.6644, Avg_Gap_best:=19.6418, Avg_Cost_init:=1.9122, Avg_Cost_best:=1.8960, Avg_Otpimal_best:=1.5859, Avg_counts: =4.0000] 23%|██▎       | 7/30 [00:16<00:45,  1.99s/it, Sum_GNN_time:=4.6483, Sum_Search_time:=1.8427, Avg_Gap_init:=21.3480, Avg_Gap_best:=20.3128, Avg_Cost_init:=1.9212, Avg_Cost_best:=1.9048, Avg_Otpimal_best:=1.5843, Avg_counts: =4.0000] 27%|██▋       | 8/30 [00:16<00:43,  1.99s/it, Sum_GNN_time:=4.6483, Sum_Search_time:=1.8427, Avg_Gap_init:=21.3480, Avg_Gap_best:=20.3128, Avg_Cost_init:=1.9212, Avg_Cost_best:=1.9048, Avg_Otpimal_best:=1.5843, Avg_counts: =4.0000] 27%|██▋       | 8/30 [00:18<00:43,  1.99s/it, Sum_GNN_time:=5.1431, Sum_Search_time:=2.0733, Avg_Gap_init:=20.4727, Avg_Gap_best:=19.5048, Avg_Cost_init:=1.8936, Avg_Cost_best:=1.8784, Avg_Otpimal_best:=1.5721, Avg_counts: =4.0000] 30%|███       | 9/30 [00:18<00:41,  1.98s/it, Sum_GNN_time:=5.1431, Sum_Search_time:=2.0733, Avg_Gap_init:=20.4727, Avg_Gap_best:=19.5048, Avg_Cost_init:=1.8936, Avg_Cost_best:=1.8784, Avg_Otpimal_best:=1.5721, Avg_counts: =4.0000] 30%|███       | 9/30 [00:20<00:41,  1.98s/it, Sum_GNN_time:=5.6522, Sum_Search_time:=2.3013, Avg_Gap_init:=20.4546, Avg_Gap_best:=19.5190, Avg_Cost_init:=1.8978, Avg_Cost_best:=1.8830, Avg_Otpimal_best:=1.5758, Avg_counts: =4.0000] 33%|███▎      | 10/30 [00:20<00:39,  2.00s/it, Sum_GNN_time:=5.6522, Sum_Search_time:=2.3013, Avg_Gap_init:=20.4546, Avg_Gap_best:=19.5190, Avg_Cost_init:=1.8978, Avg_Cost_best:=1.8830, Avg_Otpimal_best:=1.5758, Avg_counts: =4.0000] 33%|███▎      | 10/30 [00:22<00:39,  2.00s/it, Sum_GNN_time:=6.1471, Sum_Search_time:=2.5363, Avg_Gap_init:=19.8904, Avg_Gap_best:=19.0014, Avg_Cost_init:=1.8992, Avg_Cost_best:=1.8851, Avg_Otpimal_best:=1.5847, Avg_counts: =4.0000] 37%|███▋      | 11/30 [00:22<00:38,  2.01s/it, Sum_GNN_time:=6.1471, Sum_Search_time:=2.5363, Avg_Gap_init:=19.8904, Avg_Gap_best:=19.0014, Avg_Cost_init:=1.8992, Avg_Cost_best:=1.8851, Avg_Otpimal_best:=1.5847, Avg_counts: =4.0000] 37%|███▋      | 11/30 [00:24<00:38,  2.01s/it, Sum_GNN_time:=6.6570, Sum_Search_time:=2.7921, Avg_Gap_init:=19.9210, Avg_Gap_best:=19.0830, Avg_Cost_init:=1.8914, Avg_Cost_best:=1.8782, Avg_Otpimal_best:=1.5779, Avg_counts: =4.0000] 40%|████      | 12/30 [00:24<00:35,  1.98s/it, Sum_GNN_time:=6.6570, Sum_Search_time:=2.7921, Avg_Gap_init:=19.9210, Avg_Gap_best:=19.0830, Avg_Cost_init:=1.8914, Avg_Cost_best:=1.8782, Avg_Otpimal_best:=1.5779, Avg_counts: =4.0000] 40%|████      | 12/30 [00:26<00:35,  1.98s/it, Sum_GNN_time:=7.1534, Sum_Search_time:=3.0205, Avg_Gap_init:=19.7600, Avg_Gap_best:=18.9451, Avg_Cost_init:=1.8933, Avg_Cost_best:=1.8804, Avg_Otpimal_best:=1.5816, Avg_counts: =4.0000] 43%|████▎     | 13/30 [00:26<00:33,  1.99s/it, Sum_GNN_time:=7.1534, Sum_Search_time:=3.0205, Avg_Gap_init:=19.7600, Avg_Gap_best:=18.9451, Avg_Cost_init:=1.8933, Avg_Cost_best:=1.8804, Avg_Otpimal_best:=1.5816, Avg_counts: =4.0000] 43%|████▎     | 13/30 [00:28<00:33,  1.99s/it, Sum_GNN_time:=7.6484, Sum_Search_time:=3.2485, Avg_Gap_init:=20.1569, Avg_Gap_best:=19.2815, Avg_Cost_init:=1.9109, Avg_Cost_best:=1.8968, Avg_Otpimal_best:=1.5905, Avg_counts: =4.0000] 47%|████▋     | 14/30 [00:28<00:31,  1.99s/it, Sum_GNN_time:=7.6484, Sum_Search_time:=3.2485, Avg_Gap_init:=20.1569, Avg_Gap_best:=19.2815, Avg_Cost_init:=1.9109, Avg_Cost_best:=1.8968, Avg_Otpimal_best:=1.5905, Avg_counts: =4.0000] 47%|████▋     | 14/30 [00:30<00:31,  1.99s/it, Sum_GNN_time:=8.1584, Sum_Search_time:=3.4771, Avg_Gap_init:=19.7209, Avg_Gap_best:=18.8105, Avg_Cost_init:=1.8866, Avg_Cost_best:=1.8723, Avg_Otpimal_best:=1.5753, Avg_counts: =4.0000] 50%|█████     | 15/30 [00:30<00:30,  2.03s/it, Sum_GNN_time:=8.1584, Sum_Search_time:=3.4771, Avg_Gap_init:=19.7209, Avg_Gap_best:=18.8105, Avg_Cost_init:=1.8866, Avg_Cost_best:=1.8723, Avg_Otpimal_best:=1.5753, Avg_counts: =4.0000] 50%|█████     | 15/30 [00:32<00:30,  2.03s/it, Sum_GNN_time:=8.6536, Sum_Search_time:=3.7042, Avg_Gap_init:=19.7791, Avg_Gap_best:=18.8503, Avg_Cost_init:=1.8731, Avg_Cost_best:=1.8586, Avg_Otpimal_best:=1.5633, Avg_counts: =4.0000] 53%|█████▎    | 16/30 [00:32<00:28,  2.03s/it, Sum_GNN_time:=8.6536, Sum_Search_time:=3.7042, Avg_Gap_init:=19.7791, Avg_Gap_best:=18.8503, Avg_Cost_init:=1.8731, Avg_Cost_best:=1.8586, Avg_Otpimal_best:=1.5633, Avg_counts: =4.0000] 53%|█████▎    | 16/30 [00:34<00:28,  2.03s/it, Sum_GNN_time:=9.1599, Sum_Search_time:=3.9583, Avg_Gap_init:=19.8651, Avg_Gap_best:=18.9117, Avg_Cost_init:=1.8804, Avg_Cost_best:=1.8655, Avg_Otpimal_best:=1.5683, Avg_counts: =4.0000] 57%|█████▋    | 17/30 [00:34<00:25,  1.99s/it, Sum_GNN_time:=9.1599, Sum_Search_time:=3.9583, Avg_Gap_init:=19.8651, Avg_Gap_best:=18.9117, Avg_Cost_init:=1.8804, Avg_Cost_best:=1.8655, Avg_Otpimal_best:=1.5683, Avg_counts: =4.0000] 57%|█████▋    | 17/30 [00:36<00:25,  1.99s/it, Sum_GNN_time:=9.6608, Sum_Search_time:=4.1866, Avg_Gap_init:=20.2007, Avg_Gap_best:=19.2358, Avg_Cost_init:=1.8853, Avg_Cost_best:=1.8701, Avg_Otpimal_best:=1.5680, Avg_counts: =4.0000] 60%|██████    | 18/30 [00:36<00:24,  2.01s/it, Sum_GNN_time:=9.6608, Sum_Search_time:=4.1866, Avg_Gap_init:=20.2007, Avg_Gap_best:=19.2358, Avg_Cost_init:=1.8853, Avg_Cost_best:=1.8701, Avg_Otpimal_best:=1.5680, Avg_counts: =4.0000] 60%|██████    | 18/30 [00:38<00:24,  2.01s/it, Sum_GNN_time:=10.1553, Sum_Search_time:=4.4145, Avg_Gap_init:=20.3925, Avg_Gap_best:=19.4200, Avg_Cost_init:=1.8926, Avg_Cost_best:=1.8773, Avg_Otpimal_best:=1.5715, Avg_counts: =4.0000] 63%|██████▎   | 19/30 [00:38<00:22,  2.01s/it, Sum_GNN_time:=10.1553, Sum_Search_time:=4.4145, Avg_Gap_init:=20.3925, Avg_Gap_best:=19.4200, Avg_Cost_init:=1.8926, Avg_Cost_best:=1.8773, Avg_Otpimal_best:=1.5715, Avg_counts: =4.0000] 63%|██████▎   | 19/30 [00:40<00:22,  2.01s/it, Sum_GNN_time:=10.6511, Sum_Search_time:=4.6449, Avg_Gap_init:=20.3314, Avg_Gap_best:=19.3549, Avg_Cost_init:=1.8889, Avg_Cost_best:=1.8735, Avg_Otpimal_best:=1.5692, Avg_counts: =4.0000] 67%|██████▋   | 20/30 [00:40<00:19,  2.00s/it, Sum_GNN_time:=10.6511, Sum_Search_time:=4.6449, Avg_Gap_init:=20.3314, Avg_Gap_best:=19.3549, Avg_Cost_init:=1.8889, Avg_Cost_best:=1.8735, Avg_Otpimal_best:=1.5692, Avg_counts: =4.0000] 67%|██████▋   | 20/30 [00:42<00:19,  2.00s/it, Sum_GNN_time:=11.1468, Sum_Search_time:=4.8751, Avg_Gap_init:=20.1852, Avg_Gap_best:=19.1741, Avg_Cost_init:=1.8830, Avg_Cost_best:=1.8672, Avg_Otpimal_best:=1.5662, Avg_counts: =4.0000] 70%|███████   | 21/30 [00:42<00:17,  2.00s/it, Sum_GNN_time:=11.1468, Sum_Search_time:=4.8751, Avg_Gap_init:=20.1852, Avg_Gap_best:=19.1741, Avg_Cost_init:=1.8830, Avg_Cost_best:=1.8672, Avg_Otpimal_best:=1.5662, Avg_counts: =4.0000] 70%|███████   | 21/30 [00:44<00:17,  2.00s/it, Sum_GNN_time:=11.6543, Sum_Search_time:=5.1212, Avg_Gap_init:=20.5145, Avg_Gap_best:=19.4893, Avg_Cost_init:=1.8929, Avg_Cost_best:=1.8768, Avg_Otpimal_best:=1.5699, Avg_counts: =4.0000] 73%|███████▎  | 22/30 [00:44<00:16,  2.01s/it, Sum_GNN_time:=11.6543, Sum_Search_time:=5.1212, Avg_Gap_init:=20.5145, Avg_Gap_best:=19.4893, Avg_Cost_init:=1.8929, Avg_Cost_best:=1.8768, Avg_Otpimal_best:=1.5699, Avg_counts: =4.0000] 73%|███████▎  | 22/30 [00:46<00:16,  2.01s/it, Sum_GNN_time:=12.1494, Sum_Search_time:=5.3488, Avg_Gap_init:=20.5678, Avg_Gap_best:=19.5082, Avg_Cost_init:=1.8932, Avg_Cost_best:=1.8765, Avg_Otpimal_best:=1.5695, Avg_counts: =4.0000] 77%|███████▋  | 23/30 [00:46<00:14,  2.01s/it, Sum_GNN_time:=12.1494, Sum_Search_time:=5.3488, Avg_Gap_init:=20.5678, Avg_Gap_best:=19.5082, Avg_Cost_init:=1.8932, Avg_Cost_best:=1.8765, Avg_Otpimal_best:=1.5695, Avg_counts: =4.0000] 77%|███████▋  | 23/30 [00:48<00:14,  2.01s/it, Sum_GNN_time:=12.6443, Sum_Search_time:=5.5796, Avg_Gap_init:=20.7227, Avg_Gap_best:=19.6309, Avg_Cost_init:=1.8920, Avg_Cost_best:=1.8750, Avg_Otpimal_best:=1.5667, Avg_counts: =4.0000] 80%|████████  | 24/30 [00:48<00:11,  1.97s/it, Sum_GNN_time:=12.6443, Sum_Search_time:=5.5796, Avg_Gap_init:=20.7227, Avg_Gap_best:=19.6309, Avg_Cost_init:=1.8920, Avg_Cost_best:=1.8750, Avg_Otpimal_best:=1.5667, Avg_counts: =4.0000] 80%|████████  | 24/30 [00:50<00:11,  1.97s/it, Sum_GNN_time:=13.1675, Sum_Search_time:=5.8339, Avg_Gap_init:=20.8004, Avg_Gap_best:=19.7107, Avg_Cost_init:=1.8938, Avg_Cost_best:=1.8767, Avg_Otpimal_best:=1.5671, Avg_counts: =4.0000] 83%|████████▎ | 25/30 [00:50<00:10,  2.02s/it, Sum_GNN_time:=13.1675, Sum_Search_time:=5.8339, Avg_Gap_init:=20.8004, Avg_Gap_best:=19.7107, Avg_Cost_init:=1.8938, Avg_Cost_best:=1.8767, Avg_Otpimal_best:=1.5671, Avg_counts: =4.0000] 83%|████████▎ | 25/30 [00:52<00:10,  2.02s/it, Sum_GNN_time:=13.6916, Sum_Search_time:=6.0909, Avg_Gap_init:=20.8210, Avg_Gap_best:=19.6976, Avg_Cost_init:=1.8939, Avg_Cost_best:=1.8763, Avg_Otpimal_best:=1.5669, Avg_counts: =4.0000] 87%|████████▋ | 26/30 [00:52<00:08,  2.06s/it, Sum_GNN_time:=13.6916, Sum_Search_time:=6.0909, Avg_Gap_init:=20.8210, Avg_Gap_best:=19.6976, Avg_Cost_init:=1.8939, Avg_Cost_best:=1.8763, Avg_Otpimal_best:=1.5669, Avg_counts: =4.0000] 87%|████████▋ | 26/30 [00:54<00:08,  2.06s/it, Sum_GNN_time:=14.2007, Sum_Search_time:=6.3472, Avg_Gap_init:=20.9105, Avg_Gap_best:=19.7778, Avg_Cost_init:=1.8941, Avg_Cost_best:=1.8764, Avg_Otpimal_best:=1.5660, Avg_counts: =4.0000] 90%|█████████ | 27/30 [00:54<00:06,  2.09s/it, Sum_GNN_time:=14.2007, Sum_Search_time:=6.3472, Avg_Gap_init:=20.9105, Avg_Gap_best:=19.7778, Avg_Cost_init:=1.8941, Avg_Cost_best:=1.8764, Avg_Otpimal_best:=1.5660, Avg_counts: =4.0000] 90%|█████████ | 27/30 [00:56<00:06,  2.09s/it, Sum_GNN_time:=14.7094, Sum_Search_time:=6.5732, Avg_Gap_init:=20.8228, Avg_Gap_best:=19.6942, Avg_Cost_init:=1.8920, Avg_Cost_best:=1.8744, Avg_Otpimal_best:=1.5654, Avg_counts: =4.0000] 93%|█████████▎| 28/30 [00:56<00:04,  2.08s/it, Sum_GNN_time:=14.7094, Sum_Search_time:=6.5732, Avg_Gap_init:=20.8228, Avg_Gap_best:=19.6942, Avg_Cost_init:=1.8920, Avg_Cost_best:=1.8744, Avg_Otpimal_best:=1.5654, Avg_counts: =4.0000] 93%|█████████▎| 28/30 [00:58<00:04,  2.08s/it, Sum_GNN_time:=15.2031, Sum_Search_time:=6.8122, Avg_Gap_init:=20.6721, Avg_Gap_best:=19.5533, Avg_Cost_init:=1.8860, Avg_Cost_best:=1.8685, Avg_Otpimal_best:=1.5623, Avg_counts: =4.0000] 97%|█████████▋| 29/30 [00:58<00:02,  2.06s/it, Sum_GNN_time:=15.2031, Sum_Search_time:=6.8122, Avg_Gap_init:=20.6721, Avg_Gap_best:=19.5533, Avg_Cost_init:=1.8860, Avg_Cost_best:=1.8685, Avg_Otpimal_best:=1.5623, Avg_counts: =4.0000] 97%|█████████▋| 29/30 [01:00<00:02,  2.06s/it, Sum_GNN_time:=15.6997, Sum_Search_time:=7.0418, Avg_Gap_init:=20.4455, Avg_Gap_best:=19.3432, Avg_Cost_init:=1.8822, Avg_Cost_best:=1.8650, Avg_Otpimal_best:=1.5621, Avg_counts: =4.0000]100%|██████████| 30/30 [01:00<00:00,  2.05s/it, Sum_GNN_time:=15.6997, Sum_Search_time:=7.0418, Avg_Gap_init:=20.4455, Avg_Gap_best:=19.3432, Avg_Cost_init:=1.8822, Avg_Cost_best:=1.8650, Avg_Otpimal_best:=1.5621, Avg_counts: =4.0000]100%|██████████| 30/30 [01:00<00:00,  2.03s/it, Sum_GNN_time:=15.6997, Sum_Search_time:=7.0418, Avg_Gap_init:=20.4455, Avg_Gap_best:=19.3432, Avg_Cost_init:=1.8822, Avg_Cost_best:=1.8650, Avg_Otpimal_best:=1.5621, Avg_counts: =4.0000]
Total time for model prediction: 15.6997 seconds
Total time for guided local search: 7.0418 seconds
