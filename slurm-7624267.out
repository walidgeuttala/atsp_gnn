Namespace(data_dir='../tsp_input/generated_insatnces_3000_size_50/', tb_dir='../atsp_model_train_result', atsp_size=50, to_homo=False, half_st=False, model='HetroGATConcat', input_dim=1, hidden_dim=128, output_dim=1, relation_types='ss tt pp', n_gnn_layers=4, n_heads=64, jk='cat', lr_init=0.001, lr_decay=0.95, min_delta=0.0001, patience=200, batch_size=1, n_epochs=100, checkpoint_freq=10, seed=4, n_trials=1, n_samples_result_train=30, device='cuda')
the edge list tensor([[          0,           1],
        [          0,           2],
        [          0,           3],
        ...,
        [-1206572128,       32506],
        [-1206572048,       32506],
        [-1206571968,       32506]], dtype=torch.int32)
the edge list tensor([[ 0,  1],
        [ 0,  2],
        [ 0,  3],
        ...,
        [63,  0],
        [64,  0],
        [65,  0]], dtype=torch.int32)
device = cuda
  0%|          | 0/100 [00:00<?, ?it/s]the range of the loop is 0, 49
the range of the loop is 0, 49
range ot the tensor is 98
the range of the loop is 0, 49
range ot the tensor is 98
range ot the tensor is 98
the range of the loop is 0, 49
range ot the tensor is 98
  0%|          | 0/100 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/project/p_gnn001/code/tsp/tsp_gnn/train.py", line 171, in <module>
    best_val_result, best_avg_gap_result, run_name = train(args, trial_id, run_name)
                                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/project/p_gnn001/code/tsp/tsp_gnn/train.py", line 118, in train
    result['train_loss'][epoch] = epoch_train(model, train_loader, criterion, optimizer, args.device)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/project/p_gnn001/code/tsp/tsp_gnn/train.py", line 26, in epoch_train
    for batch_i, batch in enumerate(train_loader):
  File "/home/p_gnngw/miniconda3/envs/cuda118/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 631, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/home/p_gnngw/miniconda3/envs/cuda118/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1346, in _next_data
    return self._process_data(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/p_gnngw/miniconda3/envs/cuda118/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1372, in _process_data
    data.reraise()
  File "/home/p_gnngw/miniconda3/envs/cuda118/lib/python3.12/site-packages/torch/_utils.py", line 722, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/p_gnngw/miniconda3/envs/cuda118/lib/python3.12/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/p_gnngw/miniconda3/envs/cuda118/lib/python3.12/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/project/p_gnn001/code/tsp/tsp_gnn/gnngls/datasets.py", line 199, in __getitem__
    H = self.get_scaled_features(G)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/project/p_gnn001/code/tsp/tsp_gnn/gnngls/datasets.py", line 231, in get_scaled_features
    features_transformed = self.scalers['weight'].transform(features.numpy())
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/p_gnngw/miniconda3/envs/cuda118/lib/python3.12/site-packages/sklearn/utils/_set_output.py", line 140, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/p_gnngw/miniconda3/envs/cuda118/lib/python3.12/site-packages/sklearn/preprocessing/_data.py", line 514, in transform
    X = self._validate_data(
        ^^^^^^^^^^^^^^^^^^^^
  File "/home/p_gnngw/miniconda3/envs/cuda118/lib/python3.12/site-packages/sklearn/base.py", line 604, in _validate_data
    out = check_array(X, input_name="X", **check_params)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/p_gnngw/miniconda3/envs/cuda118/lib/python3.12/site-packages/sklearn/utils/validation.py", line 940, in check_array
    raise ValueError(
ValueError: Expected 2D array, got 1D array instead:
array=[ 1.2454344e+27  4.5552009e-41 -1.3379974e-12  4.5550608e-41
  1.3677178e+27  4.5552009e-41  3.4281432e-12  4.5553410e-41
  3.2385934e-12  4.5553410e-41  8.6707030e-12  4.5553410e-41
 -1.3620407e-12  4.5550608e-41  2.0601442e+26  4.5552009e-41
  1.2426789e+27  4.5552009e-41 -8.4303409e-10  4.5550608e-41
  2.0683463e+26  4.5552009e-41  2.0682991e+26  4.5552009e-41
  9.1136284e-36  3.0723469e-41  3.9542397e-12  4.5553410e-41
  2.0676616e+26  4.5552009e-41  8.6870180e-36  3.0723469e-41
  8.5112908e-36  3.0723469e-41 -1.3620476e-12  4.5550608e-41
 -1.3620615e-12  4.5550608e-41 -1.3620684e-12  4.5550608e-41
 -1.3620754e-12  4.5550608e-41  9.0733528e-36  3.0723469e-41
 -1.3636245e-12  4.5550608e-41  9.1165843e-36  3.0723469e-41
 -1.3620823e-12  4.5550608e-41  2.5768006e+26  4.5552009e-41
  1.0420387e-11  4.5553410e-41  1.0421594e-11  4.5553410e-41
  9.0745007e-36  3.0723469e-41  9.0724344e-36  3.0723469e-41
  9.0899692e-36  3.0723469e-41  3.6514333e-12  4.5553410e-41
  8.5242626e-36  3.0723469e-41  9.0875241e-36  3.0723469e-41
  1.9982782e+26  4.5552009e-41  2.5774824e+26  4.5552009e-41
  3.3970188e-12  4.5553410e-41 -1.3621309e-12  4.5550608e-41
  3.0263843e-41  8.4638427e-43  8.4638427e-43  4.7588043e-35
  1.8358720e-34  0.0000000e+00  0.0000000e+00  6.2824784e-38
  0.0000000e+00  6.2448137e-39  2.2371730e-41  8.4638427e-43
  3.0457758e-33  4.1883073e-38  1.4499235e-41  7.4095685e-37
  3.3771293e-42  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  4.5070134e-32].
Reshape your data either using array.reshape(-1, 1) if your data has a single feature or array.reshape(1, -1) if it contains a single sample.

the range of the loop is 0, 49
range ot the tensor is 98
the range of the loop is 0, 49
range ot the tensor is 98
the range of the loop is 0, 49
the range of the loop is 0, 49
range ot the tensor is 98
range ot the tensor is 98
