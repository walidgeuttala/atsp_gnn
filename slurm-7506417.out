Namespace(data_dir='../tsp_input/generated_insatnces_3000_size_50/', tb_dir='../atsp_model_train_result', atsp_size=50, to_homo=False, half_st=True, model='HetroGATConcat', input_dim=1, hidden_dim=128, output_dim=1, relation_types='ss st tt pp', n_gnn_layers=4, n_heads=64, jk='cat', lr_init=0.001, lr_decay=0.95, min_delta=0.0001, patience=200, batch_size=15, n_epochs=100, checkpoint_freq=10, seed=4, n_trials=1, n_samples_result_train=30, device='cuda')
Namespace(atsp_size=150, data_path='../tsp_input/generated_insatnces_30_size_150', model_path='../atsp_model_train_result/Oct15_17-24-54_HetroGATConcat_trained_ATSP50/trial_0', time_limit=0.16, perturbation_moves=5, device='cuda')
device = cuda
model: HetroGATConcat trained in ATSP50 for 100 and tested in ATSP150 for 30
  0%|          | 0/30 [00:00<?, ?it/s]  0%|          | 0/30 [00:01<?, ?it/s, Sum_GNN_time:=0.8145, Sum_Search_time:=0.2206, Avg_Gap_init:=15.0977, Avg_Gap_best:=9.9001, Avg_Cost_init:=1.8346, Avg_Cost_best:=1.7518, Avg_Otpimal_best:=1.5940, Avg_counts: =12.0000]  3%|▎         | 1/30 [00:01<00:48,  1.66s/it, Sum_GNN_time:=0.8145, Sum_Search_time:=0.2206, Avg_Gap_init:=15.0977, Avg_Gap_best:=9.9001, Avg_Cost_init:=1.8346, Avg_Cost_best:=1.7518, Avg_Otpimal_best:=1.5940, Avg_counts: =12.0000]  3%|▎         | 1/30 [00:02<00:48,  1.66s/it, Sum_GNN_time:=0.9471, Sum_Search_time:=0.3823, Avg_Gap_init:=11.6793, Avg_Gap_best:=8.7030, Avg_Cost_init:=1.7494, Avg_Cost_best:=1.7022, Avg_Otpimal_best:=1.5656, Avg_counts: =10.0000]  7%|▋         | 2/30 [00:02<00:31,  1.13s/it, Sum_GNN_time:=0.9471, Sum_Search_time:=0.3823, Avg_Gap_init:=11.6793, Avg_Gap_best:=8.7030, Avg_Cost_init:=1.7494, Avg_Cost_best:=1.7022, Avg_Otpimal_best:=1.5656, Avg_counts: =10.0000]  7%|▋         | 2/30 [00:03<00:31,  1.13s/it, Sum_GNN_time:=1.0805, Sum_Search_time:=0.5444, Avg_Gap_init:=12.5113, Avg_Gap_best:=9.9060, Avg_Cost_init:=1.7575, Avg_Cost_best:=1.7163, Avg_Otpimal_best:=1.5615, Avg_counts: =9.3333]  10%|█         | 3/30 [00:03<00:25,  1.07it/s, Sum_GNN_time:=1.0805, Sum_Search_time:=0.5444, Avg_Gap_init:=12.5113, Avg_Gap_best:=9.9060, Avg_Cost_init:=1.7575, Avg_Cost_best:=1.7163, Avg_Otpimal_best:=1.5615, Avg_counts: =9.3333] 10%|█         | 3/30 [00:03<00:25,  1.07it/s, Sum_GNN_time:=1.2148, Sum_Search_time:=0.7052, Avg_Gap_init:=12.7004, Avg_Gap_best:=9.9822, Avg_Cost_init:=1.7323, Avg_Cost_best:=1.6902, Avg_Otpimal_best:=1.5368, Avg_counts: =9.0000] 13%|█▎        | 4/30 [00:03<00:22,  1.14it/s, Sum_GNN_time:=1.2148, Sum_Search_time:=0.7052, Avg_Gap_init:=12.7004, Avg_Gap_best:=9.9822, Avg_Cost_init:=1.7323, Avg_Cost_best:=1.6902, Avg_Otpimal_best:=1.5368, Avg_counts: =9.0000] 13%|█▎        | 4/30 [00:04<00:22,  1.14it/s, Sum_GNN_time:=1.3510, Sum_Search_time:=0.8661, Avg_Gap_init:=13.6794, Avg_Gap_best:=10.9709, Avg_Cost_init:=1.7618, Avg_Cost_best:=1.7196, Avg_Otpimal_best:=1.5491, Avg_counts: =8.8000] 17%|█▋        | 5/30 [00:04<00:20,  1.24it/s, Sum_GNN_time:=1.3510, Sum_Search_time:=0.8661, Avg_Gap_init:=13.6794, Avg_Gap_best:=10.9709, Avg_Cost_init:=1.7618, Avg_Cost_best:=1.7196, Avg_Otpimal_best:=1.5491, Avg_counts: =8.8000] 17%|█▋        | 5/30 [00:05<00:20,  1.24it/s, Sum_GNN_time:=1.4861, Sum_Search_time:=1.0266, Avg_Gap_init:=14.3090, Avg_Gap_best:=11.6704, Avg_Cost_init:=1.8095, Avg_Cost_best:=1.7677, Avg_Otpimal_best:=1.5816, Avg_counts: =8.6667] 20%|██        | 6/30 [00:05<00:19,  1.25it/s, Sum_GNN_time:=1.4861, Sum_Search_time:=1.0266, Avg_Gap_init:=14.3090, Avg_Gap_best:=11.6704, Avg_Cost_init:=1.8095, Avg_Cost_best:=1.7677, Avg_Otpimal_best:=1.5816, Avg_counts: =8.6667] 20%|██        | 6/30 [00:06<00:19,  1.25it/s, Sum_GNN_time:=1.6211, Sum_Search_time:=1.1884, Avg_Gap_init:=13.9510, Avg_Gap_best:=11.2117, Avg_Cost_init:=1.8159, Avg_Cost_best:=1.7722, Avg_Otpimal_best:=1.5926, Avg_counts: =8.5714] 23%|██▎       | 7/30 [00:06<00:17,  1.31it/s, Sum_GNN_time:=1.6211, Sum_Search_time:=1.1884, Avg_Gap_init:=13.9510, Avg_Gap_best:=11.2117, Avg_Cost_init:=1.8159, Avg_Cost_best:=1.7722, Avg_Otpimal_best:=1.5926, Avg_counts: =8.5714] 23%|██▎       | 7/30 [00:06<00:17,  1.31it/s, Sum_GNN_time:=1.7556, Sum_Search_time:=1.3498, Avg_Gap_init:=14.0727, Avg_Gap_best:=11.4515, Avg_Cost_init:=1.8256, Avg_Cost_best:=1.7836, Avg_Otpimal_best:=1.5994, Avg_counts: =8.5000] 27%|██▋       | 8/30 [00:06<00:16,  1.35it/s, Sum_GNN_time:=1.7556, Sum_Search_time:=1.3498, Avg_Gap_init:=14.0727, Avg_Gap_best:=11.4515, Avg_Cost_init:=1.8256, Avg_Cost_best:=1.7836, Avg_Otpimal_best:=1.5994, Avg_counts: =8.5000] 27%|██▋       | 8/30 [00:07<00:16,  1.35it/s, Sum_GNN_time:=1.8894, Sum_Search_time:=1.5104, Avg_Gap_init:=14.4573, Avg_Gap_best:=11.9674, Avg_Cost_init:=1.8171, Avg_Cost_best:=1.7774, Avg_Otpimal_best:=1.5871, Avg_counts: =8.4444] 30%|███       | 9/30 [00:07<00:15,  1.32it/s, Sum_GNN_time:=1.8894, Sum_Search_time:=1.5104, Avg_Gap_init:=14.4573, Avg_Gap_best:=11.9674, Avg_Cost_init:=1.8171, Avg_Cost_best:=1.7774, Avg_Otpimal_best:=1.5871, Avg_counts: =8.4444] 30%|███       | 9/30 [00:08<00:15,  1.32it/s, Sum_GNN_time:=2.0235, Sum_Search_time:=1.6711, Avg_Gap_init:=14.3796, Avg_Gap_best:=11.9407, Avg_Cost_init:=1.8161, Avg_Cost_best:=1.7773, Avg_Otpimal_best:=1.5873, Avg_counts: =8.4000] 33%|███▎      | 10/30 [00:08<00:14,  1.35it/s, Sum_GNN_time:=2.0235, Sum_Search_time:=1.6711, Avg_Gap_init:=14.3796, Avg_Gap_best:=11.9407, Avg_Cost_init:=1.8161, Avg_Cost_best:=1.7773, Avg_Otpimal_best:=1.5873, Avg_counts: =8.4000] 33%|███▎      | 10/30 [00:09<00:14,  1.35it/s, Sum_GNN_time:=2.1584, Sum_Search_time:=1.8329, Avg_Gap_init:=14.3971, Avg_Gap_best:=11.7924, Avg_Cost_init:=1.8088, Avg_Cost_best:=1.7676, Avg_Otpimal_best:=1.5808, Avg_counts: =8.3636] 37%|███▋      | 11/30 [00:09<00:14,  1.33it/s, Sum_GNN_time:=2.1584, Sum_Search_time:=1.8329, Avg_Gap_init:=14.3971, Avg_Gap_best:=11.7924, Avg_Cost_init:=1.8088, Avg_Cost_best:=1.7676, Avg_Otpimal_best:=1.5808, Avg_counts: =8.3636] 37%|███▋      | 11/30 [00:09<00:14,  1.33it/s, Sum_GNN_time:=2.2925, Sum_Search_time:=1.9936, Avg_Gap_init:=14.5033, Avg_Gap_best:=12.0227, Avg_Cost_init:=1.8083, Avg_Cost_best:=1.7691, Avg_Otpimal_best:=1.5789, Avg_counts: =8.3333] 40%|████      | 12/30 [00:09<00:13,  1.37it/s, Sum_GNN_time:=2.2925, Sum_Search_time:=1.9936, Avg_Gap_init:=14.5033, Avg_Gap_best:=12.0227, Avg_Cost_init:=1.8083, Avg_Cost_best:=1.7691, Avg_Otpimal_best:=1.5789, Avg_counts: =8.3333] 40%|████      | 12/30 [00:10<00:13,  1.37it/s, Sum_GNN_time:=2.4270, Sum_Search_time:=2.1549, Avg_Gap_init:=14.8025, Avg_Gap_best:=12.2414, Avg_Cost_init:=1.8143, Avg_Cost_best:=1.7738, Avg_Otpimal_best:=1.5800, Avg_counts: =8.3077] 43%|████▎     | 13/30 [00:10<00:12,  1.40it/s, Sum_GNN_time:=2.4270, Sum_Search_time:=2.1549, Avg_Gap_init:=14.8025, Avg_Gap_best:=12.2414, Avg_Cost_init:=1.8143, Avg_Cost_best:=1.7738, Avg_Otpimal_best:=1.5800, Avg_counts: =8.3077] 43%|████▎     | 13/30 [00:11<00:12,  1.40it/s, Sum_GNN_time:=2.5606, Sum_Search_time:=2.3164, Avg_Gap_init:=14.7825, Avg_Gap_best:=12.2263, Avg_Cost_init:=1.8189, Avg_Cost_best:=1.7783, Avg_Otpimal_best:=1.5843, Avg_counts: =8.2857] 47%|████▋     | 14/30 [00:11<00:11,  1.34it/s, Sum_GNN_time:=2.5606, Sum_Search_time:=2.3164, Avg_Gap_init:=14.7825, Avg_Gap_best:=12.2263, Avg_Cost_init:=1.8189, Avg_Cost_best:=1.7783, Avg_Otpimal_best:=1.5843, Avg_counts: =8.2857] 47%|████▋     | 14/30 [00:11<00:11,  1.34it/s, Sum_GNN_time:=2.6943, Sum_Search_time:=2.4776, Avg_Gap_init:=14.6977, Avg_Gap_best:=12.1952, Avg_Cost_init:=1.8151, Avg_Cost_best:=1.7755, Avg_Otpimal_best:=1.5822, Avg_counts: =8.2667] 50%|█████     | 15/30 [00:11<00:10,  1.37it/s, Sum_GNN_time:=2.6943, Sum_Search_time:=2.4776, Avg_Gap_init:=14.6977, Avg_Gap_best:=12.1952, Avg_Cost_init:=1.8151, Avg_Cost_best:=1.7755, Avg_Otpimal_best:=1.5822, Avg_counts: =8.2667] 50%|█████     | 15/30 [00:12<00:10,  1.37it/s, Sum_GNN_time:=2.8283, Sum_Search_time:=2.6394, Avg_Gap_init:=14.8429, Avg_Gap_best:=12.2374, Avg_Cost_init:=1.8250, Avg_Cost_best:=1.7834, Avg_Otpimal_best:=1.5887, Avg_counts: =8.2500] 53%|█████▎    | 16/30 [00:12<00:10,  1.33it/s, Sum_GNN_time:=2.8283, Sum_Search_time:=2.6394, Avg_Gap_init:=14.8429, Avg_Gap_best:=12.2374, Avg_Cost_init:=1.8250, Avg_Cost_best:=1.7834, Avg_Otpimal_best:=1.5887, Avg_counts: =8.2500] 53%|█████▎    | 16/30 [00:13<00:10,  1.33it/s, Sum_GNN_time:=2.9627, Sum_Search_time:=2.8019, Avg_Gap_init:=14.9607, Avg_Gap_best:=12.2957, Avg_Cost_init:=1.8224, Avg_Cost_best:=1.7801, Avg_Otpimal_best:=1.5849, Avg_counts: =8.2353] 57%|█████▋    | 17/30 [00:13<00:09,  1.36it/s, Sum_GNN_time:=2.9627, Sum_Search_time:=2.8019, Avg_Gap_init:=14.9607, Avg_Gap_best:=12.2957, Avg_Cost_init:=1.8224, Avg_Cost_best:=1.7801, Avg_Otpimal_best:=1.5849, Avg_counts: =8.2353] 57%|█████▋    | 17/30 [00:14<00:09,  1.36it/s, Sum_GNN_time:=3.0966, Sum_Search_time:=2.9628, Avg_Gap_init:=14.7067, Avg_Gap_best:=12.1388, Avg_Cost_init:=1.8148, Avg_Cost_best:=1.7740, Avg_Otpimal_best:=1.5817, Avg_counts: =8.2222] 60%|██████    | 18/30 [00:14<00:09,  1.33it/s, Sum_GNN_time:=3.0966, Sum_Search_time:=2.9628, Avg_Gap_init:=14.7067, Avg_Gap_best:=12.1388, Avg_Cost_init:=1.8148, Avg_Cost_best:=1.7740, Avg_Otpimal_best:=1.5817, Avg_counts: =8.2222] 60%|██████    | 18/30 [00:14<00:09,  1.33it/s, Sum_GNN_time:=3.2305, Sum_Search_time:=3.1920, Avg_Gap_init:=14.4330, Avg_Gap_best:=11.8552, Avg_Cost_init:=1.8179, Avg_Cost_best:=1.7767, Avg_Otpimal_best:=1.5885, Avg_counts: =8.4211] 63%|██████▎   | 19/30 [00:14<00:08,  1.33it/s, Sum_GNN_time:=3.2305, Sum_Search_time:=3.1920, Avg_Gap_init:=14.4330, Avg_Gap_best:=11.8552, Avg_Cost_init:=1.8179, Avg_Cost_best:=1.7767, Avg_Otpimal_best:=1.5885, Avg_counts: =8.4211] 63%|██████▎   | 19/30 [00:15<00:08,  1.33it/s, Sum_GNN_time:=3.3650, Sum_Search_time:=3.3539, Avg_Gap_init:=14.3753, Avg_Gap_best:=11.7738, Avg_Cost_init:=1.8164, Avg_Cost_best:=1.7750, Avg_Otpimal_best:=1.5880, Avg_counts: =8.4000] 67%|██████▋   | 20/30 [00:15<00:07,  1.36it/s, Sum_GNN_time:=3.3650, Sum_Search_time:=3.3539, Avg_Gap_init:=14.3753, Avg_Gap_best:=11.7738, Avg_Cost_init:=1.8164, Avg_Cost_best:=1.7750, Avg_Otpimal_best:=1.5880, Avg_counts: =8.4000] 67%|██████▋   | 20/30 [00:16<00:07,  1.36it/s, Sum_GNN_time:=3.5001, Sum_Search_time:=3.5140, Avg_Gap_init:=14.1648, Avg_Gap_best:=11.6417, Avg_Cost_init:=1.8111, Avg_Cost_best:=1.7709, Avg_Otpimal_best:=1.5862, Avg_counts: =8.3810] 70%|███████   | 21/30 [00:16<00:06,  1.32it/s, Sum_GNN_time:=3.5001, Sum_Search_time:=3.5140, Avg_Gap_init:=14.1648, Avg_Gap_best:=11.6417, Avg_Cost_init:=1.8111, Avg_Cost_best:=1.7709, Avg_Otpimal_best:=1.5862, Avg_counts: =8.3810] 70%|███████   | 21/30 [00:17<00:06,  1.32it/s, Sum_GNN_time:=3.6338, Sum_Search_time:=3.6744, Avg_Gap_init:=14.1994, Avg_Gap_best:=11.5547, Avg_Cost_init:=1.8100, Avg_Cost_best:=1.7679, Avg_Otpimal_best:=1.5848, Avg_counts: =8.3636] 73%|███████▎  | 22/30 [00:17<00:05,  1.36it/s, Sum_GNN_time:=3.6338, Sum_Search_time:=3.6744, Avg_Gap_init:=14.1994, Avg_Gap_best:=11.5547, Avg_Cost_init:=1.8100, Avg_Cost_best:=1.7679, Avg_Otpimal_best:=1.5848, Avg_counts: =8.3636] 73%|███████▎  | 22/30 [00:17<00:05,  1.36it/s, Sum_GNN_time:=3.7681, Sum_Search_time:=3.8368, Avg_Gap_init:=14.2086, Avg_Gap_best:=11.5455, Avg_Cost_init:=1.8163, Avg_Cost_best:=1.7738, Avg_Otpimal_best:=1.5902, Avg_counts: =8.3478] 77%|███████▋  | 23/30 [00:17<00:05,  1.33it/s, Sum_GNN_time:=3.7681, Sum_Search_time:=3.8368, Avg_Gap_init:=14.2086, Avg_Gap_best:=11.5455, Avg_Cost_init:=1.8163, Avg_Cost_best:=1.7738, Avg_Otpimal_best:=1.5902, Avg_counts: =8.3478] 77%|███████▋  | 23/30 [00:18<00:05,  1.33it/s, Sum_GNN_time:=3.9028, Sum_Search_time:=3.9982, Avg_Gap_init:=14.2252, Avg_Gap_best:=11.5645, Avg_Cost_init:=1.8223, Avg_Cost_best:=1.7797, Avg_Otpimal_best:=1.5952, Avg_counts: =8.3333] 80%|████████  | 24/30 [00:18<00:04,  1.36it/s, Sum_GNN_time:=3.9028, Sum_Search_time:=3.9982, Avg_Gap_init:=14.2252, Avg_Gap_best:=11.5645, Avg_Cost_init:=1.8223, Avg_Cost_best:=1.7797, Avg_Otpimal_best:=1.5952, Avg_counts: =8.3333] 80%|████████  | 24/30 [00:19<00:04,  1.36it/s, Sum_GNN_time:=4.0368, Sum_Search_time:=4.1601, Avg_Gap_init:=14.2652, Avg_Gap_best:=11.6177, Avg_Cost_init:=1.8274, Avg_Cost_best:=1.7849, Avg_Otpimal_best:=1.5991, Avg_counts: =8.3200] 83%|████████▎ | 25/30 [00:19<00:03,  1.39it/s, Sum_GNN_time:=4.0368, Sum_Search_time:=4.1601, Avg_Gap_init:=14.2652, Avg_Gap_best:=11.6177, Avg_Cost_init:=1.8274, Avg_Cost_best:=1.7849, Avg_Otpimal_best:=1.5991, Avg_counts: =8.3200] 83%|████████▎ | 25/30 [00:20<00:03,  1.39it/s, Sum_GNN_time:=4.1716, Sum_Search_time:=4.3217, Avg_Gap_init:=14.3445, Avg_Gap_best:=11.6823, Avg_Cost_init:=1.8287, Avg_Cost_best:=1.7861, Avg_Otpimal_best:=1.5991, Avg_counts: =8.3077] 87%|████████▋ | 26/30 [00:20<00:02,  1.34it/s, Sum_GNN_time:=4.1716, Sum_Search_time:=4.3217, Avg_Gap_init:=14.3445, Avg_Gap_best:=11.6823, Avg_Cost_init:=1.8287, Avg_Cost_best:=1.7861, Avg_Otpimal_best:=1.5991, Avg_counts: =8.3077] 87%|████████▋ | 26/30 [00:20<00:02,  1.34it/s, Sum_GNN_time:=4.3061, Sum_Search_time:=4.4831, Avg_Gap_init:=14.3693, Avg_Gap_best:=11.6366, Avg_Cost_init:=1.8285, Avg_Cost_best:=1.7847, Avg_Otpimal_best:=1.5986, Avg_counts: =8.2963] 90%|█████████ | 27/30 [00:20<00:02,  1.37it/s, Sum_GNN_time:=4.3061, Sum_Search_time:=4.4831, Avg_Gap_init:=14.3693, Avg_Gap_best:=11.6366, Avg_Cost_init:=1.8285, Avg_Cost_best:=1.7847, Avg_Otpimal_best:=1.5986, Avg_counts: =8.2963] 90%|█████████ | 27/30 [00:21<00:02,  1.37it/s, Sum_GNN_time:=4.4408, Sum_Search_time:=4.7130, Avg_Gap_init:=14.3689, Avg_Gap_best:=11.5866, Avg_Cost_init:=1.8295, Avg_Cost_best:=1.7849, Avg_Otpimal_best:=1.5994, Avg_counts: =8.4286] 93%|█████████▎| 28/30 [00:21<00:01,  1.31it/s, Sum_GNN_time:=4.4408, Sum_Search_time:=4.7130, Avg_Gap_init:=14.3689, Avg_Gap_best:=11.5866, Avg_Cost_init:=1.8295, Avg_Cost_best:=1.7849, Avg_Otpimal_best:=1.5994, Avg_counts: =8.4286] 93%|█████████▎| 28/30 [00:22<00:01,  1.31it/s, Sum_GNN_time:=4.5763, Sum_Search_time:=4.8746, Avg_Gap_init:=14.2703, Avg_Gap_best:=11.5193, Avg_Cost_init:=1.8321, Avg_Cost_best:=1.7879, Avg_Otpimal_best:=1.6032, Avg_counts: =8.4138] 97%|█████████▋| 29/30 [00:22<00:00,  1.35it/s, Sum_GNN_time:=4.5763, Sum_Search_time:=4.8746, Avg_Gap_init:=14.2703, Avg_Gap_best:=11.5193, Avg_Cost_init:=1.8321, Avg_Cost_best:=1.7879, Avg_Otpimal_best:=1.6032, Avg_counts: =8.4138] 97%|█████████▋| 29/30 [00:23<00:00,  1.35it/s, Sum_GNN_time:=4.7092, Sum_Search_time:=5.0361, Avg_Gap_init:=14.4078, Avg_Gap_best:=11.6847, Avg_Cost_init:=1.8345, Avg_Cost_best:=1.7908, Avg_Otpimal_best:=1.6034, Avg_counts: =8.4000]100%|██████████| 30/30 [00:23<00:00,  1.32it/s, Sum_GNN_time:=4.7092, Sum_Search_time:=5.0361, Avg_Gap_init:=14.4078, Avg_Gap_best:=11.6847, Avg_Cost_init:=1.8345, Avg_Cost_best:=1.7908, Avg_Otpimal_best:=1.6034, Avg_counts: =8.4000]100%|██████████| 30/30 [00:23<00:00,  1.30it/s, Sum_GNN_time:=4.7092, Sum_Search_time:=5.0361, Avg_Gap_init:=14.4078, Avg_Gap_best:=11.6847, Avg_Cost_init:=1.8345, Avg_Cost_best:=1.7908, Avg_Otpimal_best:=1.6034, Avg_counts: =8.4000]
Total time for model prediction: 4.7092 seconds
Total time for guided local search: 5.0361 seconds
