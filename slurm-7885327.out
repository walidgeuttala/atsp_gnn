/project/c_gnn_001/conda_envs/cuda121/lib/python3.11/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator MinMaxScaler from version 1.3.0 when using version 1.5.2. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(
Namespace(data_dir='../tsp_input/generated_insatnces_3000_size_50/', tb_dir='../atsp_model_train_result', atsp_size=50, to_homo=True, half_st=False, model='EdgePropertyPredictionModel2', input_dim=1, hidden_dim=128, output_dim=1, relation_types='ss tt pp', n_gnn_layers=4, n_heads=64, jk='cat', lr_init=0.001, lr_decay=0.95, min_delta=0.0001, patience=200, batch_size=15, n_epochs=100, checkpoint_freq=10, seed=4, n_trials=1, n_samples_result_train=30, device='cuda')
device = cuda
  0%|          | 0/100 [00:00<?, ?it/s]  0%|          | 0/100 [01:15<?, ?it/s, avg_corr=0.7664, avg_corr_cosin=0.9615, avg_gap=28.4957, avg_init_cost=2076018.3000, avg_opt_cost=1607611.0333, epoch=0.0000, train_loss=0.0213, val_loss=0.0055]  1%|          | 1/100 [01:15<2:05:17, 75.94s/it, avg_corr=0.7664, avg_corr_cosin=0.9615, avg_gap=28.4957, avg_init_cost=2076018.3000, avg_opt_cost=1607611.0333, epoch=0.0000, train_loss=0.0213, val_loss=0.0055]  1%|          | 1/100 [02:10<2:05:17, 75.94s/it, avg_corr=0.8297, avg_corr_cosin=0.9730, avg_gap=18.0444, avg_init_cost=1904630.5667, avg_opt_cost=1607611.0333, epoch=1.0000, train_loss=0.0042, val_loss=0.0078]  2%|▏         | 2/100 [02:10<1:43:48, 63.55s/it, avg_corr=0.8297, avg_corr_cosin=0.9730, avg_gap=18.0444, avg_init_cost=1904630.5667, avg_opt_cost=1607611.0333, epoch=1.0000, train_loss=0.0042, val_loss=0.0078]  2%|▏         | 2/100 [03:07<1:43:48, 63.55s/it, avg_corr=0.8305, avg_corr_cosin=0.9638, avg_gap=20.5928, avg_init_cost=1948779.4667, avg_opt_cost=1607611.0333, epoch=2.0000, train_loss=0.0041, val_loss=0.0058]  3%|▎         | 3/100 [03:07<1:37:45, 60.47s/it, avg_corr=0.8305, avg_corr_cosin=0.9638, avg_gap=20.5928, avg_init_cost=1948779.4667, avg_opt_cost=1607611.0333, epoch=2.0000, train_loss=0.0041, val_loss=0.0058]  3%|▎         | 3/100 [04:03<1:37:45, 60.47s/it, avg_corr=0.8650, avg_corr_cosin=0.9764, avg_gap=14.3702, avg_init_cost=1840890.6667, avg_opt_cost=1607611.0333, epoch=3.0000, train_loss=0.0045, val_loss=0.0053]  4%|▍         | 4/100 [04:04<1:34:19, 58.95s/it, avg_corr=0.8650, avg_corr_cosin=0.9764, avg_gap=14.3702, avg_init_cost=1840890.6667, avg_opt_cost=1607611.0333, epoch=3.0000, train_loss=0.0045, val_loss=0.0053]  4%|▍         | 4/100 [05:00<1:34:19, 58.95s/it, avg_corr=0.8541, avg_corr_cosin=0.9726, avg_gap=17.0176, avg_init_cost=1891907.8333, avg_opt_cost=1607611.0333, epoch=4.0000, train_loss=0.0040, val_loss=0.0073]  5%|▌         | 5/100 [05:01<1:32:06, 58.17s/it, avg_corr=0.8541, avg_corr_cosin=0.9726, avg_gap=17.0176, avg_init_cost=1891907.8333, avg_opt_cost=1607611.0333, epoch=4.0000, train_loss=0.0040, val_loss=0.0073]  5%|▌         | 5/100 [05:57<1:32:06, 58.17s/it, avg_corr=0.8872, avg_corr_cosin=0.9800, avg_gap=17.1579, avg_init_cost=1888511.6000, avg_opt_cost=1607611.0333, epoch=5.0000, train_loss=0.0038, val_loss=0.0030]  6%|▌         | 6/100 [05:58<1:30:29, 57.77s/it, avg_corr=0.8872, avg_corr_cosin=0.9800, avg_gap=17.1579, avg_init_cost=1888511.6000, avg_opt_cost=1607611.0333, epoch=5.0000, train_loss=0.0038, val_loss=0.0030]  6%|▌         | 6/100 [06:54<1:30:29, 57.77s/it, avg_corr=0.8762, avg_corr_cosin=0.9783, avg_gap=16.0214, avg_init_cost=1864460.4667, avg_opt_cost=1607611.0333, epoch=6.0000, train_loss=0.0043, val_loss=0.0041]  7%|▋         | 7/100 [06:55<1:29:09, 57.52s/it, avg_corr=0.8762, avg_corr_cosin=0.9783, avg_gap=16.0214, avg_init_cost=1864460.4667, avg_opt_cost=1607611.0333, epoch=6.0000, train_loss=0.0043, val_loss=0.0041]  7%|▋         | 7/100 [07:52<1:29:09, 57.52s/it, avg_corr=0.8808, avg_corr_cosin=0.9803, avg_gap=17.1902, avg_init_cost=1892673.5000, avg_opt_cost=1607611.0333, epoch=7.0000, train_loss=0.0035, val_loss=0.0065]  8%|▊         | 8/100 [07:52<1:28:13, 57.54s/it, avg_corr=0.8808, avg_corr_cosin=0.9803, avg_gap=17.1902, avg_init_cost=1892673.5000, avg_opt_cost=1607611.0333, epoch=7.0000, train_loss=0.0035, val_loss=0.0065]  8%|▊         | 8/100 [08:49<1:28:13, 57.54s/it, avg_corr=0.8885, avg_corr_cosin=0.9814, avg_gap=16.0508, avg_init_cost=1871530.9333, avg_opt_cost=1607611.0333, epoch=8.0000, train_loss=0.0038, val_loss=0.0045]  9%|▉         | 9/100 [08:49<1:27:10, 57.48s/it, avg_corr=0.8885, avg_corr_cosin=0.9814, avg_gap=16.0508, avg_init_cost=1871530.9333, avg_opt_cost=1607611.0333, epoch=8.0000, train_loss=0.0038, val_loss=0.0045]  9%|▉         | 9/100 [09:50<1:27:10, 57.48s/it, avg_corr=0.8835, avg_corr_cosin=0.9786, avg_gap=13.7991, avg_init_cost=1832151.7333, avg_opt_cost=1607611.0333, epoch=9.0000, train_loss=0.0037, val_loss=0.0036] 10%|█         | 10/100 [09:50<1:27:35, 58.40s/it, avg_corr=0.8835, avg_corr_cosin=0.9786, avg_gap=13.7991, avg_init_cost=1832151.7333, avg_opt_cost=1607611.0333, epoch=9.0000, train_loss=0.0037, val_loss=0.0036] 10%|█         | 10/100 [10:50<1:27:35, 58.40s/it, avg_corr=0.8765, avg_corr_cosin=0.9748, avg_gap=17.5163, avg_init_cost=1893446.0000, avg_opt_cost=1607611.0333, epoch=10.0000, train_loss=0.0035, val_loss=0.0052] 11%|█         | 11/100 [10:50<1:27:30, 59.00s/it, avg_corr=0.8765, avg_corr_cosin=0.9748, avg_gap=17.5163, avg_init_cost=1893446.0000, avg_opt_cost=1607611.0333, epoch=10.0000, train_loss=0.0035, val_loss=0.0052] 11%|█         | 11/100 [11:53<1:27:30, 59.00s/it, avg_corr=0.8966, avg_corr_cosin=0.9793, avg_gap=15.9480, avg_init_cost=1870159.2333, avg_opt_cost=1607611.0333, epoch=11.0000, train_loss=0.0036, val_loss=0.0044] 12%|█▏        | 12/100 [11:53<1:28:07, 60.09s/it, avg_corr=0.8966, avg_corr_cosin=0.9793, avg_gap=15.9480, avg_init_cost=1870159.2333, avg_opt_cost=1607611.0333, epoch=11.0000, train_loss=0.0036, val_loss=0.0044] 12%|█▏        | 12/100 [12:53<1:28:07, 60.09s/it, avg_corr=0.8822, avg_corr_cosin=0.9773, avg_gap=22.3931, avg_init_cost=1979181.0333, avg_opt_cost=1607611.0333, epoch=12.0000, train_loss=0.0036, val_loss=0.0087] 13%|█▎        | 13/100 [12:53<1:27:05, 60.07s/it, avg_corr=0.8822, avg_corr_cosin=0.9773, avg_gap=22.3931, avg_init_cost=1979181.0333, avg_opt_cost=1607611.0333, epoch=12.0000, train_loss=0.0036, val_loss=0.0087] 13%|█▎        | 13/100 [13:52<1:27:05, 60.07s/it, avg_corr=0.8940, avg_corr_cosin=0.9805, avg_gap=15.3098, avg_init_cost=1856533.1000, avg_opt_cost=1607611.0333, epoch=13.0000, train_loss=0.0035, val_loss=0.0034] 14%|█▍        | 14/100 [13:52<1:25:49, 59.87s/it, avg_corr=0.8940, avg_corr_cosin=0.9805, avg_gap=15.3098, avg_init_cost=1856533.1000, avg_opt_cost=1607611.0333, epoch=13.0000, train_loss=0.0035, val_loss=0.0034] 14%|█▍        | 14/100 [14:53<1:25:49, 59.87s/it, avg_corr=0.8824, avg_corr_cosin=0.9783, avg_gap=12.5730, avg_init_cost=1814990.9667, avg_opt_cost=1607611.0333, epoch=14.0000, train_loss=0.0032, val_loss=0.0053] 15%|█▌        | 15/100 [14:53<1:25:22, 60.26s/it, avg_corr=0.8824, avg_corr_cosin=0.9783, avg_gap=12.5730, avg_init_cost=1814990.9667, avg_opt_cost=1607611.0333, epoch=14.0000, train_loss=0.0032, val_loss=0.0053] 15%|█▌        | 15/100 [15:54<1:25:22, 60.26s/it, avg_corr=0.8866, avg_corr_cosin=0.9777, avg_gap=17.6258, avg_init_cost=1887336.7333, avg_opt_cost=1607611.0333, epoch=15.0000, train_loss=0.0036, val_loss=0.0074] 16%|█▌        | 16/100 [15:54<1:24:30, 60.36s/it, avg_corr=0.8866, avg_corr_cosin=0.9777, avg_gap=17.6258, avg_init_cost=1887336.7333, avg_opt_cost=1607611.0333, epoch=15.0000, train_loss=0.0036, val_loss=0.0074] 16%|█▌        | 16/100 [16:53<1:24:30, 60.36s/it, avg_corr=0.8890, avg_corr_cosin=0.9798, avg_gap=16.6289, avg_init_cost=1880185.2000, avg_opt_cost=1607611.0333, epoch=16.0000, train_loss=0.0032, val_loss=0.0069] 17%|█▋        | 17/100 [16:53<1:22:59, 59.99s/it, avg_corr=0.8890, avg_corr_cosin=0.9798, avg_gap=16.6289, avg_init_cost=1880185.2000, avg_opt_cost=1607611.0333, epoch=16.0000, train_loss=0.0032, val_loss=0.0069] 17%|█▋        | 17/100 [17:54<1:22:59, 59.99s/it, avg_corr=0.8912, avg_corr_cosin=0.9788, avg_gap=22.5119, avg_init_cost=1977189.4667, avg_opt_cost=1607611.0333, epoch=17.0000, train_loss=0.0033, val_loss=0.0067] 18%|█▊        | 18/100 [17:54<1:22:07, 60.10s/it, avg_corr=0.8912, avg_corr_cosin=0.9788, avg_gap=22.5119, avg_init_cost=1977189.4667, avg_opt_cost=1607611.0333, epoch=17.0000, train_loss=0.0033, val_loss=0.0067] 18%|█▊        | 18/100 [18:51<1:22:07, 60.10s/it, avg_corr=0.8885, avg_corr_cosin=0.9754, avg_gap=18.6991, avg_init_cost=1915021.8000, avg_opt_cost=1607611.0333, epoch=18.0000, train_loss=0.0033, val_loss=0.0049] 19%|█▉        | 19/100 [18:52<1:20:16, 59.47s/it, avg_corr=0.8885, avg_corr_cosin=0.9754, avg_gap=18.6991, avg_init_cost=1915021.8000, avg_opt_cost=1607611.0333, epoch=18.0000, train_loss=0.0033, val_loss=0.0049] 19%|█▉        | 19/100 [19:50<1:20:16, 59.47s/it, avg_corr=0.8811, avg_corr_cosin=0.9759, avg_gap=17.0342, avg_init_cost=1884810.6667, avg_opt_cost=1607611.0333, epoch=19.0000, train_loss=0.0030, val_loss=0.0053] 20%|██        | 20/100 [19:50<1:18:57, 59.22s/it, avg_corr=0.8811, avg_corr_cosin=0.9759, avg_gap=17.0342, avg_init_cost=1884810.6667, avg_opt_cost=1607611.0333, epoch=19.0000, train_loss=0.0030, val_loss=0.0053] 20%|██        | 20/100 [20:48<1:18:57, 59.22s/it, avg_corr=0.8766, avg_corr_cosin=0.9724, avg_gap=20.5688, avg_init_cost=1948382.3333, avg_opt_cost=1607611.0333, epoch=20.0000, train_loss=0.0029, val_loss=0.0073] 21%|██        | 21/100 [20:48<1:17:31, 58.87s/it, avg_corr=0.8766, avg_corr_cosin=0.9724, avg_gap=20.5688, avg_init_cost=1948382.3333, avg_opt_cost=1607611.0333, epoch=20.0000, train_loss=0.0029, val_loss=0.0073] 21%|██        | 21/100 [21:49<1:17:31, 58.87s/it, avg_corr=0.8855, avg_corr_cosin=0.9782, avg_gap=20.1364, avg_init_cost=1938313.3333, avg_opt_cost=1607611.0333, epoch=21.0000, train_loss=0.0033, val_loss=0.0073] 22%|██▏       | 22/100 [21:49<1:17:22, 59.51s/it, avg_corr=0.8855, avg_corr_cosin=0.9782, avg_gap=20.1364, avg_init_cost=1938313.3333, avg_opt_cost=1607611.0333, epoch=21.0000, train_loss=0.0033, val_loss=0.0073] 22%|██▏       | 22/100 [22:47<1:17:22, 59.51s/it, avg_corr=0.9019, avg_corr_cosin=0.9829, avg_gap=15.6184, avg_init_cost=1859668.8667, avg_opt_cost=1607611.0333, epoch=22.0000, train_loss=0.0030, val_loss=0.0032] 23%|██▎       | 23/100 [22:47<1:15:44, 59.02s/it, avg_corr=0.9019, avg_corr_cosin=0.9829, avg_gap=15.6184, avg_init_cost=1859668.8667, avg_opt_cost=1607611.0333, epoch=22.0000, train_loss=0.0030, val_loss=0.0032] 23%|██▎       | 23/100 [23:47<1:15:44, 59.02s/it, avg_corr=0.8900, avg_corr_cosin=0.9801, avg_gap=13.9687, avg_init_cost=1835784.2667, avg_opt_cost=1607611.0333, epoch=23.0000, train_loss=0.0032, val_loss=0.0056] 24%|██▍       | 24/100 [23:47<1:14:54, 59.14s/it, avg_corr=0.8900, avg_corr_cosin=0.9801, avg_gap=13.9687, avg_init_cost=1835784.2667, avg_opt_cost=1607611.0333, epoch=23.0000, train_loss=0.0032, val_loss=0.0056] 24%|██▍       | 24/100 [24:45<1:14:54, 59.14s/it, avg_corr=0.8830, avg_corr_cosin=0.9774, avg_gap=14.9749, avg_init_cost=1851849.9000, avg_opt_cost=1607611.0333, epoch=24.0000, train_loss=0.0027, val_loss=0.0046] 25%|██▌       | 25/100 [24:45<1:13:34, 58.86s/it, avg_corr=0.8830, avg_corr_cosin=0.9774, avg_gap=14.9749, avg_init_cost=1851849.9000, avg_opt_cost=1607611.0333, epoch=24.0000, train_loss=0.0027, val_loss=0.0046] 25%|██▌       | 25/100 [25:44<1:13:34, 58.86s/it, avg_corr=0.8899, avg_corr_cosin=0.9806, avg_gap=14.0313, avg_init_cost=1834321.5667, avg_opt_cost=1607611.0333, epoch=25.0000, train_loss=0.0029, val_loss=0.0034] 26%|██▌       | 26/100 [25:44<1:12:38, 58.90s/it, avg_corr=0.8899, avg_corr_cosin=0.9806, avg_gap=14.0313, avg_init_cost=1834321.5667, avg_opt_cost=1607611.0333, epoch=25.0000, train_loss=0.0029, val_loss=0.0034] 26%|██▌       | 26/100 [26:42<1:12:38, 58.90s/it, avg_corr=0.9004, avg_corr_cosin=0.9832, avg_gap=13.9864, avg_init_cost=1833980.6667, avg_opt_cost=1607611.0333, epoch=26.0000, train_loss=0.0029, val_loss=0.0032] 27%|██▋       | 27/100 [26:42<1:11:27, 58.74s/it, avg_corr=0.9004, avg_corr_cosin=0.9832, avg_gap=13.9864, avg_init_cost=1833980.6667, avg_opt_cost=1607611.0333, epoch=26.0000, train_loss=0.0029, val_loss=0.0032] 27%|██▋       | 27/100 [27:43<1:11:27, 58.74s/it, avg_corr=0.8974, avg_corr_cosin=0.9787, avg_gap=18.1877, avg_init_cost=1910979.3333, avg_opt_cost=1607611.0333, epoch=27.0000, train_loss=0.0030, val_loss=0.0030] 28%|██▊       | 28/100 [27:43<1:11:17, 59.41s/it, avg_corr=0.8974, avg_corr_cosin=0.9787, avg_gap=18.1877, avg_init_cost=1910979.3333, avg_opt_cost=1607611.0333, epoch=27.0000, train_loss=0.0030, val_loss=0.0030] 28%|██▊       | 28/100 [28:43<1:11:17, 59.41s/it, avg_corr=0.9026, avg_corr_cosin=0.9824, avg_gap=15.7759, avg_init_cost=1866828.8667, avg_opt_cost=1607611.0333, epoch=28.0000, train_loss=0.0029, val_loss=0.0052] 29%|██▉       | 29/100 [28:43<1:10:29, 59.57s/it, avg_corr=0.9026, avg_corr_cosin=0.9824, avg_gap=15.7759, avg_init_cost=1866828.8667, avg_opt_cost=1607611.0333, epoch=28.0000, train_loss=0.0029, val_loss=0.0052] 29%|██▉       | 29/100 [29:44<1:10:29, 59.57s/it, avg_corr=0.8996, avg_corr_cosin=0.9832, avg_gap=13.0867, avg_init_cost=1820108.0000, avg_opt_cost=1607611.0333, epoch=29.0000, train_loss=0.0029, val_loss=0.0065] 30%|███       | 30/100 [29:44<1:10:06, 60.09s/it, avg_corr=0.8996, avg_corr_cosin=0.9832, avg_gap=13.0867, avg_init_cost=1820108.0000, avg_opt_cost=1607611.0333, epoch=29.0000, train_loss=0.0029, val_loss=0.0065]slurmstepd: error: *** JOB 7885327 ON x1001c7s1b0n1 CANCELLED AT 2024-10-24T00:36:14 ***
