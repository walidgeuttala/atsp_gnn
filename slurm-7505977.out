Namespace(data_dir='../tsp_input/generated_insatnces_3000_size_50/', tb_dir='../atsp_model_train_result', atsp_size=50, to_homo=False, half_st=False, model='HetroGATConcat', input_dim=1, hidden_dim=128, output_dim=1, relation_types='ss st tt pp', n_gnn_layers=4, n_heads=64, jk='cat', lr_init=0.001, lr_decay=0.95, min_delta=0.0001, patience=200, batch_size=15, n_epochs=100, checkpoint_freq=10, seed=4, n_trials=1, n_samples_result_train=30, device='cuda')
Namespace(atsp_size=250, data_path='../tsp_input/generated_insatnces_30_size_250', model_path='../atsp_model_train_result/Oct15_14-45-35_HetroGATConcat_trained_ATSP50/trial_0', time_limit=0.16, perturbation_moves=5, device='cuda')
device = cuda
model: HetroGATConcat trained in ATSP50 for 100 and tested in ATSP250 for 30
  0%|          | 0/30 [00:00<?, ?it/s]  0%|          | 0/30 [00:02<?, ?it/s, Sum_GNN_time:=1.1794, Sum_Search_time:=0.2568, Avg_Gap_init:=13.3989, Avg_Gap_best:=12.1849, Avg_Cost_init:=1.7531, Avg_Cost_best:=1.7344, Avg_Otpimal_best:=1.5460, Avg_counts: =4.0000]  3%|▎         | 1/30 [00:02<01:22,  2.83s/it, Sum_GNN_time:=1.1794, Sum_Search_time:=0.2568, Avg_Gap_init:=13.3989, Avg_Gap_best:=12.1849, Avg_Cost_init:=1.7531, Avg_Cost_best:=1.7344, Avg_Otpimal_best:=1.5460, Avg_counts: =4.0000]  3%|▎         | 1/30 [00:04<01:22,  2.83s/it, Sum_GNN_time:=1.6851, Sum_Search_time:=0.5119, Avg_Gap_init:=12.0556, Avg_Gap_best:=11.1438, Avg_Cost_init:=1.7174, Avg_Cost_best:=1.7034, Avg_Otpimal_best:=1.5325, Avg_counts: =4.0000]  7%|▋         | 2/30 [00:04<01:05,  2.34s/it, Sum_GNN_time:=1.6851, Sum_Search_time:=0.5119, Avg_Gap_init:=12.0556, Avg_Gap_best:=11.1438, Avg_Cost_init:=1.7174, Avg_Cost_best:=1.7034, Avg_Otpimal_best:=1.5325, Avg_counts: =4.0000]  7%|▋         | 2/30 [00:06<01:05,  2.34s/it, Sum_GNN_time:=2.2076, Sum_Search_time:=0.7677, Avg_Gap_init:=12.0407, Avg_Gap_best:=11.0226, Avg_Cost_init:=1.7741, Avg_Cost_best:=1.7578, Avg_Otpimal_best:=1.5833, Avg_counts: =4.0000] 10%|█         | 3/30 [00:06<00:59,  2.21s/it, Sum_GNN_time:=2.2076, Sum_Search_time:=0.7677, Avg_Gap_init:=12.0407, Avg_Gap_best:=11.0226, Avg_Cost_init:=1.7741, Avg_Cost_best:=1.7578, Avg_Otpimal_best:=1.5833, Avg_counts: =4.0000] 10%|█         | 3/30 [00:08<00:59,  2.21s/it, Sum_GNN_time:=2.7442, Sum_Search_time:=1.0240, Avg_Gap_init:=12.2761, Avg_Gap_best:=11.2316, Avg_Cost_init:=1.7888, Avg_Cost_best:=1.7721, Avg_Otpimal_best:=1.5931, Avg_counts: =4.0000] 13%|█▎        | 4/30 [00:08<00:56,  2.16s/it, Sum_GNN_time:=2.7442, Sum_Search_time:=1.0240, Avg_Gap_init:=12.2761, Avg_Gap_best:=11.2316, Avg_Cost_init:=1.7888, Avg_Cost_best:=1.7721, Avg_Otpimal_best:=1.5931, Avg_counts: =4.0000] 13%|█▎        | 4/30 [00:11<00:56,  2.16s/it, Sum_GNN_time:=3.2549, Sum_Search_time:=1.2799, Avg_Gap_init:=13.1449, Avg_Gap_best:=12.1598, Avg_Cost_init:=1.7930, Avg_Cost_best:=1.7772, Avg_Otpimal_best:=1.5848, Avg_counts: =4.0000] 17%|█▋        | 5/30 [00:11<00:53,  2.12s/it, Sum_GNN_time:=3.2549, Sum_Search_time:=1.2799, Avg_Gap_init:=13.1449, Avg_Gap_best:=12.1598, Avg_Cost_init:=1.7930, Avg_Cost_best:=1.7772, Avg_Otpimal_best:=1.5848, Avg_counts: =4.0000] 17%|█▋        | 5/30 [00:12<00:53,  2.12s/it, Sum_GNN_time:=3.7645, Sum_Search_time:=1.5388, Avg_Gap_init:=13.3826, Avg_Gap_best:=12.4565, Avg_Cost_init:=1.7870, Avg_Cost_best:=1.7723, Avg_Otpimal_best:=1.5763, Avg_counts: =4.0000] 20%|██        | 6/30 [00:12<00:49,  2.06s/it, Sum_GNN_time:=3.7645, Sum_Search_time:=1.5388, Avg_Gap_init:=13.3826, Avg_Gap_best:=12.4565, Avg_Cost_init:=1.7870, Avg_Cost_best:=1.7723, Avg_Otpimal_best:=1.5763, Avg_counts: =4.0000] 20%|██        | 6/30 [00:15<00:49,  2.06s/it, Sum_GNN_time:=4.2794, Sum_Search_time:=1.8002, Avg_Gap_init:=13.5334, Avg_Gap_best:=12.6569, Avg_Cost_init:=1.8004, Avg_Cost_best:=1.7864, Avg_Otpimal_best:=1.5859, Avg_counts: =4.0000] 23%|██▎       | 7/30 [00:15<00:47,  2.07s/it, Sum_GNN_time:=4.2794, Sum_Search_time:=1.8002, Avg_Gap_init:=13.5334, Avg_Gap_best:=12.6569, Avg_Cost_init:=1.8004, Avg_Cost_best:=1.7864, Avg_Otpimal_best:=1.5859, Avg_counts: =4.0000] 23%|██▎       | 7/30 [00:17<00:47,  2.07s/it, Sum_GNN_time:=4.7931, Sum_Search_time:=2.0587, Avg_Gap_init:=13.7029, Avg_Gap_best:=12.5875, Avg_Cost_init:=1.8013, Avg_Cost_best:=1.7836, Avg_Otpimal_best:=1.5843, Avg_counts: =4.0000] 27%|██▋       | 8/30 [00:17<00:45,  2.07s/it, Sum_GNN_time:=4.7931, Sum_Search_time:=2.0587, Avg_Gap_init:=13.7029, Avg_Gap_best:=12.5875, Avg_Cost_init:=1.8013, Avg_Cost_best:=1.7836, Avg_Otpimal_best:=1.5843, Avg_counts: =4.0000] 27%|██▋       | 8/30 [00:19<00:45,  2.07s/it, Sum_GNN_time:=5.3311, Sum_Search_time:=2.3166, Avg_Gap_init:=13.0826, Avg_Gap_best:=11.9702, Avg_Cost_init:=1.7783, Avg_Cost_best:=1.7608, Avg_Otpimal_best:=1.5721, Avg_counts: =4.0000] 30%|███       | 9/30 [00:19<00:43,  2.08s/it, Sum_GNN_time:=5.3311, Sum_Search_time:=2.3166, Avg_Gap_init:=13.0826, Avg_Gap_best:=11.9702, Avg_Cost_init:=1.7783, Avg_Cost_best:=1.7608, Avg_Otpimal_best:=1.5721, Avg_counts: =4.0000] 30%|███       | 9/30 [00:21<00:43,  2.08s/it, Sum_GNN_time:=5.8482, Sum_Search_time:=2.5761, Avg_Gap_init:=13.1946, Avg_Gap_best:=12.0848, Avg_Cost_init:=1.7842, Avg_Cost_best:=1.7666, Avg_Otpimal_best:=1.5758, Avg_counts: =4.0000] 33%|███▎      | 10/30 [00:21<00:41,  2.08s/it, Sum_GNN_time:=5.8482, Sum_Search_time:=2.5761, Avg_Gap_init:=13.1946, Avg_Gap_best:=12.0848, Avg_Cost_init:=1.7842, Avg_Cost_best:=1.7666, Avg_Otpimal_best:=1.5758, Avg_counts: =4.0000] 33%|███▎      | 10/30 [00:23<00:41,  2.08s/it, Sum_GNN_time:=6.3707, Sum_Search_time:=2.8371, Avg_Gap_init:=13.3156, Avg_Gap_best:=12.2336, Avg_Cost_init:=1.7963, Avg_Cost_best:=1.7791, Avg_Otpimal_best:=1.5847, Avg_counts: =4.0000] 37%|███▋      | 11/30 [00:23<00:39,  2.08s/it, Sum_GNN_time:=6.3707, Sum_Search_time:=2.8371, Avg_Gap_init:=13.3156, Avg_Gap_best:=12.2336, Avg_Cost_init:=1.7963, Avg_Cost_best:=1.7791, Avg_Otpimal_best:=1.5847, Avg_counts: =4.0000] 37%|███▋      | 11/30 [00:25<00:39,  2.08s/it, Sum_GNN_time:=6.9038, Sum_Search_time:=3.0969, Avg_Gap_init:=13.3366, Avg_Gap_best:=12.2225, Avg_Cost_init:=1.7888, Avg_Cost_best:=1.7712, Avg_Otpimal_best:=1.5779, Avg_counts: =4.0000] 40%|████      | 12/30 [00:25<00:37,  2.09s/it, Sum_GNN_time:=6.9038, Sum_Search_time:=3.0969, Avg_Gap_init:=13.3366, Avg_Gap_best:=12.2225, Avg_Cost_init:=1.7888, Avg_Cost_best:=1.7712, Avg_Otpimal_best:=1.5779, Avg_counts: =4.0000] 40%|████      | 12/30 [00:27<00:37,  2.09s/it, Sum_GNN_time:=7.4217, Sum_Search_time:=3.3587, Avg_Gap_init:=13.0356, Avg_Gap_best:=11.9112, Avg_Cost_init:=1.7881, Avg_Cost_best:=1.7703, Avg_Otpimal_best:=1.5816, Avg_counts: =4.0000] 43%|████▎     | 13/30 [00:27<00:34,  2.04s/it, Sum_GNN_time:=7.4217, Sum_Search_time:=3.3587, Avg_Gap_init:=13.0356, Avg_Gap_best:=11.9112, Avg_Cost_init:=1.7881, Avg_Cost_best:=1.7703, Avg_Otpimal_best:=1.5816, Avg_counts: =4.0000] 43%|████▎     | 13/30 [00:29<00:34,  2.04s/it, Sum_GNN_time:=7.9500, Sum_Search_time:=3.6227, Avg_Gap_init:=13.0909, Avg_Gap_best:=12.0199, Avg_Cost_init:=1.7991, Avg_Cost_best:=1.7821, Avg_Otpimal_best:=1.5905, Avg_counts: =4.0000] 47%|████▋     | 14/30 [00:29<00:33,  2.07s/it, Sum_GNN_time:=7.9500, Sum_Search_time:=3.6227, Avg_Gap_init:=13.0909, Avg_Gap_best:=12.0199, Avg_Cost_init:=1.7991, Avg_Cost_best:=1.7821, Avg_Otpimal_best:=1.5905, Avg_counts: =4.0000] 47%|████▋     | 14/30 [00:31<00:33,  2.07s/it, Sum_GNN_time:=8.4784, Sum_Search_time:=3.8806, Avg_Gap_init:=13.0367, Avg_Gap_best:=11.9999, Avg_Cost_init:=1.7811, Avg_Cost_best:=1.7648, Avg_Otpimal_best:=1.5753, Avg_counts: =4.0000] 50%|█████     | 15/30 [00:31<00:31,  2.07s/it, Sum_GNN_time:=8.4784, Sum_Search_time:=3.8806, Avg_Gap_init:=13.0367, Avg_Gap_best:=11.9999, Avg_Cost_init:=1.7811, Avg_Cost_best:=1.7648, Avg_Otpimal_best:=1.5753, Avg_counts: =4.0000] 50%|█████     | 15/30 [00:33<00:31,  2.07s/it, Sum_GNN_time:=9.0139, Sum_Search_time:=4.1414, Avg_Gap_init:=12.9653, Avg_Gap_best:=11.9694, Avg_Cost_init:=1.7666, Avg_Cost_best:=1.7509, Avg_Otpimal_best:=1.5633, Avg_counts: =4.0000] 53%|█████▎    | 16/30 [00:33<00:29,  2.08s/it, Sum_GNN_time:=9.0139, Sum_Search_time:=4.1414, Avg_Gap_init:=12.9653, Avg_Gap_best:=11.9694, Avg_Cost_init:=1.7666, Avg_Cost_best:=1.7509, Avg_Otpimal_best:=1.5633, Avg_counts: =4.0000] 53%|█████▎    | 16/30 [00:35<00:29,  2.08s/it, Sum_GNN_time:=9.5301, Sum_Search_time:=4.4004, Avg_Gap_init:=13.0361, Avg_Gap_best:=12.0609, Avg_Cost_init:=1.7733, Avg_Cost_best:=1.7580, Avg_Otpimal_best:=1.5683, Avg_counts: =4.0000] 57%|█████▋    | 17/30 [00:35<00:27,  2.09s/it, Sum_GNN_time:=9.5301, Sum_Search_time:=4.4004, Avg_Gap_init:=13.0361, Avg_Gap_best:=12.0609, Avg_Cost_init:=1.7733, Avg_Cost_best:=1.7580, Avg_Otpimal_best:=1.5683, Avg_counts: =4.0000] 57%|█████▋    | 17/30 [00:37<00:27,  2.09s/it, Sum_GNN_time:=10.0613, Sum_Search_time:=4.6588, Avg_Gap_init:=12.8885, Avg_Gap_best:=11.9420, Avg_Cost_init:=1.7706, Avg_Cost_best:=1.7557, Avg_Otpimal_best:=1.5680, Avg_counts: =4.0000] 60%|██████    | 18/30 [00:37<00:25,  2.09s/it, Sum_GNN_time:=10.0613, Sum_Search_time:=4.6588, Avg_Gap_init:=12.8885, Avg_Gap_best:=11.9420, Avg_Cost_init:=1.7706, Avg_Cost_best:=1.7557, Avg_Otpimal_best:=1.5680, Avg_counts: =4.0000] 60%|██████    | 18/30 [00:39<00:25,  2.09s/it, Sum_GNN_time:=10.5811, Sum_Search_time:=4.9191, Avg_Gap_init:=12.8946, Avg_Gap_best:=11.9441, Avg_Cost_init:=1.7747, Avg_Cost_best:=1.7597, Avg_Otpimal_best:=1.5715, Avg_counts: =4.0000] 63%|██████▎   | 19/30 [00:39<00:22,  2.04s/it, Sum_GNN_time:=10.5811, Sum_Search_time:=4.9191, Avg_Gap_init:=12.8946, Avg_Gap_best:=11.9441, Avg_Cost_init:=1.7747, Avg_Cost_best:=1.7597, Avg_Otpimal_best:=1.5715, Avg_counts: =4.0000] 63%|██████▎   | 19/30 [00:41<00:22,  2.04s/it, Sum_GNN_time:=11.1108, Sum_Search_time:=5.1803, Avg_Gap_init:=12.7620, Avg_Gap_best:=11.8122, Avg_Cost_init:=1.7700, Avg_Cost_best:=1.7551, Avg_Otpimal_best:=1.5692, Avg_counts: =4.0000] 67%|██████▋   | 20/30 [00:41<00:20,  2.07s/it, Sum_GNN_time:=11.1108, Sum_Search_time:=5.1803, Avg_Gap_init:=12.7620, Avg_Gap_best:=11.8122, Avg_Cost_init:=1.7700, Avg_Cost_best:=1.7551, Avg_Otpimal_best:=1.5692, Avg_counts: =4.0000] 67%|██████▋   | 20/30 [00:44<00:20,  2.07s/it, Sum_GNN_time:=11.6331, Sum_Search_time:=5.4409, Avg_Gap_init:=12.7119, Avg_Gap_best:=11.7737, Avg_Cost_init:=1.7658, Avg_Cost_best:=1.7511, Avg_Otpimal_best:=1.5662, Avg_counts: =4.0000] 70%|███████   | 21/30 [00:44<00:18,  2.07s/it, Sum_GNN_time:=11.6331, Sum_Search_time:=5.4409, Avg_Gap_init:=12.7119, Avg_Gap_best:=11.7737, Avg_Cost_init:=1.7658, Avg_Cost_best:=1.7511, Avg_Otpimal_best:=1.5662, Avg_counts: =4.0000] 70%|███████   | 21/30 [00:46<00:18,  2.07s/it, Sum_GNN_time:=12.1723, Sum_Search_time:=5.6991, Avg_Gap_init:=12.7897, Avg_Gap_best:=11.8352, Avg_Cost_init:=1.7713, Avg_Cost_best:=1.7562, Avg_Otpimal_best:=1.5699, Avg_counts: =4.0000] 73%|███████▎  | 22/30 [00:46<00:16,  2.08s/it, Sum_GNN_time:=12.1723, Sum_Search_time:=5.6991, Avg_Gap_init:=12.7897, Avg_Gap_best:=11.8352, Avg_Cost_init:=1.7713, Avg_Cost_best:=1.7562, Avg_Otpimal_best:=1.5699, Avg_counts: =4.0000] 73%|███████▎  | 22/30 [00:48<00:16,  2.08s/it, Sum_GNN_time:=12.6860, Sum_Search_time:=5.9565, Avg_Gap_init:=12.8267, Avg_Gap_best:=11.8632, Avg_Cost_init:=1.7714, Avg_Cost_best:=1.7562, Avg_Otpimal_best:=1.5695, Avg_counts: =4.0000] 77%|███████▋  | 23/30 [00:48<00:14,  2.08s/it, Sum_GNN_time:=12.6860, Sum_Search_time:=5.9565, Avg_Gap_init:=12.8267, Avg_Gap_best:=11.8632, Avg_Cost_init:=1.7714, Avg_Cost_best:=1.7562, Avg_Otpimal_best:=1.5695, Avg_counts: =4.0000] 77%|███████▋  | 23/30 [00:50<00:14,  2.08s/it, Sum_GNN_time:=13.2061, Sum_Search_time:=6.2169, Avg_Gap_init:=12.8676, Avg_Gap_best:=11.9000, Avg_Cost_init:=1.7688, Avg_Cost_best:=1.7536, Avg_Otpimal_best:=1.5667, Avg_counts: =4.0000] 80%|████████  | 24/30 [00:50<00:12,  2.04s/it, Sum_GNN_time:=13.2061, Sum_Search_time:=6.2169, Avg_Gap_init:=12.8676, Avg_Gap_best:=11.9000, Avg_Cost_init:=1.7688, Avg_Cost_best:=1.7536, Avg_Otpimal_best:=1.5667, Avg_counts: =4.0000] 80%|████████  | 24/30 [00:52<00:12,  2.04s/it, Sum_GNN_time:=13.7280, Sum_Search_time:=6.4760, Avg_Gap_init:=12.9678, Avg_Gap_best:=11.9697, Avg_Cost_init:=1.7708, Avg_Cost_best:=1.7551, Avg_Otpimal_best:=1.5671, Avg_counts: =4.0000] 83%|████████▎ | 25/30 [00:52<00:10,  2.06s/it, Sum_GNN_time:=13.7280, Sum_Search_time:=6.4760, Avg_Gap_init:=12.9678, Avg_Gap_best:=11.9697, Avg_Cost_init:=1.7708, Avg_Cost_best:=1.7551, Avg_Otpimal_best:=1.5671, Avg_counts: =4.0000] 83%|████████▎ | 25/30 [00:54<00:10,  2.06s/it, Sum_GNN_time:=14.2670, Sum_Search_time:=6.7353, Avg_Gap_init:=13.0502, Avg_Gap_best:=12.0395, Avg_Cost_init:=1.7719, Avg_Cost_best:=1.7560, Avg_Otpimal_best:=1.5669, Avg_counts: =4.0000] 87%|████████▋ | 26/30 [00:54<00:08,  2.07s/it, Sum_GNN_time:=14.2670, Sum_Search_time:=6.7353, Avg_Gap_init:=13.0502, Avg_Gap_best:=12.0395, Avg_Cost_init:=1.7719, Avg_Cost_best:=1.7560, Avg_Otpimal_best:=1.5669, Avg_counts: =4.0000] 87%|████████▋ | 26/30 [00:56<00:08,  2.07s/it, Sum_GNN_time:=14.8014, Sum_Search_time:=6.9960, Avg_Gap_init:=13.1111, Avg_Gap_best:=12.0999, Avg_Cost_init:=1.7717, Avg_Cost_best:=1.7559, Avg_Otpimal_best:=1.5660, Avg_counts: =4.0000] 90%|█████████ | 27/30 [00:56<00:06,  2.08s/it, Sum_GNN_time:=14.8014, Sum_Search_time:=6.9960, Avg_Gap_init:=13.1111, Avg_Gap_best:=12.0999, Avg_Cost_init:=1.7717, Avg_Cost_best:=1.7559, Avg_Otpimal_best:=1.5660, Avg_counts: =4.0000] 90%|█████████ | 27/30 [00:58<00:06,  2.08s/it, Sum_GNN_time:=15.3175, Sum_Search_time:=7.2567, Avg_Gap_init:=13.1716, Avg_Gap_best:=12.1778, Avg_Cost_init:=1.7720, Avg_Cost_best:=1.7564, Avg_Otpimal_best:=1.5654, Avg_counts: =4.0000] 93%|█████████▎| 28/30 [00:58<00:04,  2.08s/it, Sum_GNN_time:=15.3175, Sum_Search_time:=7.2567, Avg_Gap_init:=13.1716, Avg_Gap_best:=12.1778, Avg_Cost_init:=1.7720, Avg_Cost_best:=1.7564, Avg_Otpimal_best:=1.5654, Avg_counts: =4.0000] 93%|█████████▎| 28/30 [01:00<00:04,  2.08s/it, Sum_GNN_time:=15.8449, Sum_Search_time:=7.5063, Avg_Gap_init:=13.0039, Avg_Gap_best:=12.0027, Avg_Cost_init:=1.7660, Avg_Cost_best:=1.7503, Avg_Otpimal_best:=1.5623, Avg_counts: =4.0000] 97%|█████████▋| 29/30 [01:00<00:02,  2.09s/it, Sum_GNN_time:=15.8449, Sum_Search_time:=7.5063, Avg_Gap_init:=13.0039, Avg_Gap_best:=12.0027, Avg_Cost_init:=1.7660, Avg_Cost_best:=1.7503, Avg_Otpimal_best:=1.5623, Avg_counts: =4.0000] 97%|█████████▋| 29/30 [01:02<00:02,  2.09s/it, Sum_GNN_time:=16.3446, Sum_Search_time:=7.7547, Avg_Gap_init:=13.0372, Avg_Gap_best:=12.0051, Avg_Cost_init:=1.7663, Avg_Cost_best:=1.7502, Avg_Otpimal_best:=1.5621, Avg_counts: =4.0000]100%|██████████| 30/30 [01:02<00:00,  2.08s/it, Sum_GNN_time:=16.3446, Sum_Search_time:=7.7547, Avg_Gap_init:=13.0372, Avg_Gap_best:=12.0051, Avg_Cost_init:=1.7663, Avg_Cost_best:=1.7502, Avg_Otpimal_best:=1.5621, Avg_counts: =4.0000]100%|██████████| 30/30 [01:02<00:00,  2.09s/it, Sum_GNN_time:=16.3446, Sum_Search_time:=7.7547, Avg_Gap_init:=13.0372, Avg_Gap_best:=12.0051, Avg_Cost_init:=1.7663, Avg_Cost_best:=1.7502, Avg_Otpimal_best:=1.5621, Avg_counts: =4.0000]
Total time for model prediction: 16.3446 seconds
Total time for guided local search: 7.7547 seconds
