Namespace(data_dir='../tsp_input/generated_insatnces_3000_size_50/', tb_dir='../atsp_model_train_result', atsp_size=50, to_homo=False, half_st=True, model='HetroGATSum', input_dim=1, hidden_dim=128, output_dim=1, relation_types='ss st tt pp', n_gnn_layers=4, n_heads=64, jk='cat', lr_init=0.001, lr_decay=0.95, min_delta=0.0001, patience=200, batch_size=15, n_epochs=100, checkpoint_freq=10, seed=4, n_trials=1, n_samples_result_train=30, device='cuda')
Namespace(atsp_size=100, data_path='../tsp_input/generated_insatnces_30_size_100', model_path='../atsp_model_train_result/Oct15_17-28-42_HetroGATSum_trained_ATSP50/trial_0', time_limit=0.16, perturbation_moves=5, device='cuda')
device = cuda
model: HetroGATSum trained in ATSP50 for 100 and tested in ATSP100 for 30
  0%|          | 0/30 [00:00<?, ?it/s]  0%|          | 0/30 [00:08<?, ?it/s, Sum_GNN_time:=5.5870, Sum_Search_time:=0.1738, Avg_Gap_init:=23.1601, Avg_Gap_best:=17.5534, Avg_Cost_init:=1.9721, Avg_Cost_best:=1.8823, Avg_Otpimal_best:=1.6012, Avg_counts: =24.0000]  3%|▎         | 1/30 [00:08<03:56,  8.17s/it, Sum_GNN_time:=5.5870, Sum_Search_time:=0.1738, Avg_Gap_init:=23.1601, Avg_Gap_best:=17.5534, Avg_Cost_init:=1.9721, Avg_Cost_best:=1.8823, Avg_Otpimal_best:=1.6012, Avg_counts: =24.0000]  3%|▎         | 1/30 [00:08<03:56,  8.17s/it, Sum_GNN_time:=5.6378, Sum_Search_time:=0.3401, Avg_Gap_init:=18.6233, Avg_Gap_best:=14.4455, Avg_Cost_init:=1.9389, Avg_Cost_best:=1.8711, Avg_Otpimal_best:=1.6358, Avg_counts: =21.0000]  7%|▋         | 2/30 [00:08<01:41,  3.63s/it, Sum_GNN_time:=5.6378, Sum_Search_time:=0.3401, Avg_Gap_init:=18.6233, Avg_Gap_best:=14.4455, Avg_Cost_init:=1.9389, Avg_Cost_best:=1.8711, Avg_Otpimal_best:=1.6358, Avg_counts: =21.0000]  7%|▋         | 2/30 [00:09<01:41,  3.63s/it, Sum_GNN_time:=5.6888, Sum_Search_time:=0.5044, Avg_Gap_init:=19.6215, Avg_Gap_best:=13.8038, Avg_Cost_init:=1.8737, Avg_Cost_best:=1.7850, Avg_Otpimal_best:=1.5684, Avg_counts: =20.0000] 10%|█         | 3/30 [00:09<00:57,  2.15s/it, Sum_GNN_time:=5.6888, Sum_Search_time:=0.5044, Avg_Gap_init:=19.6215, Avg_Gap_best:=13.8038, Avg_Cost_init:=1.8737, Avg_Cost_best:=1.7850, Avg_Otpimal_best:=1.5684, Avg_counts: =20.0000] 10%|█         | 3/30 [00:09<00:57,  2.15s/it, Sum_GNN_time:=5.7399, Sum_Search_time:=0.6915, Avg_Gap_init:=16.7484, Avg_Gap_best:=12.0529, Avg_Cost_init:=1.8050, Avg_Cost_best:=1.7336, Avg_Otpimal_best:=1.5460, Avg_counts: =20.0000] 13%|█▎        | 4/30 [00:09<00:38,  1.47s/it, Sum_GNN_time:=5.7399, Sum_Search_time:=0.6915, Avg_Gap_init:=16.7484, Avg_Gap_best:=12.0529, Avg_Cost_init:=1.8050, Avg_Cost_best:=1.7336, Avg_Otpimal_best:=1.5460, Avg_counts: =20.0000] 13%|█▎        | 4/30 [00:09<00:38,  1.47s/it, Sum_GNN_time:=5.7955, Sum_Search_time:=0.8565, Avg_Gap_init:=16.9982, Avg_Gap_best:=12.5436, Avg_Cost_init:=1.7891, Avg_Cost_best:=1.7217, Avg_Otpimal_best:=1.5292, Avg_counts: =20.0000] 17%|█▋        | 5/30 [00:09<00:27,  1.11s/it, Sum_GNN_time:=5.7955, Sum_Search_time:=0.8565, Avg_Gap_init:=16.9982, Avg_Gap_best:=12.5436, Avg_Cost_init:=1.7891, Avg_Cost_best:=1.7217, Avg_Otpimal_best:=1.5292, Avg_counts: =20.0000] 17%|█▋        | 5/30 [00:10<00:27,  1.11s/it, Sum_GNN_time:=5.8505, Sum_Search_time:=1.0199, Avg_Gap_init:=16.6981, Avg_Gap_best:=12.0151, Avg_Cost_init:=1.8045, Avg_Cost_best:=1.7325, Avg_Otpimal_best:=1.5465, Avg_counts: =20.0000] 20%|██        | 6/30 [00:10<00:20,  1.15it/s, Sum_GNN_time:=5.8505, Sum_Search_time:=1.0199, Avg_Gap_init:=16.6981, Avg_Gap_best:=12.0151, Avg_Cost_init:=1.8045, Avg_Cost_best:=1.7325, Avg_Otpimal_best:=1.5465, Avg_counts: =20.0000] 20%|██        | 6/30 [00:10<00:20,  1.15it/s, Sum_GNN_time:=5.9064, Sum_Search_time:=1.2006, Avg_Gap_init:=16.3264, Avg_Gap_best:=11.7086, Avg_Cost_init:=1.8284, Avg_Cost_best:=1.7562, Avg_Otpimal_best:=1.5725, Avg_counts: =19.7143] 23%|██▎       | 7/30 [00:10<00:16,  1.39it/s, Sum_GNN_time:=5.9064, Sum_Search_time:=1.2006, Avg_Gap_init:=16.3264, Avg_Gap_best:=11.7086, Avg_Cost_init:=1.8284, Avg_Cost_best:=1.7562, Avg_Otpimal_best:=1.5725, Avg_counts: =19.7143] 23%|██▎       | 7/30 [00:11<00:16,  1.39it/s, Sum_GNN_time:=5.9577, Sum_Search_time:=1.3800, Avg_Gap_init:=15.6895, Avg_Gap_best:=11.0628, Avg_Cost_init:=1.8608, Avg_Cost_best:=1.7867, Avg_Otpimal_best:=1.6105, Avg_counts: =20.2500] 27%|██▋       | 8/30 [00:11<00:13,  1.62it/s, Sum_GNN_time:=5.9577, Sum_Search_time:=1.3800, Avg_Gap_init:=15.6895, Avg_Gap_best:=11.0628, Avg_Cost_init:=1.8608, Avg_Cost_best:=1.7867, Avg_Otpimal_best:=1.6105, Avg_counts: =20.2500] 27%|██▋       | 8/30 [00:11<00:13,  1.62it/s, Sum_GNN_time:=6.0085, Sum_Search_time:=1.5401, Avg_Gap_init:=15.6491, Avg_Gap_best:=11.1220, Avg_Cost_init:=1.8532, Avg_Cost_best:=1.7808, Avg_Otpimal_best:=1.6043, Avg_counts: =19.5556] 30%|███       | 9/30 [00:11<00:11,  1.84it/s, Sum_GNN_time:=6.0085, Sum_Search_time:=1.5401, Avg_Gap_init:=15.6491, Avg_Gap_best:=11.1220, Avg_Cost_init:=1.8532, Avg_Cost_best:=1.7808, Avg_Otpimal_best:=1.6043, Avg_counts: =19.5556] 30%|███       | 9/30 [00:11<00:11,  1.84it/s, Sum_GNN_time:=6.0596, Sum_Search_time:=1.7007, Avg_Gap_init:=15.7151, Avg_Gap_best:=11.1027, Avg_Cost_init:=1.8660, Avg_Cost_best:=1.7918, Avg_Otpimal_best:=1.6142, Avg_counts: =19.2000] 33%|███▎      | 10/30 [00:11<00:10,  1.93it/s, Sum_GNN_time:=6.0596, Sum_Search_time:=1.7007, Avg_Gap_init:=15.7151, Avg_Gap_best:=11.1027, Avg_Cost_init:=1.8660, Avg_Cost_best:=1.7918, Avg_Otpimal_best:=1.6142, Avg_counts: =19.2000] 33%|███▎      | 10/30 [00:12<00:10,  1.93it/s, Sum_GNN_time:=6.1101, Sum_Search_time:=1.8742, Avg_Gap_init:=15.9565, Avg_Gap_best:=11.2782, Avg_Cost_init:=1.8859, Avg_Cost_best:=1.8099, Avg_Otpimal_best:=1.6276, Avg_counts: =19.6364] 37%|███▋      | 11/30 [00:12<00:09,  2.05it/s, Sum_GNN_time:=6.1101, Sum_Search_time:=1.8742, Avg_Gap_init:=15.9565, Avg_Gap_best:=11.2782, Avg_Cost_init:=1.8859, Avg_Cost_best:=1.8099, Avg_Otpimal_best:=1.6276, Avg_counts: =19.6364] 37%|███▋      | 11/30 [00:12<00:09,  2.05it/s, Sum_GNN_time:=6.1608, Sum_Search_time:=2.0348, Avg_Gap_init:=15.4022, Avg_Gap_best:=11.0717, Avg_Cost_init:=1.8542, Avg_Cost_best:=1.7839, Avg_Otpimal_best:=1.6067, Avg_counts: =19.5000] 40%|████      | 12/30 [00:12<00:08,  2.18it/s, Sum_GNN_time:=6.1608, Sum_Search_time:=2.0348, Avg_Gap_init:=15.4022, Avg_Gap_best:=11.0717, Avg_Cost_init:=1.8542, Avg_Cost_best:=1.7839, Avg_Otpimal_best:=1.6067, Avg_counts: =19.5000] 40%|████      | 12/30 [00:13<00:08,  2.18it/s, Sum_GNN_time:=6.2125, Sum_Search_time:=2.2081, Avg_Gap_init:=15.7667, Avg_Gap_best:=11.1487, Avg_Cost_init:=1.8484, Avg_Cost_best:=1.7743, Avg_Otpimal_best:=1.5970, Avg_counts: =19.8462] 43%|████▎     | 13/30 [00:13<00:07,  2.25it/s, Sum_GNN_time:=6.2125, Sum_Search_time:=2.2081, Avg_Gap_init:=15.7667, Avg_Gap_best:=11.1487, Avg_Cost_init:=1.8484, Avg_Cost_best:=1.7743, Avg_Otpimal_best:=1.5970, Avg_counts: =19.8462] 43%|████▎     | 13/30 [00:13<00:07,  2.25it/s, Sum_GNN_time:=6.2643, Sum_Search_time:=2.3815, Avg_Gap_init:=16.0357, Avg_Gap_best:=11.0862, Avg_Cost_init:=1.8539, Avg_Cost_best:=1.7744, Avg_Otpimal_best:=1.5980, Avg_counts: =20.1429] 47%|████▋     | 14/30 [00:13<00:07,  2.20it/s, Sum_GNN_time:=6.2643, Sum_Search_time:=2.3815, Avg_Gap_init:=16.0357, Avg_Gap_best:=11.0862, Avg_Cost_init:=1.8539, Avg_Cost_best:=1.7744, Avg_Otpimal_best:=1.5980, Avg_counts: =20.1429] 47%|████▋     | 14/30 [00:14<00:07,  2.20it/s, Sum_GNN_time:=6.3148, Sum_Search_time:=2.5442, Avg_Gap_init:=15.6789, Avg_Gap_best:=11.0194, Avg_Cost_init:=1.8444, Avg_Cost_best:=1.7696, Avg_Otpimal_best:=1.5945, Avg_counts: =20.0000] 50%|█████     | 15/30 [00:14<00:06,  2.32it/s, Sum_GNN_time:=6.3148, Sum_Search_time:=2.5442, Avg_Gap_init:=15.6789, Avg_Gap_best:=11.0194, Avg_Cost_init:=1.8444, Avg_Cost_best:=1.7696, Avg_Otpimal_best:=1.5945, Avg_counts: =20.0000] 50%|█████     | 15/30 [00:14<00:06,  2.32it/s, Sum_GNN_time:=6.3658, Sum_Search_time:=2.7051, Avg_Gap_init:=15.9867, Avg_Gap_best:=11.3449, Avg_Cost_init:=1.8537, Avg_Cost_best:=1.7791, Avg_Otpimal_best:=1.5982, Avg_counts: =19.6875] 53%|█████▎    | 16/30 [00:14<00:05,  2.41it/s, Sum_GNN_time:=6.3658, Sum_Search_time:=2.7051, Avg_Gap_init:=15.9867, Avg_Gap_best:=11.3449, Avg_Cost_init:=1.8537, Avg_Cost_best:=1.7791, Avg_Otpimal_best:=1.5982, Avg_counts: =19.6875] 53%|█████▎    | 16/30 [00:14<00:05,  2.41it/s, Sum_GNN_time:=6.4173, Sum_Search_time:=2.8804, Avg_Gap_init:=15.7817, Avg_Gap_best:=11.1491, Avg_Cost_init:=1.8532, Avg_Cost_best:=1.7787, Avg_Otpimal_best:=1.6007, Avg_counts: =19.9412] 57%|█████▋    | 17/30 [00:14<00:05,  2.44it/s, Sum_GNN_time:=6.4173, Sum_Search_time:=2.8804, Avg_Gap_init:=15.7817, Avg_Gap_best:=11.1491, Avg_Cost_init:=1.8532, Avg_Cost_best:=1.7787, Avg_Otpimal_best:=1.6007, Avg_counts: =19.9412] 57%|█████▋    | 17/30 [00:15<00:05,  2.44it/s, Sum_GNN_time:=6.4685, Sum_Search_time:=3.0682, Avg_Gap_init:=15.4709, Avg_Gap_best:=10.8649, Avg_Cost_init:=1.8448, Avg_Cost_best:=1.7708, Avg_Otpimal_best:=1.5975, Avg_counts: =20.1667] 60%|██████    | 18/30 [00:15<00:04,  2.42it/s, Sum_GNN_time:=6.4685, Sum_Search_time:=3.0682, Avg_Gap_init:=15.4709, Avg_Gap_best:=10.8649, Avg_Cost_init:=1.8448, Avg_Cost_best:=1.7708, Avg_Otpimal_best:=1.5975, Avg_counts: =20.1667] 60%|██████    | 18/30 [00:15<00:04,  2.42it/s, Sum_GNN_time:=6.5240, Sum_Search_time:=3.2477, Avg_Gap_init:=15.3657, Avg_Gap_best:=10.8222, Avg_Cost_init:=1.8334, Avg_Cost_best:=1.7608, Avg_Otpimal_best:=1.5890, Avg_counts: =20.0526] 63%|██████▎   | 19/30 [00:15<00:04,  2.27it/s, Sum_GNN_time:=6.5240, Sum_Search_time:=3.2477, Avg_Gap_init:=15.3657, Avg_Gap_best:=10.8222, Avg_Cost_init:=1.8334, Avg_Cost_best:=1.7608, Avg_Otpimal_best:=1.5890, Avg_counts: =20.0526] 63%|██████▎   | 19/30 [00:16<00:04,  2.27it/s, Sum_GNN_time:=6.5752, Sum_Search_time:=3.4205, Avg_Gap_init:=15.1508, Avg_Gap_best:=10.5741, Avg_Cost_init:=1.8271, Avg_Cost_best:=1.7541, Avg_Otpimal_best:=1.5864, Avg_counts: =20.2500] 67%|██████▋   | 20/30 [00:16<00:04,  2.35it/s, Sum_GNN_time:=6.5752, Sum_Search_time:=3.4205, Avg_Gap_init:=15.1508, Avg_Gap_best:=10.5741, Avg_Cost_init:=1.8271, Avg_Cost_best:=1.7541, Avg_Otpimal_best:=1.5864, Avg_counts: =20.2500] 67%|██████▋   | 20/30 [00:16<00:04,  2.35it/s, Sum_GNN_time:=6.6262, Sum_Search_time:=3.5940, Avg_Gap_init:=15.3998, Avg_Gap_best:=10.4677, Avg_Cost_init:=1.8150, Avg_Cost_best:=1.7380, Avg_Otpimal_best:=1.5731, Avg_counts: =20.4286] 70%|███████   | 21/30 [00:16<00:03,  2.37it/s, Sum_GNN_time:=6.6262, Sum_Search_time:=3.5940, Avg_Gap_init:=15.3998, Avg_Gap_best:=10.4677, Avg_Cost_init:=1.8150, Avg_Cost_best:=1.7380, Avg_Otpimal_best:=1.5731, Avg_counts: =20.4286] 70%|███████   | 21/30 [00:16<00:03,  2.37it/s, Sum_GNN_time:=6.6770, Sum_Search_time:=3.7549, Avg_Gap_init:=15.3380, Avg_Gap_best:=10.5678, Avg_Cost_init:=1.8220, Avg_Cost_best:=1.7474, Avg_Otpimal_best:=1.5801, Avg_counts: =20.3182] 73%|███████▎  | 22/30 [00:16<00:03,  2.44it/s, Sum_GNN_time:=6.6770, Sum_Search_time:=3.7549, Avg_Gap_init:=15.3380, Avg_Gap_best:=10.5678, Avg_Cost_init:=1.8220, Avg_Cost_best:=1.7474, Avg_Otpimal_best:=1.5801, Avg_counts: =20.3182] 73%|███████▎  | 22/30 [00:17<00:03,  2.44it/s, Sum_GNN_time:=6.7279, Sum_Search_time:=3.9173, Avg_Gap_init:=15.3542, Avg_Gap_best:=10.5824, Avg_Cost_init:=1.8208, Avg_Cost_best:=1.7462, Avg_Otpimal_best:=1.5788, Avg_counts: =20.2174] 77%|███████▋  | 23/30 [00:17<00:02,  2.50it/s, Sum_GNN_time:=6.7279, Sum_Search_time:=3.9173, Avg_Gap_init:=15.3542, Avg_Gap_best:=10.5824, Avg_Cost_init:=1.8208, Avg_Cost_best:=1.7462, Avg_Otpimal_best:=1.5788, Avg_counts: =20.2174] 77%|███████▋  | 23/30 [00:17<00:02,  2.50it/s, Sum_GNN_time:=6.7796, Sum_Search_time:=4.0784, Avg_Gap_init:=15.5501, Avg_Gap_best:=10.8223, Avg_Cost_init:=1.8211, Avg_Cost_best:=1.7473, Avg_Otpimal_best:=1.5765, Avg_counts: =20.1250] 80%|████████  | 24/30 [00:17<00:02,  2.35it/s, Sum_GNN_time:=6.7796, Sum_Search_time:=4.0784, Avg_Gap_init:=15.5501, Avg_Gap_best:=10.8223, Avg_Cost_init:=1.8211, Avg_Cost_best:=1.7473, Avg_Otpimal_best:=1.5765, Avg_counts: =20.1250] 80%|████████  | 24/30 [00:18<00:02,  2.35it/s, Sum_GNN_time:=6.8309, Sum_Search_time:=4.2387, Avg_Gap_init:=15.5747, Avg_Gap_best:=10.9899, Avg_Cost_init:=1.8147, Avg_Cost_best:=1.7432, Avg_Otpimal_best:=1.5706, Avg_counts: =19.9600] 83%|████████▎ | 25/30 [00:18<00:02,  2.39it/s, Sum_GNN_time:=6.8309, Sum_Search_time:=4.2387, Avg_Gap_init:=15.5747, Avg_Gap_best:=10.9899, Avg_Cost_init:=1.8147, Avg_Cost_best:=1.7432, Avg_Otpimal_best:=1.5706, Avg_counts: =19.9600] 83%|████████▎ | 25/30 [00:18<00:02,  2.39it/s, Sum_GNN_time:=6.8818, Sum_Search_time:=4.4047, Avg_Gap_init:=15.4595, Avg_Gap_best:=10.7767, Avg_Cost_init:=1.8085, Avg_Cost_best:=1.7357, Avg_Otpimal_best:=1.5667, Avg_counts: =19.8077] 87%|████████▋ | 26/30 [00:18<00:01,  2.45it/s, Sum_GNN_time:=6.8818, Sum_Search_time:=4.4047, Avg_Gap_init:=15.4595, Avg_Gap_best:=10.7767, Avg_Cost_init:=1.8085, Avg_Cost_best:=1.7357, Avg_Otpimal_best:=1.5667, Avg_counts: =19.8077] 87%|████████▋ | 26/30 [00:18<00:01,  2.45it/s, Sum_GNN_time:=6.9331, Sum_Search_time:=4.5710, Avg_Gap_init:=15.4762, Avg_Gap_best:=10.8089, Avg_Cost_init:=1.8035, Avg_Cost_best:=1.7310, Avg_Otpimal_best:=1.5621, Avg_counts: =19.6667] 90%|█████████ | 27/30 [00:18<00:01,  2.49it/s, Sum_GNN_time:=6.9331, Sum_Search_time:=4.5710, Avg_Gap_init:=15.4762, Avg_Gap_best:=10.8089, Avg_Cost_init:=1.8035, Avg_Cost_best:=1.7310, Avg_Otpimal_best:=1.5621, Avg_counts: =19.6667] 90%|█████████ | 27/30 [00:19<00:01,  2.49it/s, Sum_GNN_time:=6.9847, Sum_Search_time:=4.7337, Avg_Gap_init:=15.5092, Avg_Gap_best:=10.8625, Avg_Cost_init:=1.8022, Avg_Cost_best:=1.7302, Avg_Otpimal_best:=1.5606, Avg_counts: =19.4643] 93%|█████████▎| 28/30 [00:19<00:00,  2.53it/s, Sum_GNN_time:=6.9847, Sum_Search_time:=4.7337, Avg_Gap_init:=15.5092, Avg_Gap_best:=10.8625, Avg_Cost_init:=1.8022, Avg_Cost_best:=1.7302, Avg_Otpimal_best:=1.5606, Avg_counts: =19.4643] 93%|█████████▎| 28/30 [00:19<00:00,  2.53it/s, Sum_GNN_time:=7.0386, Sum_Search_time:=4.8941, Avg_Gap_init:=15.4982, Avg_Gap_best:=10.9381, Avg_Cost_init:=1.8054, Avg_Cost_best:=1.7346, Avg_Otpimal_best:=1.5635, Avg_counts: =19.3793] 97%|█████████▋| 29/30 [00:19<00:00,  2.39it/s, Sum_GNN_time:=7.0386, Sum_Search_time:=4.8941, Avg_Gap_init:=15.4982, Avg_Gap_best:=10.9381, Avg_Cost_init:=1.8054, Avg_Cost_best:=1.7346, Avg_Otpimal_best:=1.5635, Avg_counts: =19.3793] 97%|█████████▋| 29/30 [00:20<00:00,  2.39it/s, Sum_GNN_time:=7.0898, Sum_Search_time:=5.0809, Avg_Gap_init:=15.4408, Avg_Gap_best:=10.8459, Avg_Cost_init:=1.8021, Avg_Cost_best:=1.7309, Avg_Otpimal_best:=1.5613, Avg_counts: =19.5333]100%|██████████| 30/30 [00:20<00:00,  2.39it/s, Sum_GNN_time:=7.0898, Sum_Search_time:=5.0809, Avg_Gap_init:=15.4408, Avg_Gap_best:=10.8459, Avg_Cost_init:=1.8021, Avg_Cost_best:=1.7309, Avg_Otpimal_best:=1.5613, Avg_counts: =19.5333]100%|██████████| 30/30 [00:20<00:00,  1.48it/s, Sum_GNN_time:=7.0898, Sum_Search_time:=5.0809, Avg_Gap_init:=15.4408, Avg_Gap_best:=10.8459, Avg_Cost_init:=1.8021, Avg_Cost_best:=1.7309, Avg_Otpimal_best:=1.5613, Avg_counts: =19.5333]
Total time for model prediction: 7.0898 seconds
Total time for guided local search: 5.0809 seconds
