Namespace(data_dir='../tsp_input/generated_insatnces_3000_size_50/', tb_dir='../atsp_model_train_result', atsp_size=50, to_homo=False, half_st=False, model='HetroGATConcat', input_dim=1, hidden_dim=128, output_dim=1, relation_types='ss st tt pp', n_gnn_layers=4, n_heads=64, jk='cat', lr_init=0.001, lr_decay=0.95, min_delta=0.0001, patience=200, batch_size=15, n_epochs=100, checkpoint_freq=10, seed=4, n_trials=1, n_samples_result_train=30, device='cuda')
Namespace(atsp_size=150, data_path='../tsp_input/generated_insatnces_30_size_150', model_path='../atsp_model_train_result/Oct15_14-45-35_HetroGATConcat_trained_ATSP50/trial_0', time_limit=0.16, perturbation_moves=5, device='cuda')
device = cuda
model: HetroGATConcat trained in ATSP50 for 100 and tested in ATSP150 for 30
  0%|          | 0/30 [00:00<?, ?it/s]  0%|          | 0/30 [00:01<?, ?it/s, Sum_GNN_time:=0.8306, Sum_Search_time:=0.2061, Avg_Gap_init:=11.1742, Avg_Gap_best:=6.9154, Avg_Cost_init:=1.7721, Avg_Cost_best:=1.7042, Avg_Otpimal_best:=1.5940, Avg_counts: =12.0000]  3%|▎         | 1/30 [00:01<00:48,  1.67s/it, Sum_GNN_time:=0.8306, Sum_Search_time:=0.2061, Avg_Gap_init:=11.1742, Avg_Gap_best:=6.9154, Avg_Cost_init:=1.7721, Avg_Cost_best:=1.7042, Avg_Otpimal_best:=1.5940, Avg_counts: =12.0000]  3%|▎         | 1/30 [00:02<00:48,  1.67s/it, Sum_GNN_time:=0.9803, Sum_Search_time:=0.3683, Avg_Gap_init:=13.5617, Avg_Gap_best:=10.5497, Avg_Cost_init:=1.7773, Avg_Cost_best:=1.7298, Avg_Otpimal_best:=1.5656, Avg_counts: =10.0000]  7%|▋         | 2/30 [00:02<00:31,  1.14s/it, Sum_GNN_time:=0.9803, Sum_Search_time:=0.3683, Avg_Gap_init:=13.5617, Avg_Gap_best:=10.5497, Avg_Cost_init:=1.7773, Avg_Cost_best:=1.7298, Avg_Otpimal_best:=1.5656, Avg_counts: =10.0000]  7%|▋         | 2/30 [00:03<00:31,  1.14s/it, Sum_GNN_time:=1.1301, Sum_Search_time:=0.5316, Avg_Gap_init:=13.8367, Avg_Gap_best:=10.8979, Avg_Cost_init:=1.7771, Avg_Cost_best:=1.7310, Avg_Otpimal_best:=1.5615, Avg_counts: =9.3333]  10%|█         | 3/30 [00:03<00:25,  1.05it/s, Sum_GNN_time:=1.1301, Sum_Search_time:=0.5316, Avg_Gap_init:=13.8367, Avg_Gap_best:=10.8979, Avg_Cost_init:=1.7771, Avg_Cost_best:=1.7310, Avg_Otpimal_best:=1.5615, Avg_counts: =9.3333] 10%|█         | 3/30 [00:03<00:25,  1.05it/s, Sum_GNN_time:=1.2811, Sum_Search_time:=0.7285, Avg_Gap_init:=13.8127, Avg_Gap_best:=11.6086, Avg_Cost_init:=1.7487, Avg_Cost_best:=1.7141, Avg_Otpimal_best:=1.5368, Avg_counts: =9.5000] 13%|█▎        | 4/30 [00:03<00:23,  1.11it/s, Sum_GNN_time:=1.2811, Sum_Search_time:=0.7285, Avg_Gap_init:=13.8127, Avg_Gap_best:=11.6086, Avg_Cost_init:=1.7487, Avg_Cost_best:=1.7141, Avg_Otpimal_best:=1.5368, Avg_counts: =9.5000] 13%|█▎        | 4/30 [00:04<00:23,  1.11it/s, Sum_GNN_time:=1.4330, Sum_Search_time:=0.8907, Avg_Gap_init:=14.0566, Avg_Gap_best:=11.4981, Avg_Cost_init:=1.7667, Avg_Cost_best:=1.7263, Avg_Otpimal_best:=1.5491, Avg_counts: =9.2000] 17%|█▋        | 5/30 [00:04<00:20,  1.21it/s, Sum_GNN_time:=1.4330, Sum_Search_time:=0.8907, Avg_Gap_init:=14.0566, Avg_Gap_best:=11.4981, Avg_Cost_init:=1.7667, Avg_Cost_best:=1.7263, Avg_Otpimal_best:=1.5491, Avg_counts: =9.2000] 17%|█▋        | 5/30 [00:05<00:20,  1.21it/s, Sum_GNN_time:=1.5834, Sum_Search_time:=1.0547, Avg_Gap_init:=14.7774, Avg_Gap_best:=12.1880, Avg_Cost_init:=1.8163, Avg_Cost_best:=1.7747, Avg_Otpimal_best:=1.5816, Avg_counts: =9.0000] 20%|██        | 6/30 [00:05<00:19,  1.21it/s, Sum_GNN_time:=1.5834, Sum_Search_time:=1.0547, Avg_Gap_init:=14.7774, Avg_Gap_best:=12.1880, Avg_Cost_init:=1.8163, Avg_Cost_best:=1.7747, Avg_Otpimal_best:=1.5816, Avg_counts: =9.0000] 20%|██        | 6/30 [00:06<00:19,  1.21it/s, Sum_GNN_time:=1.7356, Sum_Search_time:=1.2174, Avg_Gap_init:=14.2626, Avg_Gap_best:=11.6472, Avg_Cost_init:=1.8203, Avg_Cost_best:=1.7780, Avg_Otpimal_best:=1.5926, Avg_counts: =8.8571] 23%|██▎       | 7/30 [00:06<00:18,  1.26it/s, Sum_GNN_time:=1.7356, Sum_Search_time:=1.2174, Avg_Gap_init:=14.2626, Avg_Gap_best:=11.6472, Avg_Cost_init:=1.8203, Avg_Cost_best:=1.7780, Avg_Otpimal_best:=1.5926, Avg_counts: =8.8571] 23%|██▎       | 7/30 [00:06<00:18,  1.26it/s, Sum_GNN_time:=1.8866, Sum_Search_time:=1.3794, Avg_Gap_init:=14.0632, Avg_Gap_best:=11.6619, Avg_Cost_init:=1.8248, Avg_Cost_best:=1.7859, Avg_Otpimal_best:=1.5994, Avg_counts: =8.7500] 27%|██▋       | 8/30 [00:06<00:17,  1.29it/s, Sum_GNN_time:=1.8866, Sum_Search_time:=1.3794, Avg_Gap_init:=14.0632, Avg_Gap_best:=11.6619, Avg_Cost_init:=1.8248, Avg_Cost_best:=1.7859, Avg_Otpimal_best:=1.5994, Avg_counts: =8.7500] 27%|██▋       | 8/30 [00:07<00:17,  1.29it/s, Sum_GNN_time:=2.0387, Sum_Search_time:=1.5432, Avg_Gap_init:=14.2175, Avg_Gap_best:=11.9474, Avg_Cost_init:=1.8129, Avg_Cost_best:=1.7764, Avg_Otpimal_best:=1.5871, Avg_counts: =8.6667] 30%|███       | 9/30 [00:07<00:16,  1.24it/s, Sum_GNN_time:=2.0387, Sum_Search_time:=1.5432, Avg_Gap_init:=14.2175, Avg_Gap_best:=11.9474, Avg_Cost_init:=1.8129, Avg_Cost_best:=1.7764, Avg_Otpimal_best:=1.5871, Avg_counts: =8.6667] 30%|███       | 9/30 [00:08<00:16,  1.24it/s, Sum_GNN_time:=2.1896, Sum_Search_time:=1.7057, Avg_Gap_init:=14.1254, Avg_Gap_best:=11.8276, Avg_Cost_init:=1.8117, Avg_Cost_best:=1.7748, Avg_Otpimal_best:=1.5873, Avg_counts: =8.6000] 33%|███▎      | 10/30 [00:08<00:15,  1.27it/s, Sum_GNN_time:=2.1896, Sum_Search_time:=1.7057, Avg_Gap_init:=14.1254, Avg_Gap_best:=11.8276, Avg_Cost_init:=1.8117, Avg_Cost_best:=1.7748, Avg_Otpimal_best:=1.5873, Avg_counts: =8.6000] 33%|███▎      | 10/30 [00:09<00:15,  1.27it/s, Sum_GNN_time:=2.3404, Sum_Search_time:=1.8684, Avg_Gap_init:=13.9449, Avg_Gap_best:=11.5723, Avg_Cost_init:=1.8015, Avg_Cost_best:=1.7636, Avg_Otpimal_best:=1.5808, Avg_counts: =8.5455] 37%|███▋      | 11/30 [00:09<00:15,  1.25it/s, Sum_GNN_time:=2.3404, Sum_Search_time:=1.8684, Avg_Gap_init:=13.9449, Avg_Gap_best:=11.5723, Avg_Cost_init:=1.8015, Avg_Cost_best:=1.7636, Avg_Otpimal_best:=1.5808, Avg_counts: =8.5455] 37%|███▋      | 11/30 [00:10<00:15,  1.25it/s, Sum_GNN_time:=2.4915, Sum_Search_time:=2.0318, Avg_Gap_init:=13.8724, Avg_Gap_best:=11.3400, Avg_Cost_init:=1.7982, Avg_Cost_best:=1.7579, Avg_Otpimal_best:=1.5789, Avg_counts: =8.5000] 40%|████      | 12/30 [00:10<00:14,  1.28it/s, Sum_GNN_time:=2.4915, Sum_Search_time:=2.0318, Avg_Gap_init:=13.8724, Avg_Gap_best:=11.3400, Avg_Cost_init:=1.7982, Avg_Cost_best:=1.7579, Avg_Otpimal_best:=1.5789, Avg_counts: =8.5000] 40%|████      | 12/30 [00:10<00:14,  1.28it/s, Sum_GNN_time:=2.6426, Sum_Search_time:=2.1940, Avg_Gap_init:=13.9613, Avg_Gap_best:=11.3711, Avg_Cost_init:=1.8009, Avg_Cost_best:=1.7597, Avg_Otpimal_best:=1.5800, Avg_counts: =8.4615] 43%|████▎     | 13/30 [00:10<00:12,  1.31it/s, Sum_GNN_time:=2.6426, Sum_Search_time:=2.1940, Avg_Gap_init:=13.9613, Avg_Gap_best:=11.3711, Avg_Cost_init:=1.8009, Avg_Cost_best:=1.7597, Avg_Otpimal_best:=1.5800, Avg_counts: =8.4615] 43%|████▎     | 13/30 [00:11<00:12,  1.31it/s, Sum_GNN_time:=2.7924, Sum_Search_time:=2.3565, Avg_Gap_init:=13.7253, Avg_Gap_best:=11.1518, Avg_Cost_init:=1.8019, Avg_Cost_best:=1.7609, Avg_Otpimal_best:=1.5843, Avg_counts: =8.4286] 47%|████▋     | 14/30 [00:11<00:12,  1.28it/s, Sum_GNN_time:=2.7924, Sum_Search_time:=2.3565, Avg_Gap_init:=13.7253, Avg_Gap_best:=11.1518, Avg_Cost_init:=1.8019, Avg_Cost_best:=1.7609, Avg_Otpimal_best:=1.5843, Avg_counts: =8.4286] 47%|████▋     | 14/30 [00:12<00:12,  1.28it/s, Sum_GNN_time:=2.9428, Sum_Search_time:=2.5177, Avg_Gap_init:=13.4147, Avg_Gap_best:=10.9649, Avg_Cost_init:=1.7946, Avg_Cost_best:=1.7556, Avg_Otpimal_best:=1.5822, Avg_counts: =8.4000] 50%|█████     | 15/30 [00:12<00:11,  1.32it/s, Sum_GNN_time:=2.9428, Sum_Search_time:=2.5177, Avg_Gap_init:=13.4147, Avg_Gap_best:=10.9649, Avg_Cost_init:=1.7946, Avg_Cost_best:=1.7556, Avg_Otpimal_best:=1.5822, Avg_counts: =8.4000] 50%|█████     | 15/30 [00:13<00:11,  1.32it/s, Sum_GNN_time:=3.0941, Sum_Search_time:=2.6805, Avg_Gap_init:=13.4439, Avg_Gap_best:=11.0518, Avg_Cost_init:=1.8025, Avg_Cost_best:=1.7643, Avg_Otpimal_best:=1.5887, Avg_counts: =8.3750] 53%|█████▎    | 16/30 [00:13<00:10,  1.29it/s, Sum_GNN_time:=3.0941, Sum_Search_time:=2.6805, Avg_Gap_init:=13.4439, Avg_Gap_best:=11.0518, Avg_Cost_init:=1.8025, Avg_Cost_best:=1.7643, Avg_Otpimal_best:=1.5887, Avg_counts: =8.3750] 53%|█████▎    | 16/30 [00:13<00:10,  1.29it/s, Sum_GNN_time:=3.2453, Sum_Search_time:=2.8421, Avg_Gap_init:=13.6536, Avg_Gap_best:=11.1895, Avg_Cost_init:=1.8014, Avg_Cost_best:=1.7622, Avg_Otpimal_best:=1.5849, Avg_counts: =8.3529] 57%|█████▋    | 17/30 [00:13<00:09,  1.33it/s, Sum_GNN_time:=3.2453, Sum_Search_time:=2.8421, Avg_Gap_init:=13.6536, Avg_Gap_best:=11.1895, Avg_Cost_init:=1.8014, Avg_Cost_best:=1.7622, Avg_Otpimal_best:=1.5849, Avg_counts: =8.3529] 57%|█████▋    | 17/30 [00:14<00:09,  1.33it/s, Sum_GNN_time:=3.3951, Sum_Search_time:=3.0055, Avg_Gap_init:=13.5548, Avg_Gap_best:=11.1168, Avg_Cost_init:=1.7962, Avg_Cost_best:=1.7575, Avg_Otpimal_best:=1.5817, Avg_counts: =8.3333] 60%|██████    | 18/30 [00:14<00:09,  1.29it/s, Sum_GNN_time:=3.3951, Sum_Search_time:=3.0055, Avg_Gap_init:=13.5548, Avg_Gap_best:=11.1168, Avg_Cost_init:=1.7962, Avg_Cost_best:=1.7575, Avg_Otpimal_best:=1.5817, Avg_counts: =8.3333] 60%|██████    | 18/30 [00:15<00:09,  1.29it/s, Sum_GNN_time:=3.5447, Sum_Search_time:=3.1665, Avg_Gap_init:=13.3347, Avg_Gap_best:=10.9315, Avg_Cost_init:=1.8001, Avg_Cost_best:=1.7618, Avg_Otpimal_best:=1.5885, Avg_counts: =8.3158] 63%|██████▎   | 19/30 [00:15<00:08,  1.33it/s, Sum_GNN_time:=3.5447, Sum_Search_time:=3.1665, Avg_Gap_init:=13.3347, Avg_Gap_best:=10.9315, Avg_Cost_init:=1.8001, Avg_Cost_best:=1.7618, Avg_Otpimal_best:=1.5885, Avg_counts: =8.3158] 63%|██████▎   | 19/30 [00:16<00:08,  1.33it/s, Sum_GNN_time:=3.6947, Sum_Search_time:=3.3287, Avg_Gap_init:=13.2888, Avg_Gap_best:=11.0043, Avg_Cost_init:=1.7989, Avg_Cost_best:=1.7625, Avg_Otpimal_best:=1.5880, Avg_counts: =8.3000] 67%|██████▋   | 20/30 [00:16<00:07,  1.36it/s, Sum_GNN_time:=3.6947, Sum_Search_time:=3.3287, Avg_Gap_init:=13.2888, Avg_Gap_best:=11.0043, Avg_Cost_init:=1.7989, Avg_Cost_best:=1.7625, Avg_Otpimal_best:=1.5880, Avg_counts: =8.3000] 67%|██████▋   | 20/30 [00:16<00:07,  1.36it/s, Sum_GNN_time:=3.8458, Sum_Search_time:=3.4917, Avg_Gap_init:=13.2807, Avg_Gap_best:=10.9693, Avg_Cost_init:=1.7968, Avg_Cost_best:=1.7600, Avg_Otpimal_best:=1.5862, Avg_counts: =8.2857] 70%|███████   | 21/30 [00:16<00:06,  1.31it/s, Sum_GNN_time:=3.8458, Sum_Search_time:=3.4917, Avg_Gap_init:=13.2807, Avg_Gap_best:=10.9693, Avg_Cost_init:=1.7968, Avg_Cost_best:=1.7600, Avg_Otpimal_best:=1.5862, Avg_counts: =8.2857] 70%|███████   | 21/30 [00:17<00:06,  1.31it/s, Sum_GNN_time:=3.9957, Sum_Search_time:=3.6532, Avg_Gap_init:=13.2802, Avg_Gap_best:=10.9724, Avg_Cost_init:=1.7951, Avg_Cost_best:=1.7584, Avg_Otpimal_best:=1.5848, Avg_counts: =8.2727] 73%|███████▎  | 22/30 [00:17<00:06,  1.33it/s, Sum_GNN_time:=3.9957, Sum_Search_time:=3.6532, Avg_Gap_init:=13.2802, Avg_Gap_best:=10.9724, Avg_Cost_init:=1.7951, Avg_Cost_best:=1.7584, Avg_Otpimal_best:=1.5848, Avg_counts: =8.2727] 73%|███████▎  | 22/30 [00:18<00:06,  1.33it/s, Sum_GNN_time:=4.1465, Sum_Search_time:=3.8164, Avg_Gap_init:=13.5131, Avg_Gap_best:=11.1169, Avg_Cost_init:=1.8052, Avg_Cost_best:=1.7669, Avg_Otpimal_best:=1.5902, Avg_counts: =8.2609] 77%|███████▋  | 23/30 [00:18<00:05,  1.30it/s, Sum_GNN_time:=4.1465, Sum_Search_time:=3.8164, Avg_Gap_init:=13.5131, Avg_Gap_best:=11.1169, Avg_Cost_init:=1.8052, Avg_Cost_best:=1.7669, Avg_Otpimal_best:=1.5902, Avg_counts: =8.2609] 77%|███████▋  | 23/30 [00:19<00:05,  1.30it/s, Sum_GNN_time:=4.2976, Sum_Search_time:=3.9800, Avg_Gap_init:=13.5200, Avg_Gap_best:=11.1446, Avg_Cost_init:=1.8110, Avg_Cost_best:=1.7730, Avg_Otpimal_best:=1.5952, Avg_counts: =8.2500] 80%|████████  | 24/30 [00:19<00:04,  1.34it/s, Sum_GNN_time:=4.2976, Sum_Search_time:=3.9800, Avg_Gap_init:=13.5200, Avg_Gap_best:=11.1446, Avg_Cost_init:=1.8110, Avg_Cost_best:=1.7730, Avg_Otpimal_best:=1.5952, Avg_counts: =8.2500] 80%|████████  | 24/30 [00:19<00:04,  1.34it/s, Sum_GNN_time:=4.4485, Sum_Search_time:=4.1428, Avg_Gap_init:=13.4501, Avg_Gap_best:=11.1013, Avg_Cost_init:=1.8142, Avg_Cost_best:=1.7765, Avg_Otpimal_best:=1.5991, Avg_counts: =8.2400] 83%|████████▎ | 25/30 [00:19<00:03,  1.36it/s, Sum_GNN_time:=4.4485, Sum_Search_time:=4.1428, Avg_Gap_init:=13.4501, Avg_Gap_best:=11.1013, Avg_Cost_init:=1.8142, Avg_Cost_best:=1.7765, Avg_Otpimal_best:=1.5991, Avg_counts: =8.2400] 83%|████████▎ | 25/30 [00:20<00:03,  1.36it/s, Sum_GNN_time:=4.5989, Sum_Search_time:=4.3046, Avg_Gap_init:=13.4570, Avg_Gap_best:=11.0839, Avg_Cost_init:=1.8144, Avg_Cost_best:=1.7763, Avg_Otpimal_best:=1.5991, Avg_counts: =8.2308] 87%|████████▋ | 26/30 [00:20<00:03,  1.31it/s, Sum_GNN_time:=4.5989, Sum_Search_time:=4.3046, Avg_Gap_init:=13.4570, Avg_Gap_best:=11.0839, Avg_Cost_init:=1.8144, Avg_Cost_best:=1.7763, Avg_Otpimal_best:=1.5991, Avg_counts: =8.2308] 87%|████████▋ | 26/30 [00:21<00:03,  1.31it/s, Sum_GNN_time:=4.7497, Sum_Search_time:=4.4676, Avg_Gap_init:=13.3883, Avg_Gap_best:=10.9604, Avg_Cost_init:=1.8127, Avg_Cost_best:=1.7738, Avg_Otpimal_best:=1.5986, Avg_counts: =8.2222] 90%|█████████ | 27/30 [00:21<00:02,  1.34it/s, Sum_GNN_time:=4.7497, Sum_Search_time:=4.4676, Avg_Gap_init:=13.3883, Avg_Gap_best:=10.9604, Avg_Cost_init:=1.8127, Avg_Cost_best:=1.7738, Avg_Otpimal_best:=1.5986, Avg_counts: =8.2222] 90%|█████████ | 27/30 [00:22<00:02,  1.34it/s, Sum_GNN_time:=4.9007, Sum_Search_time:=4.6290, Avg_Gap_init:=13.3642, Avg_Gap_best:=10.9762, Avg_Cost_init:=1.8133, Avg_Cost_best:=1.7750, Avg_Otpimal_best:=1.5994, Avg_counts: =8.2143] 93%|█████████▎| 28/30 [00:22<00:01,  1.31it/s, Sum_GNN_time:=4.9007, Sum_Search_time:=4.6290, Avg_Gap_init:=13.3642, Avg_Gap_best:=10.9762, Avg_Cost_init:=1.8133, Avg_Cost_best:=1.7750, Avg_Otpimal_best:=1.5994, Avg_counts: =8.2143] 93%|█████████▎| 28/30 [00:22<00:01,  1.31it/s, Sum_GNN_time:=5.0520, Sum_Search_time:=4.7908, Avg_Gap_init:=13.2845, Avg_Gap_best:=10.9662, Avg_Cost_init:=1.8162, Avg_Cost_best:=1.7790, Avg_Otpimal_best:=1.6032, Avg_counts: =8.2069] 97%|█████████▋| 29/30 [00:22<00:00,  1.34it/s, Sum_GNN_time:=5.0520, Sum_Search_time:=4.7908, Avg_Gap_init:=13.2845, Avg_Gap_best:=10.9662, Avg_Cost_init:=1.8162, Avg_Cost_best:=1.7790, Avg_Otpimal_best:=1.6032, Avg_counts: =8.2069] 97%|█████████▋| 29/30 [00:23<00:00,  1.34it/s, Sum_GNN_time:=5.2014, Sum_Search_time:=4.9528, Avg_Gap_init:=13.0941, Avg_Gap_best:=10.8428, Avg_Cost_init:=1.8133, Avg_Cost_best:=1.7772, Avg_Otpimal_best:=1.6034, Avg_counts: =8.2000]100%|██████████| 30/30 [00:23<00:00,  1.31it/s, Sum_GNN_time:=5.2014, Sum_Search_time:=4.9528, Avg_Gap_init:=13.0941, Avg_Gap_best:=10.8428, Avg_Cost_init:=1.8133, Avg_Cost_best:=1.7772, Avg_Otpimal_best:=1.6034, Avg_counts: =8.2000]100%|██████████| 30/30 [00:23<00:00,  1.26it/s, Sum_GNN_time:=5.2014, Sum_Search_time:=4.9528, Avg_Gap_init:=13.0941, Avg_Gap_best:=10.8428, Avg_Cost_init:=1.8133, Avg_Cost_best:=1.7772, Avg_Otpimal_best:=1.6034, Avg_counts: =8.2000]
Total time for model prediction: 5.2014 seconds
Total time for guided local search: 4.9528 seconds
