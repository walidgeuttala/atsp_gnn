/project/c_gnn_001/conda_envs/cuda121/lib/python3.11/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator MinMaxScaler from version 1.3.0 when using version 1.5.2. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(
Namespace(data_dir='../tsp_input/generated_insatnces_3000_size_50/', tb_dir='../atsp_model_train_result', atsp_size=50, to_homo=False, half_st=False, model='HetroGATSum', input_dim=1, hidden_dim=128, output_dim=1, relation_types='ss tt pp', n_gnn_layers=4, n_heads=64, jk='cat', lr_init=0.001, lr_decay=0.95, min_delta=0.0001, patience=200, batch_size=15, n_epochs=100, checkpoint_freq=10, seed=4, n_trials=1, n_samples_result_train=30, device='cuda')
device = cuda
  0%|          | 0/100 [00:00<?, ?it/s]  0%|          | 0/100 [00:37<?, ?it/s, avg_corr=0.3250, avg_corr_cosin=0.9200, avg_gap=93.0416, avg_init_cost=3096634.0000, avg_opt_cost=1607611.0333, epoch=0.0000, train_loss=0.0198, val_loss=0.0132]  1%|          | 1/100 [00:38<1:02:52, 38.11s/it, avg_corr=0.3250, avg_corr_cosin=0.9200, avg_gap=93.0416, avg_init_cost=3096634.0000, avg_opt_cost=1607611.0333, epoch=0.0000, train_loss=0.0198, val_loss=0.0132]  1%|          | 1/100 [01:07<1:02:52, 38.11s/it, avg_corr=0.3145, avg_corr_cosin=0.9173, avg_gap=70.3133, avg_init_cost=2736999.0000, avg_opt_cost=1607611.0333, epoch=1.0000, train_loss=0.0136, val_loss=0.0129]  2%|▏         | 2/100 [01:08<54:29, 33.36s/it, avg_corr=0.3145, avg_corr_cosin=0.9173, avg_gap=70.3133, avg_init_cost=2736999.0000, avg_opt_cost=1607611.0333, epoch=1.0000, train_loss=0.0136, val_loss=0.0129]    2%|▏         | 2/100 [01:37<54:29, 33.36s/it, avg_corr=0.3672, avg_corr_cosin=0.9217, avg_gap=60.1464, avg_init_cost=2575391.4333, avg_opt_cost=1607611.0333, epoch=2.0000, train_loss=0.0125, val_loss=0.0119]  3%|▎         | 3/100 [01:37<50:47, 31.41s/it, avg_corr=0.3672, avg_corr_cosin=0.9217, avg_gap=60.1464, avg_init_cost=2575391.4333, avg_opt_cost=1607611.0333, epoch=2.0000, train_loss=0.0125, val_loss=0.0119]  3%|▎         | 3/100 [02:06<50:47, 31.41s/it, avg_corr=0.3850, avg_corr_cosin=0.9263, avg_gap=55.9202, avg_init_cost=2510879.7000, avg_opt_cost=1607611.0333, epoch=3.0000, train_loss=0.0124, val_loss=0.0166]  4%|▍         | 4/100 [02:06<48:39, 30.41s/it, avg_corr=0.3850, avg_corr_cosin=0.9263, avg_gap=55.9202, avg_init_cost=2510879.7000, avg_opt_cost=1607611.0333, epoch=3.0000, train_loss=0.0124, val_loss=0.0166]  4%|▍         | 4/100 [02:34<48:39, 30.41s/it, avg_corr=0.4117, avg_corr_cosin=0.9285, avg_gap=57.4217, avg_init_cost=2532991.9333, avg_opt_cost=1607611.0333, epoch=4.0000, train_loss=0.0124, val_loss=0.0122]  5%|▌         | 5/100 [02:34<47:11, 29.81s/it, avg_corr=0.4117, avg_corr_cosin=0.9285, avg_gap=57.4217, avg_init_cost=2532991.9333, avg_opt_cost=1607611.0333, epoch=4.0000, train_loss=0.0124, val_loss=0.0122]  5%|▌         | 5/100 [03:03<47:11, 29.81s/it, avg_corr=0.4375, avg_corr_cosin=0.9279, avg_gap=53.1700, avg_init_cost=2460067.0333, avg_opt_cost=1607611.0333, epoch=5.0000, train_loss=0.0119, val_loss=0.0139]  6%|▌         | 6/100 [03:03<45:54, 29.30s/it, avg_corr=0.4375, avg_corr_cosin=0.9279, avg_gap=53.1700, avg_init_cost=2460067.0333, avg_opt_cost=1607611.0333, epoch=5.0000, train_loss=0.0119, val_loss=0.0139]  6%|▌         | 6/100 [03:31<45:54, 29.30s/it, avg_corr=0.4596, avg_corr_cosin=0.9329, avg_gap=51.4257, avg_init_cost=2434833.0333, avg_opt_cost=1607611.0333, epoch=6.0000, train_loss=0.0118, val_loss=0.0155]  7%|▋         | 7/100 [03:31<45:03, 29.07s/it, avg_corr=0.4596, avg_corr_cosin=0.9329, avg_gap=51.4257, avg_init_cost=2434833.0333, avg_opt_cost=1607611.0333, epoch=6.0000, train_loss=0.0118, val_loss=0.0155]  7%|▋         | 7/100 [04:00<45:03, 29.07s/it, avg_corr=0.4766, avg_corr_cosin=0.9335, avg_gap=53.3905, avg_init_cost=2468652.4000, avg_opt_cost=1607611.0333, epoch=7.0000, train_loss=0.0115, val_loss=0.0113]  8%|▊         | 8/100 [04:00<44:16, 28.87s/it, avg_corr=0.4766, avg_corr_cosin=0.9335, avg_gap=53.3905, avg_init_cost=2468652.4000, avg_opt_cost=1607611.0333, epoch=7.0000, train_loss=0.0115, val_loss=0.0113]  8%|▊         | 8/100 [04:27<44:16, 28.87s/it, avg_corr=0.4514, avg_corr_cosin=0.9316, avg_gap=70.1123, avg_init_cost=2729062.9667, avg_opt_cost=1607611.0333, epoch=8.0000, train_loss=0.0112, val_loss=0.0131]  9%|▉         | 9/100 [04:27<43:13, 28.50s/it, avg_corr=0.4514, avg_corr_cosin=0.9316, avg_gap=70.1123, avg_init_cost=2729062.9667, avg_opt_cost=1607611.0333, epoch=8.0000, train_loss=0.0112, val_loss=0.0131]  9%|▉         | 9/100 [04:55<43:13, 28.50s/it, avg_corr=0.4782, avg_corr_cosin=0.9343, avg_gap=59.2571, avg_init_cost=2555193.5333, avg_opt_cost=1607611.0333, epoch=9.0000, train_loss=0.0115, val_loss=0.0174] 10%|█         | 10/100 [04:55<42:20, 28.23s/it, avg_corr=0.4782, avg_corr_cosin=0.9343, avg_gap=59.2571, avg_init_cost=2555193.5333, avg_opt_cost=1607611.0333, epoch=9.0000, train_loss=0.0115, val_loss=0.0174] 10%|█         | 10/100 [05:24<42:20, 28.23s/it, avg_corr=0.5023, avg_corr_cosin=0.9358, avg_gap=49.5700, avg_init_cost=2407692.5333, avg_opt_cost=1607611.0333, epoch=10.0000, train_loss=0.0113, val_loss=0.0112] 11%|█         | 11/100 [05:24<42:21, 28.55s/it, avg_corr=0.5023, avg_corr_cosin=0.9358, avg_gap=49.5700, avg_init_cost=2407692.5333, avg_opt_cost=1607611.0333, epoch=10.0000, train_loss=0.0113, val_loss=0.0112] 11%|█         | 11/100 [05:53<42:21, 28.55s/it, avg_corr=0.4830, avg_corr_cosin=0.9344, avg_gap=62.0627, avg_init_cost=2605067.5667, avg_opt_cost=1607611.0333, epoch=11.0000, train_loss=0.0115, val_loss=0.0113] 12%|█▏        | 12/100 [05:53<41:52, 28.55s/it, avg_corr=0.4830, avg_corr_cosin=0.9344, avg_gap=62.0627, avg_init_cost=2605067.5667, avg_opt_cost=1607611.0333, epoch=11.0000, train_loss=0.0115, val_loss=0.0113] 12%|█▏        | 12/100 [06:22<41:52, 28.55s/it, avg_corr=0.4721, avg_corr_cosin=0.9312, avg_gap=42.9438, avg_init_cost=2299174.4333, avg_opt_cost=1607611.0333, epoch=12.0000, train_loss=0.0105, val_loss=0.0118] 13%|█▎        | 13/100 [06:22<41:33, 28.66s/it, avg_corr=0.4721, avg_corr_cosin=0.9312, avg_gap=42.9438, avg_init_cost=2299174.4333, avg_opt_cost=1607611.0333, epoch=12.0000, train_loss=0.0105, val_loss=0.0118] 13%|█▎        | 13/100 [06:51<41:33, 28.66s/it, avg_corr=0.5288, avg_corr_cosin=0.9389, avg_gap=45.7566, avg_init_cost=2342969.4333, avg_opt_cost=1607611.0333, epoch=13.0000, train_loss=0.0109, val_loss=0.0107] 14%|█▍        | 14/100 [06:51<41:15, 28.79s/it, avg_corr=0.5288, avg_corr_cosin=0.9389, avg_gap=45.7566, avg_init_cost=2342969.4333, avg_opt_cost=1607611.0333, epoch=13.0000, train_loss=0.0109, val_loss=0.0107] 14%|█▍        | 14/100 [07:18<41:15, 28.79s/it, avg_corr=0.5195, avg_corr_cosin=0.9381, avg_gap=45.5771, avg_init_cost=2341503.8667, avg_opt_cost=1607611.0333, epoch=14.0000, train_loss=0.0108, val_loss=0.0137] 15%|█▌        | 15/100 [07:18<40:09, 28.34s/it, avg_corr=0.5195, avg_corr_cosin=0.9381, avg_gap=45.5771, avg_init_cost=2341503.8667, avg_opt_cost=1607611.0333, epoch=14.0000, train_loss=0.0108, val_loss=0.0137] 15%|█▌        | 15/100 [07:46<40:09, 28.34s/it, avg_corr=0.5179, avg_corr_cosin=0.9378, avg_gap=43.5385, avg_init_cost=2309400.4333, avg_opt_cost=1607611.0333, epoch=15.0000, train_loss=0.0105, val_loss=0.0117] 16%|█▌        | 16/100 [07:46<39:27, 28.19s/it, avg_corr=0.5179, avg_corr_cosin=0.9378, avg_gap=43.5385, avg_init_cost=2309400.4333, avg_opt_cost=1607611.0333, epoch=15.0000, train_loss=0.0105, val_loss=0.0117] 16%|█▌        | 16/100 [08:13<39:27, 28.19s/it, avg_corr=0.5322, avg_corr_cosin=0.9382, avg_gap=44.9001, avg_init_cost=2328246.3000, avg_opt_cost=1607611.0333, epoch=16.0000, train_loss=0.0103, val_loss=0.0139] 17%|█▋        | 17/100 [08:13<38:38, 27.94s/it, avg_corr=0.5322, avg_corr_cosin=0.9382, avg_gap=44.9001, avg_init_cost=2328246.3000, avg_opt_cost=1607611.0333, epoch=16.0000, train_loss=0.0103, val_loss=0.0139] 17%|█▋        | 17/100 [08:41<38:38, 27.94s/it, avg_corr=0.5287, avg_corr_cosin=0.9387, avg_gap=43.5827, avg_init_cost=2305663.5667, avg_opt_cost=1607611.0333, epoch=17.0000, train_loss=0.0101, val_loss=0.0102] 18%|█▊        | 18/100 [08:41<38:06, 27.89s/it, avg_corr=0.5287, avg_corr_cosin=0.9387, avg_gap=43.5827, avg_init_cost=2305663.5667, avg_opt_cost=1607611.0333, epoch=17.0000, train_loss=0.0101, val_loss=0.0102]slurmstepd: error: *** JOB 8001421 ON x1001c0s3b0n0 CANCELLED AT 2024-10-27T02:33:38 ***
