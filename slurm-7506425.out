Namespace(data_dir='../tsp_input/generated_insatnces_3000_size_50/', tb_dir='../atsp_model_train_result', atsp_size=50, to_homo=False, half_st=False, model='HetroGATConcat', input_dim=1, hidden_dim=128, output_dim=1, relation_types='ss st tt pp', n_gnn_layers=4, n_heads=64, jk='cat', lr_init=0.001, lr_decay=0.95, min_delta=0.0001, patience=200, batch_size=15, n_epochs=100, checkpoint_freq=10, seed=4, n_trials=1, n_samples_result_train=30, device='cuda')
Namespace(atsp_size=100, data_path='../tsp_input/generated_insatnces_30_size_100', model_path='../atsp_model_train_result/Oct15_14-45-35_HetroGATConcat_trained_ATSP50/trial_0', time_limit=0.16, perturbation_moves=5, device='cuda')
device = cuda
model: HetroGATConcat trained in ATSP50 for 100 and tested in ATSP100 for 30
  0%|          | 0/30 [00:00<?, ?it/s]  0%|          | 0/30 [00:01<?, ?it/s, Sum_GNN_time:=0.7634, Sum_Search_time:=0.1798, Avg_Gap_init:=13.5182, Avg_Gap_best:=9.1334, Avg_Cost_init:=1.8177, Avg_Cost_best:=1.7475, Avg_Otpimal_best:=1.6012, Avg_counts: =20.0000]  3%|▎         | 1/30 [00:01<00:37,  1.29s/it, Sum_GNN_time:=0.7634, Sum_Search_time:=0.1798, Avg_Gap_init:=13.5182, Avg_Gap_best:=9.1334, Avg_Cost_init:=1.8177, Avg_Cost_best:=1.7475, Avg_Otpimal_best:=1.6012, Avg_counts: =20.0000]  3%|▎         | 1/30 [00:01<00:37,  1.29s/it, Sum_GNN_time:=0.8188, Sum_Search_time:=0.3623, Avg_Gap_init:=14.3272, Avg_Gap_best:=10.6276, Avg_Cost_init:=1.8705, Avg_Cost_best:=1.8102, Avg_Otpimal_best:=1.6358, Avg_counts: =20.0000]  7%|▋         | 2/30 [00:01<00:22,  1.23it/s, Sum_GNN_time:=0.8188, Sum_Search_time:=0.3623, Avg_Gap_init:=14.3272, Avg_Gap_best:=10.6276, Avg_Cost_init:=1.8705, Avg_Cost_best:=1.8102, Avg_Otpimal_best:=1.6358, Avg_counts: =20.0000]  7%|▋         | 2/30 [00:02<00:22,  1.23it/s, Sum_GNN_time:=0.8747, Sum_Search_time:=0.5561, Avg_Gap_init:=12.8256, Avg_Gap_best:=9.3688, Avg_Cost_init:=1.7717, Avg_Cost_best:=1.7173, Avg_Otpimal_best:=1.5684, Avg_counts: =19.3333]  10%|█         | 3/30 [00:02<00:17,  1.58it/s, Sum_GNN_time:=0.8747, Sum_Search_time:=0.5561, Avg_Gap_init:=12.8256, Avg_Gap_best:=9.3688, Avg_Cost_init:=1.7717, Avg_Cost_best:=1.7173, Avg_Otpimal_best:=1.5684, Avg_counts: =19.3333] 10%|█         | 3/30 [00:02<00:17,  1.58it/s, Sum_GNN_time:=0.9330, Sum_Search_time:=0.7367, Avg_Gap_init:=12.1238, Avg_Gap_best:=8.6971, Avg_Cost_init:=1.7355, Avg_Cost_best:=1.6824, Avg_Otpimal_best:=1.5460, Avg_counts: =19.5000] 13%|█▎        | 4/30 [00:02<00:14,  1.83it/s, Sum_GNN_time:=0.9330, Sum_Search_time:=0.7367, Avg_Gap_init:=12.1238, Avg_Gap_best:=8.6971, Avg_Cost_init:=1.7355, Avg_Cost_best:=1.6824, Avg_Otpimal_best:=1.5460, Avg_counts: =19.5000] 13%|█▎        | 4/30 [00:03<00:14,  1.83it/s, Sum_GNN_time:=0.9925, Sum_Search_time:=0.9222, Avg_Gap_init:=13.7221, Avg_Gap_best:=9.5304, Avg_Cost_init:=1.7397, Avg_Cost_best:=1.6760, Avg_Otpimal_best:=1.5292, Avg_counts: =19.6000] 17%|█▋        | 5/30 [00:03<00:13,  1.89it/s, Sum_GNN_time:=0.9925, Sum_Search_time:=0.9222, Avg_Gap_init:=13.7221, Avg_Gap_best:=9.5304, Avg_Cost_init:=1.7397, Avg_Cost_best:=1.6760, Avg_Otpimal_best:=1.5292, Avg_counts: =19.6000] 17%|█▋        | 5/30 [00:03<00:13,  1.89it/s, Sum_GNN_time:=1.0519, Sum_Search_time:=1.0869, Avg_Gap_init:=13.2874, Avg_Gap_best:=8.8043, Avg_Cost_init:=1.7522, Avg_Cost_best:=1.6829, Avg_Otpimal_best:=1.5465, Avg_counts: =17.6667] 20%|██        | 6/30 [00:03<00:11,  2.07it/s, Sum_GNN_time:=1.0519, Sum_Search_time:=1.0869, Avg_Gap_init:=13.2874, Avg_Gap_best:=8.8043, Avg_Cost_init:=1.7522, Avg_Cost_best:=1.6829, Avg_Otpimal_best:=1.5465, Avg_counts: =17.6667] 20%|██        | 6/30 [00:03<00:11,  2.07it/s, Sum_GNN_time:=1.1107, Sum_Search_time:=1.2503, Avg_Gap_init:=12.8755, Avg_Gap_best:=8.8163, Avg_Cost_init:=1.7744, Avg_Cost_best:=1.7113, Avg_Otpimal_best:=1.5725, Avg_counts: =16.2857] 23%|██▎       | 7/30 [00:03<00:10,  2.19it/s, Sum_GNN_time:=1.1107, Sum_Search_time:=1.2503, Avg_Gap_init:=12.8755, Avg_Gap_best:=8.8163, Avg_Cost_init:=1.7744, Avg_Cost_best:=1.7113, Avg_Otpimal_best:=1.5725, Avg_counts: =16.2857] 23%|██▎       | 7/30 [00:04<00:10,  2.19it/s, Sum_GNN_time:=1.1663, Sum_Search_time:=1.4294, Avg_Gap_init:=13.1325, Avg_Gap_best:=8.9274, Avg_Cost_init:=1.8223, Avg_Cost_best:=1.7548, Avg_Otpimal_best:=1.6105, Avg_counts: =16.7500] 27%|██▋       | 8/30 [00:04<00:09,  2.26it/s, Sum_GNN_time:=1.1663, Sum_Search_time:=1.4294, Avg_Gap_init:=13.1325, Avg_Gap_best:=8.9274, Avg_Cost_init:=1.8223, Avg_Cost_best:=1.7548, Avg_Otpimal_best:=1.6105, Avg_counts: =16.7500] 27%|██▋       | 8/30 [00:04<00:09,  2.26it/s, Sum_GNN_time:=1.2220, Sum_Search_time:=1.5926, Avg_Gap_init:=12.8857, Avg_Gap_best:=8.9256, Avg_Cost_init:=1.8113, Avg_Cost_best:=1.7479, Avg_Otpimal_best:=1.6043, Avg_counts: =16.4444] 30%|███       | 9/30 [00:04<00:08,  2.35it/s, Sum_GNN_time:=1.2220, Sum_Search_time:=1.5926, Avg_Gap_init:=12.8857, Avg_Gap_best:=8.9256, Avg_Cost_init:=1.8113, Avg_Cost_best:=1.7479, Avg_Otpimal_best:=1.6043, Avg_counts: =16.4444] 30%|███       | 9/30 [00:05<00:08,  2.35it/s, Sum_GNN_time:=1.2813, Sum_Search_time:=1.7729, Avg_Gap_init:=12.9012, Avg_Gap_best:=9.0965, Avg_Cost_init:=1.8228, Avg_Cost_best:=1.7616, Avg_Otpimal_best:=1.6142, Avg_counts: =16.8000] 33%|███▎      | 10/30 [00:05<00:09,  2.15it/s, Sum_GNN_time:=1.2813, Sum_Search_time:=1.7729, Avg_Gap_init:=12.9012, Avg_Gap_best:=9.0965, Avg_Cost_init:=1.8228, Avg_Cost_best:=1.7616, Avg_Otpimal_best:=1.6142, Avg_counts: =16.8000] 33%|███▎      | 10/30 [00:05<00:09,  2.15it/s, Sum_GNN_time:=1.3403, Sum_Search_time:=1.9662, Avg_Gap_init:=12.8475, Avg_Gap_best:=9.1680, Avg_Cost_init:=1.8369, Avg_Cost_best:=1.7774, Avg_Otpimal_best:=1.6276, Avg_counts: =17.0909] 37%|███▋      | 11/30 [00:05<00:08,  2.20it/s, Sum_GNN_time:=1.3403, Sum_Search_time:=1.9662, Avg_Gap_init:=12.8475, Avg_Gap_best:=9.1680, Avg_Cost_init:=1.8369, Avg_Cost_best:=1.7774, Avg_Otpimal_best:=1.6276, Avg_counts: =17.0909] 37%|███▋      | 11/30 [00:06<00:08,  2.20it/s, Sum_GNN_time:=1.3970, Sum_Search_time:=2.1355, Avg_Gap_init:=12.2208, Avg_Gap_best:=8.7317, Avg_Cost_init:=1.8047, Avg_Cost_best:=1.7486, Avg_Otpimal_best:=1.6067, Avg_counts: =17.0000] 40%|████      | 12/30 [00:06<00:07,  2.29it/s, Sum_GNN_time:=1.3970, Sum_Search_time:=2.1355, Avg_Gap_init:=12.2208, Avg_Gap_best:=8.7317, Avg_Cost_init:=1.8047, Avg_Cost_best:=1.7486, Avg_Otpimal_best:=1.6067, Avg_counts: =17.0000] 40%|████      | 12/30 [00:06<00:07,  2.29it/s, Sum_GNN_time:=1.4533, Sum_Search_time:=2.3018, Avg_Gap_init:=11.9464, Avg_Gap_best:=8.5974, Avg_Cost_init:=1.7896, Avg_Cost_best:=1.7359, Avg_Otpimal_best:=1.5970, Avg_counts: =16.7692] 43%|████▎     | 13/30 [00:06<00:07,  2.36it/s, Sum_GNN_time:=1.4533, Sum_Search_time:=2.3018, Avg_Gap_init:=11.9464, Avg_Gap_best:=8.5974, Avg_Cost_init:=1.7896, Avg_Cost_best:=1.7359, Avg_Otpimal_best:=1.5970, Avg_counts: =16.7692] 43%|████▎     | 13/30 [00:06<00:07,  2.36it/s, Sum_GNN_time:=1.5129, Sum_Search_time:=2.4619, Avg_Gap_init:=11.8336, Avg_Gap_best:=8.5437, Avg_Cost_init:=1.7888, Avg_Cost_best:=1.7360, Avg_Otpimal_best:=1.5980, Avg_counts: =16.2857] 47%|████▋     | 14/30 [00:06<00:07,  2.26it/s, Sum_GNN_time:=1.5129, Sum_Search_time:=2.4619, Avg_Gap_init:=11.8336, Avg_Gap_best:=8.5437, Avg_Cost_init:=1.7888, Avg_Cost_best:=1.7360, Avg_Otpimal_best:=1.5980, Avg_counts: =16.2857] 47%|████▋     | 14/30 [00:07<00:07,  2.26it/s, Sum_GNN_time:=1.5692, Sum_Search_time:=2.6460, Avg_Gap_init:=11.6091, Avg_Gap_best:=8.3790, Avg_Cost_init:=1.7813, Avg_Cost_best:=1.7296, Avg_Otpimal_best:=1.5945, Avg_counts: =16.5333] 50%|█████     | 15/30 [00:07<00:06,  2.29it/s, Sum_GNN_time:=1.5692, Sum_Search_time:=2.6460, Avg_Gap_init:=11.6091, Avg_Gap_best:=8.3790, Avg_Cost_init:=1.7813, Avg_Cost_best:=1.7296, Avg_Otpimal_best:=1.5945, Avg_counts: =16.5333] 50%|█████     | 15/30 [00:07<00:06,  2.29it/s, Sum_GNN_time:=1.6274, Sum_Search_time:=2.8300, Avg_Gap_init:=11.8540, Avg_Gap_best:=8.3106, Avg_Cost_init:=1.7894, Avg_Cost_best:=1.7323, Avg_Otpimal_best:=1.5982, Avg_counts: =16.7500] 53%|█████▎    | 16/30 [00:07<00:06,  2.32it/s, Sum_GNN_time:=1.6274, Sum_Search_time:=2.8300, Avg_Gap_init:=11.8540, Avg_Gap_best:=8.3106, Avg_Cost_init:=1.7894, Avg_Cost_best:=1.7323, Avg_Otpimal_best:=1.5982, Avg_counts: =16.7500] 53%|█████▎    | 16/30 [00:08<00:06,  2.32it/s, Sum_GNN_time:=1.6865, Sum_Search_time:=2.9957, Avg_Gap_init:=11.9716, Avg_Gap_best:=8.3158, Avg_Cost_init:=1.7940, Avg_Cost_best:=1.7350, Avg_Otpimal_best:=1.6007, Avg_counts: =16.5294] 57%|█████▋    | 17/30 [00:08<00:05,  2.37it/s, Sum_GNN_time:=1.6865, Sum_Search_time:=2.9957, Avg_Gap_init:=11.9716, Avg_Gap_best:=8.3158, Avg_Cost_init:=1.7940, Avg_Cost_best:=1.7350, Avg_Otpimal_best:=1.6007, Avg_counts: =16.5294] 57%|█████▋    | 17/30 [00:08<00:05,  2.37it/s, Sum_GNN_time:=1.7419, Sum_Search_time:=3.1636, Avg_Gap_init:=11.8433, Avg_Gap_best:=8.1520, Avg_Cost_init:=1.7883, Avg_Cost_best:=1.7290, Avg_Otpimal_best:=1.5975, Avg_counts: =16.5000] 60%|██████    | 18/30 [00:08<00:04,  2.42it/s, Sum_GNN_time:=1.7419, Sum_Search_time:=3.1636, Avg_Gap_init:=11.8433, Avg_Gap_best:=8.1520, Avg_Cost_init:=1.7883, Avg_Cost_best:=1.7290, Avg_Otpimal_best:=1.5975, Avg_counts: =16.5000] 60%|██████    | 18/30 [00:09<00:04,  2.42it/s, Sum_GNN_time:=1.8019, Sum_Search_time:=3.3282, Avg_Gap_init:=11.8435, Avg_Gap_best:=8.2571, Avg_Cost_init:=1.7787, Avg_Cost_best:=1.7212, Avg_Otpimal_best:=1.5890, Avg_counts: =16.3158] 63%|██████▎   | 19/30 [00:09<00:04,  2.30it/s, Sum_GNN_time:=1.8019, Sum_Search_time:=3.3282, Avg_Gap_init:=11.8435, Avg_Gap_best:=8.2571, Avg_Cost_init:=1.7787, Avg_Cost_best:=1.7212, Avg_Otpimal_best:=1.5890, Avg_counts: =16.3158] 63%|██████▎   | 19/30 [00:09<00:04,  2.30it/s, Sum_GNN_time:=1.8580, Sum_Search_time:=3.4930, Avg_Gap_init:=11.5615, Avg_Gap_best:=8.1285, Avg_Cost_init:=1.7714, Avg_Cost_best:=1.7164, Avg_Otpimal_best:=1.5864, Avg_counts: =16.2000] 67%|██████▋   | 20/30 [00:09<00:04,  2.36it/s, Sum_GNN_time:=1.8580, Sum_Search_time:=3.4930, Avg_Gap_init:=11.5615, Avg_Gap_best:=8.1285, Avg_Cost_init:=1.7714, Avg_Cost_best:=1.7164, Avg_Otpimal_best:=1.5864, Avg_counts: =16.2000] 67%|██████▋   | 20/30 [00:09<00:04,  2.36it/s, Sum_GNN_time:=1.9131, Sum_Search_time:=3.6551, Avg_Gap_init:=11.6122, Avg_Gap_best:=7.9904, Avg_Cost_init:=1.7571, Avg_Cost_best:=1.7001, Avg_Otpimal_best:=1.5731, Avg_counts: =16.0476] 70%|███████   | 21/30 [00:09<00:03,  2.42it/s, Sum_GNN_time:=1.9131, Sum_Search_time:=3.6551, Avg_Gap_init:=11.6122, Avg_Gap_best:=7.9904, Avg_Cost_init:=1.7571, Avg_Cost_best:=1.7001, Avg_Otpimal_best:=1.5731, Avg_counts: =16.0476] 70%|███████   | 21/30 [00:10<00:03,  2.42it/s, Sum_GNN_time:=1.9688, Sum_Search_time:=3.8198, Avg_Gap_init:=11.5174, Avg_Gap_best:=7.9030, Avg_Cost_init:=1.7633, Avg_Cost_best:=1.7061, Avg_Otpimal_best:=1.5801, Avg_counts: =16.0455] 73%|███████▎  | 22/30 [00:10<00:03,  2.43it/s, Sum_GNN_time:=1.9688, Sum_Search_time:=3.8198, Avg_Gap_init:=11.5174, Avg_Gap_best:=7.9030, Avg_Cost_init:=1.7633, Avg_Cost_best:=1.7061, Avg_Otpimal_best:=1.5801, Avg_counts: =16.0455] 73%|███████▎  | 22/30 [00:10<00:03,  2.43it/s, Sum_GNN_time:=2.0280, Sum_Search_time:=3.9965, Avg_Gap_init:=11.2831, Avg_Gap_best:=7.7914, Avg_Cost_init:=1.7581, Avg_Cost_best:=1.7029, Avg_Otpimal_best:=1.5788, Avg_counts: =16.0435] 77%|███████▋  | 23/30 [00:10<00:02,  2.42it/s, Sum_GNN_time:=2.0280, Sum_Search_time:=3.9965, Avg_Gap_init:=11.2831, Avg_Gap_best:=7.7914, Avg_Cost_init:=1.7581, Avg_Cost_best:=1.7029, Avg_Otpimal_best:=1.5788, Avg_counts: =16.0435] 77%|███████▋  | 23/30 [00:11<00:02,  2.42it/s, Sum_GNN_time:=2.0874, Sum_Search_time:=4.1864, Avg_Gap_init:=11.5182, Avg_Gap_best:=7.9924, Avg_Cost_init:=1.7591, Avg_Cost_best:=1.7035, Avg_Otpimal_best:=1.5765, Avg_counts: =16.2083] 80%|████████  | 24/30 [00:11<00:02,  2.25it/s, Sum_GNN_time:=2.0874, Sum_Search_time:=4.1864, Avg_Gap_init:=11.5182, Avg_Gap_best:=7.9924, Avg_Cost_init:=1.7591, Avg_Cost_best:=1.7035, Avg_Otpimal_best:=1.5765, Avg_counts: =16.2083] 80%|████████  | 24/30 [00:11<00:02,  2.25it/s, Sum_GNN_time:=2.1464, Sum_Search_time:=4.3804, Avg_Gap_init:=11.5477, Avg_Gap_best:=7.9270, Avg_Cost_init:=1.7529, Avg_Cost_best:=1.6962, Avg_Otpimal_best:=1.5706, Avg_counts: =16.3600] 83%|████████▎ | 25/30 [00:11<00:02,  2.27it/s, Sum_GNN_time:=2.1464, Sum_Search_time:=4.3804, Avg_Gap_init:=11.5477, Avg_Gap_best:=7.9270, Avg_Cost_init:=1.7529, Avg_Cost_best:=1.6962, Avg_Otpimal_best:=1.5706, Avg_counts: =16.3600] 83%|████████▎ | 25/30 [00:12<00:02,  2.27it/s, Sum_GNN_time:=2.2037, Sum_Search_time:=4.5571, Avg_Gap_init:=11.3578, Avg_Gap_best:=7.8580, Avg_Cost_init:=1.7457, Avg_Cost_best:=1.6908, Avg_Otpimal_best:=1.5667, Avg_counts: =16.3462] 87%|████████▋ | 26/30 [00:12<00:01,  2.32it/s, Sum_GNN_time:=2.2037, Sum_Search_time:=4.5571, Avg_Gap_init:=11.3578, Avg_Gap_best:=7.8580, Avg_Cost_init:=1.7457, Avg_Cost_best:=1.6908, Avg_Otpimal_best:=1.5667, Avg_counts: =16.3462] 87%|████████▋ | 26/30 [00:12<00:01,  2.32it/s, Sum_GNN_time:=2.2592, Sum_Search_time:=4.7487, Avg_Gap_init:=11.3107, Avg_Gap_best:=7.9405, Avg_Cost_init:=1.7399, Avg_Cost_best:=1.6871, Avg_Otpimal_best:=1.5621, Avg_counts: =16.3333] 90%|█████████ | 27/30 [00:12<00:01,  2.34it/s, Sum_GNN_time:=2.2592, Sum_Search_time:=4.7487, Avg_Gap_init:=11.3107, Avg_Gap_best:=7.9405, Avg_Cost_init:=1.7399, Avg_Cost_best:=1.6871, Avg_Otpimal_best:=1.5621, Avg_counts: =16.3333] 90%|█████████ | 27/30 [00:12<00:01,  2.34it/s, Sum_GNN_time:=2.3145, Sum_Search_time:=4.9265, Avg_Gap_init:=11.2604, Avg_Gap_best:=7.8899, Avg_Cost_init:=1.7374, Avg_Cost_best:=1.6846, Avg_Otpimal_best:=1.5606, Avg_counts: =16.4643] 93%|█████████▎| 28/30 [00:12<00:00,  2.36it/s, Sum_GNN_time:=2.3145, Sum_Search_time:=4.9265, Avg_Gap_init:=11.2604, Avg_Gap_best:=7.8899, Avg_Cost_init:=1.7374, Avg_Cost_best:=1.6846, Avg_Otpimal_best:=1.5606, Avg_counts: =16.4643] 93%|█████████▎| 28/30 [00:13<00:00,  2.36it/s, Sum_GNN_time:=2.3697, Sum_Search_time:=5.1020, Avg_Gap_init:=11.3544, Avg_Gap_best:=7.9636, Avg_Cost_init:=1.7421, Avg_Cost_best:=1.6889, Avg_Otpimal_best:=1.5635, Avg_counts: =16.5862] 97%|█████████▋| 29/30 [00:13<00:00,  2.24it/s, Sum_GNN_time:=2.3697, Sum_Search_time:=5.1020, Avg_Gap_init:=11.3544, Avg_Gap_best:=7.9636, Avg_Cost_init:=1.7421, Avg_Cost_best:=1.6889, Avg_Otpimal_best:=1.5635, Avg_counts: =16.5862] 97%|█████████▋| 29/30 [00:13<00:00,  2.24it/s, Sum_GNN_time:=2.4278, Sum_Search_time:=5.2836, Avg_Gap_init:=11.4942, Avg_Gap_best:=8.0344, Avg_Cost_init:=1.7418, Avg_Cost_best:=1.6876, Avg_Otpimal_best:=1.5613, Avg_counts: =16.7000]100%|██████████| 30/30 [00:13<00:00,  2.29it/s, Sum_GNN_time:=2.4278, Sum_Search_time:=5.2836, Avg_Gap_init:=11.4942, Avg_Gap_best:=8.0344, Avg_Cost_init:=1.7418, Avg_Cost_best:=1.6876, Avg_Otpimal_best:=1.5613, Avg_counts: =16.7000]100%|██████████| 30/30 [00:13<00:00,  2.18it/s, Sum_GNN_time:=2.4278, Sum_Search_time:=5.2836, Avg_Gap_init:=11.4942, Avg_Gap_best:=8.0344, Avg_Cost_init:=1.7418, Avg_Cost_best:=1.6876, Avg_Otpimal_best:=1.5613, Avg_counts: =16.7000]
Total time for model prediction: 2.4278 seconds
Total time for guided local search: 5.2836 seconds
