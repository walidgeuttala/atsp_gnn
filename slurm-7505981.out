Namespace(data_dir='../tsp_input/generated_insatnces_3000_size_50/', tb_dir='../atsp_model_train_result', atsp_size=50, to_homo=False, half_st=False, model='HetroGATConcat', input_dim=1, hidden_dim=128, output_dim=1, relation_types='ss st tt pp', n_gnn_layers=4, n_heads=64, jk='cat', lr_init=0.001, lr_decay=0.95, min_delta=0.0001, patience=200, batch_size=15, n_epochs=100, checkpoint_freq=10, seed=4, n_trials=1, n_samples_result_train=30, device='cuda')
Namespace(atsp_size=100, data_path='../tsp_input/generated_insatnces_30_size_100', model_path='../atsp_model_train_result/Oct15_14-45-35_HetroGATConcat_trained_ATSP50/trial_0', time_limit=0.16, perturbation_moves=5, device='cuda')
device = cuda
model: HetroGATConcat trained in ATSP50 for 100 and tested in ATSP100 for 30
  0%|          | 0/30 [00:00<?, ?it/s]  0%|          | 0/30 [00:01<?, ?it/s, Sum_GNN_time:=0.7600, Sum_Search_time:=0.1618, Avg_Gap_init:=13.5182, Avg_Gap_best:=9.1334, Avg_Cost_init:=1.8177, Avg_Cost_best:=1.7475, Avg_Otpimal_best:=1.6012, Avg_counts: =10.0000]  3%|▎         | 1/30 [00:01<00:36,  1.27s/it, Sum_GNN_time:=0.7600, Sum_Search_time:=0.1618, Avg_Gap_init:=13.5182, Avg_Gap_best:=9.1334, Avg_Cost_init:=1.8177, Avg_Cost_best:=1.7475, Avg_Otpimal_best:=1.6012, Avg_counts: =10.0000]  3%|▎         | 1/30 [00:01<00:36,  1.27s/it, Sum_GNN_time:=0.8179, Sum_Search_time:=0.3220, Avg_Gap_init:=14.3272, Avg_Gap_best:=10.6276, Avg_Cost_init:=1.8705, Avg_Cost_best:=1.8102, Avg_Otpimal_best:=1.6358, Avg_counts: =15.0000]  7%|▋         | 2/30 [00:01<00:22,  1.26it/s, Sum_GNN_time:=0.8179, Sum_Search_time:=0.3220, Avg_Gap_init:=14.3272, Avg_Gap_best:=10.6276, Avg_Cost_init:=1.8705, Avg_Cost_best:=1.8102, Avg_Otpimal_best:=1.6358, Avg_counts: =15.0000]  7%|▋         | 2/30 [00:02<00:22,  1.26it/s, Sum_GNN_time:=0.8767, Sum_Search_time:=0.4985, Avg_Gap_init:=12.8256, Avg_Gap_best:=9.3688, Avg_Cost_init:=1.7717, Avg_Cost_best:=1.7173, Avg_Otpimal_best:=1.5684, Avg_counts: =16.0000]  10%|█         | 3/30 [00:02<00:16,  1.62it/s, Sum_GNN_time:=0.8767, Sum_Search_time:=0.4985, Avg_Gap_init:=12.8256, Avg_Gap_best:=9.3688, Avg_Cost_init:=1.7717, Avg_Cost_best:=1.7173, Avg_Otpimal_best:=1.5684, Avg_counts: =16.0000] 10%|█         | 3/30 [00:02<00:16,  1.62it/s, Sum_GNN_time:=0.9321, Sum_Search_time:=0.6587, Avg_Gap_init:=12.1238, Avg_Gap_best:=8.6971, Avg_Cost_init:=1.7355, Avg_Cost_best:=1.6824, Avg_Otpimal_best:=1.5460, Avg_counts: =16.0000] 13%|█▎        | 4/30 [00:02<00:13,  1.88it/s, Sum_GNN_time:=0.9321, Sum_Search_time:=0.6587, Avg_Gap_init:=12.1238, Avg_Gap_best:=8.6971, Avg_Cost_init:=1.7355, Avg_Cost_best:=1.6824, Avg_Otpimal_best:=1.5460, Avg_counts: =16.0000] 13%|█▎        | 4/30 [00:03<00:13,  1.88it/s, Sum_GNN_time:=0.9878, Sum_Search_time:=0.8308, Avg_Gap_init:=13.7221, Avg_Gap_best:=9.4171, Avg_Cost_init:=1.7397, Avg_Cost_best:=1.6743, Avg_Otpimal_best:=1.5292, Avg_counts: =17.6000] 17%|█▋        | 5/30 [00:03<00:13,  1.92it/s, Sum_GNN_time:=0.9878, Sum_Search_time:=0.8308, Avg_Gap_init:=13.7221, Avg_Gap_best:=9.4171, Avg_Cost_init:=1.7397, Avg_Cost_best:=1.6743, Avg_Otpimal_best:=1.5292, Avg_counts: =17.6000] 17%|█▋        | 5/30 [00:03<00:13,  1.92it/s, Sum_GNN_time:=1.0476, Sum_Search_time:=1.0105, Avg_Gap_init:=13.2874, Avg_Gap_best:=8.7099, Avg_Cost_init:=1.7522, Avg_Cost_best:=1.6815, Avg_Otpimal_best:=1.5465, Avg_counts: =17.6667] 20%|██        | 6/30 [00:03<00:11,  2.05it/s, Sum_GNN_time:=1.0476, Sum_Search_time:=1.0105, Avg_Gap_init:=13.2874, Avg_Gap_best:=8.7099, Avg_Cost_init:=1.7522, Avg_Cost_best:=1.6815, Avg_Otpimal_best:=1.5465, Avg_counts: =17.6667] 20%|██        | 6/30 [00:03<00:11,  2.05it/s, Sum_GNN_time:=1.1075, Sum_Search_time:=1.1848, Avg_Gap_init:=12.8755, Avg_Gap_best:=8.7354, Avg_Cost_init:=1.7744, Avg_Cost_best:=1.7102, Avg_Otpimal_best:=1.5725, Avg_counts: =17.7143] 23%|██▎       | 7/30 [00:03<00:10,  2.17it/s, Sum_GNN_time:=1.1075, Sum_Search_time:=1.1848, Avg_Gap_init:=12.8755, Avg_Gap_best:=8.7354, Avg_Cost_init:=1.7744, Avg_Cost_best:=1.7102, Avg_Otpimal_best:=1.5725, Avg_counts: =17.7143] 23%|██▎       | 7/30 [00:04<00:10,  2.17it/s, Sum_GNN_time:=1.1676, Sum_Search_time:=1.3490, Avg_Gap_init:=13.1325, Avg_Gap_best:=8.8566, Avg_Cost_init:=1.8223, Avg_Cost_best:=1.7538, Avg_Otpimal_best:=1.6105, Avg_counts: =16.7500] 27%|██▋       | 8/30 [00:04<00:09,  2.26it/s, Sum_GNN_time:=1.1676, Sum_Search_time:=1.3490, Avg_Gap_init:=13.1325, Avg_Gap_best:=8.8566, Avg_Cost_init:=1.8223, Avg_Cost_best:=1.7538, Avg_Otpimal_best:=1.6105, Avg_counts: =16.7500] 27%|██▋       | 8/30 [00:04<00:09,  2.26it/s, Sum_GNN_time:=1.2277, Sum_Search_time:=1.5265, Avg_Gap_init:=12.8857, Avg_Gap_best:=8.8626, Avg_Cost_init:=1.8113, Avg_Cost_best:=1.7470, Avg_Otpimal_best:=1.6043, Avg_counts: =16.6667] 30%|███       | 9/30 [00:04<00:09,  2.30it/s, Sum_GNN_time:=1.2277, Sum_Search_time:=1.5265, Avg_Gap_init:=12.8857, Avg_Gap_best:=8.8626, Avg_Cost_init:=1.8113, Avg_Cost_best:=1.7470, Avg_Otpimal_best:=1.6043, Avg_counts: =16.6667] 30%|███       | 9/30 [00:05<00:09,  2.30it/s, Sum_GNN_time:=1.2855, Sum_Search_time:=1.7076, Avg_Gap_init:=12.9012, Avg_Gap_best:=9.0399, Avg_Cost_init:=1.8228, Avg_Cost_best:=1.7608, Avg_Otpimal_best:=1.6142, Avg_counts: =17.4000] 33%|███▎      | 10/30 [00:05<00:09,  2.19it/s, Sum_GNN_time:=1.2855, Sum_Search_time:=1.7076, Avg_Gap_init:=12.9012, Avg_Gap_best:=9.0399, Avg_Cost_init:=1.8228, Avg_Cost_best:=1.7608, Avg_Otpimal_best:=1.6142, Avg_counts: =17.4000] 33%|███▎      | 10/30 [00:05<00:09,  2.19it/s, Sum_GNN_time:=1.3438, Sum_Search_time:=1.8733, Avg_Gap_init:=12.8475, Avg_Gap_best:=9.1165, Avg_Cost_init:=1.8369, Avg_Cost_best:=1.7766, Avg_Otpimal_best:=1.6276, Avg_counts: =16.7273] 37%|███▋      | 11/30 [00:05<00:08,  2.25it/s, Sum_GNN_time:=1.3438, Sum_Search_time:=1.8733, Avg_Gap_init:=12.8475, Avg_Gap_best:=9.1165, Avg_Cost_init:=1.8369, Avg_Cost_best:=1.7766, Avg_Otpimal_best:=1.6276, Avg_counts: =16.7273] 37%|███▋      | 11/30 [00:06<00:08,  2.25it/s, Sum_GNN_time:=1.4020, Sum_Search_time:=2.0375, Avg_Gap_init:=12.2208, Avg_Gap_best:=8.6845, Avg_Cost_init:=1.8047, Avg_Cost_best:=1.7479, Avg_Otpimal_best:=1.6067, Avg_counts: =16.8333] 40%|████      | 12/30 [00:06<00:07,  2.29it/s, Sum_GNN_time:=1.4020, Sum_Search_time:=2.0375, Avg_Gap_init:=12.2208, Avg_Gap_best:=8.6845, Avg_Cost_init:=1.8047, Avg_Cost_best:=1.7479, Avg_Otpimal_best:=1.6067, Avg_counts: =16.8333] 40%|████      | 12/30 [00:06<00:07,  2.29it/s, Sum_GNN_time:=1.4579, Sum_Search_time:=2.1995, Avg_Gap_init:=11.9464, Avg_Gap_best:=8.5539, Avg_Cost_init:=1.7896, Avg_Cost_best:=1.7352, Avg_Otpimal_best:=1.5970, Avg_counts: =16.7692] 43%|████▎     | 13/30 [00:06<00:07,  2.31it/s, Sum_GNN_time:=1.4579, Sum_Search_time:=2.1995, Avg_Gap_init:=11.9464, Avg_Gap_best:=8.5539, Avg_Cost_init:=1.7896, Avg_Cost_best:=1.7352, Avg_Otpimal_best:=1.5970, Avg_counts: =16.7692] 43%|████▎     | 13/30 [00:06<00:07,  2.31it/s, Sum_GNN_time:=1.5141, Sum_Search_time:=2.3613, Avg_Gap_init:=11.8336, Avg_Gap_best:=8.5033, Avg_Cost_init:=1.7888, Avg_Cost_best:=1.7354, Avg_Otpimal_best:=1.5980, Avg_counts: =16.8571] 47%|████▋     | 14/30 [00:06<00:07,  2.25it/s, Sum_GNN_time:=1.5141, Sum_Search_time:=2.3613, Avg_Gap_init:=11.8336, Avg_Gap_best:=8.5033, Avg_Cost_init:=1.7888, Avg_Cost_best:=1.7354, Avg_Otpimal_best:=1.5980, Avg_counts: =16.8571] 47%|████▋     | 14/30 [00:07<00:07,  2.25it/s, Sum_GNN_time:=1.5704, Sum_Search_time:=2.5214, Avg_Gap_init:=11.6091, Avg_Gap_best:=8.3412, Avg_Cost_init:=1.7813, Avg_Cost_best:=1.7290, Avg_Otpimal_best:=1.5945, Avg_counts: =16.5333] 50%|█████     | 15/30 [00:07<00:06,  2.34it/s, Sum_GNN_time:=1.5704, Sum_Search_time:=2.5214, Avg_Gap_init:=11.6091, Avg_Gap_best:=8.3412, Avg_Cost_init:=1.7813, Avg_Cost_best:=1.7290, Avg_Otpimal_best:=1.5945, Avg_counts: =16.5333] 50%|█████     | 15/30 [00:07<00:06,  2.34it/s, Sum_GNN_time:=1.6271, Sum_Search_time:=2.6991, Avg_Gap_init:=11.8540, Avg_Gap_best:=8.2699, Avg_Cost_init:=1.7894, Avg_Cost_best:=1.7317, Avg_Otpimal_best:=1.5982, Avg_counts: =17.0000] 53%|█████▎    | 16/30 [00:07<00:05,  2.37it/s, Sum_GNN_time:=1.6271, Sum_Search_time:=2.6991, Avg_Gap_init:=11.8540, Avg_Gap_best:=8.2699, Avg_Cost_init:=1.7894, Avg_Cost_best:=1.7317, Avg_Otpimal_best:=1.5982, Avg_counts: =17.0000] 53%|█████▎    | 16/30 [00:08<00:05,  2.37it/s, Sum_GNN_time:=1.6834, Sum_Search_time:=2.8656, Avg_Gap_init:=11.9716, Avg_Gap_best:=8.2776, Avg_Cost_init:=1.7940, Avg_Cost_best:=1.7345, Avg_Otpimal_best:=1.6007, Avg_counts: =17.0588] 57%|█████▋    | 17/30 [00:08<00:05,  2.40it/s, Sum_GNN_time:=1.6834, Sum_Search_time:=2.8656, Avg_Gap_init:=11.9716, Avg_Gap_best:=8.2776, Avg_Cost_init:=1.7940, Avg_Cost_best:=1.7345, Avg_Otpimal_best:=1.6007, Avg_counts: =17.0588] 57%|█████▋    | 17/30 [00:08<00:05,  2.40it/s, Sum_GNN_time:=1.7428, Sum_Search_time:=3.0454, Avg_Gap_init:=11.8433, Avg_Gap_best:=8.1159, Avg_Cost_init:=1.7883, Avg_Cost_best:=1.7285, Avg_Otpimal_best:=1.5975, Avg_counts: =17.1111] 60%|██████    | 18/30 [00:08<00:05,  2.39it/s, Sum_GNN_time:=1.7428, Sum_Search_time:=3.0454, Avg_Gap_init:=11.8433, Avg_Gap_best:=8.1159, Avg_Cost_init:=1.7883, Avg_Cost_best:=1.7285, Avg_Otpimal_best:=1.5975, Avg_counts: =17.1111] 60%|██████    | 18/30 [00:09<00:05,  2.39it/s, Sum_GNN_time:=1.8024, Sum_Search_time:=3.2166, Avg_Gap_init:=11.8435, Avg_Gap_best:=8.2229, Avg_Cost_init:=1.7787, Avg_Cost_best:=1.7207, Avg_Otpimal_best:=1.5890, Avg_counts: =17.1579] 63%|██████▎   | 19/30 [00:09<00:04,  2.25it/s, Sum_GNN_time:=1.8024, Sum_Search_time:=3.2166, Avg_Gap_init:=11.8435, Avg_Gap_best:=8.2229, Avg_Cost_init:=1.7787, Avg_Cost_best:=1.7207, Avg_Otpimal_best:=1.5890, Avg_counts: =17.1579] 63%|██████▎   | 19/30 [00:09<00:04,  2.25it/s, Sum_GNN_time:=1.8624, Sum_Search_time:=3.3954, Avg_Gap_init:=11.5615, Avg_Gap_best:=8.0959, Avg_Cost_init:=1.7714, Avg_Cost_best:=1.7159, Avg_Otpimal_best:=1.5864, Avg_counts: =17.1000] 67%|██████▋   | 20/30 [00:09<00:04,  2.28it/s, Sum_GNN_time:=1.8624, Sum_Search_time:=3.3954, Avg_Gap_init:=11.5615, Avg_Gap_best:=8.0959, Avg_Cost_init:=1.7714, Avg_Cost_best:=1.7159, Avg_Otpimal_best:=1.5864, Avg_counts: =17.1000] 67%|██████▋   | 20/30 [00:09<00:04,  2.28it/s, Sum_GNN_time:=1.9210, Sum_Search_time:=3.5724, Avg_Gap_init:=11.6122, Avg_Gap_best:=7.9594, Avg_Cost_init:=1.7571, Avg_Cost_best:=1.6997, Avg_Otpimal_best:=1.5731, Avg_counts: =17.1429] 70%|███████   | 21/30 [00:09<00:03,  2.30it/s, Sum_GNN_time:=1.9210, Sum_Search_time:=3.5724, Avg_Gap_init:=11.6122, Avg_Gap_best:=7.9594, Avg_Cost_init:=1.7571, Avg_Cost_best:=1.6997, Avg_Otpimal_best:=1.5731, Avg_counts: =17.1429] 70%|███████   | 21/30 [00:10<00:03,  2.30it/s, Sum_GNN_time:=1.9780, Sum_Search_time:=3.7376, Avg_Gap_init:=11.5174, Avg_Gap_best:=7.8734, Avg_Cost_init:=1.7633, Avg_Cost_best:=1.7057, Avg_Otpimal_best:=1.5801, Avg_counts: =17.1818] 73%|███████▎  | 22/30 [00:10<00:03,  2.36it/s, Sum_GNN_time:=1.9780, Sum_Search_time:=3.7376, Avg_Gap_init:=11.5174, Avg_Gap_best:=7.8734, Avg_Cost_init:=1.7633, Avg_Cost_best:=1.7057, Avg_Otpimal_best:=1.5801, Avg_counts: =17.1818] 73%|███████▎  | 22/30 [00:10<00:03,  2.36it/s, Sum_GNN_time:=2.0342, Sum_Search_time:=3.9006, Avg_Gap_init:=11.2831, Avg_Gap_best:=7.7632, Avg_Cost_init:=1.7581, Avg_Cost_best:=1.7025, Avg_Otpimal_best:=1.5788, Avg_counts: =17.2174] 77%|███████▋  | 23/30 [00:10<00:02,  2.42it/s, Sum_GNN_time:=2.0342, Sum_Search_time:=3.9006, Avg_Gap_init:=11.2831, Avg_Gap_best:=7.7632, Avg_Cost_init:=1.7581, Avg_Cost_best:=1.7025, Avg_Otpimal_best:=1.5788, Avg_counts: =17.2174] 77%|███████▋  | 23/30 [00:11<00:02,  2.42it/s, Sum_GNN_time:=2.0899, Sum_Search_time:=4.0612, Avg_Gap_init:=11.5182, Avg_Gap_best:=7.9654, Avg_Cost_init:=1.7591, Avg_Cost_best:=1.7031, Avg_Otpimal_best:=1.5765, Avg_counts: =17.1667] 80%|████████  | 24/30 [00:11<00:02,  2.29it/s, Sum_GNN_time:=2.0899, Sum_Search_time:=4.0612, Avg_Gap_init:=11.5182, Avg_Gap_best:=7.9654, Avg_Cost_init:=1.7591, Avg_Cost_best:=1.7031, Avg_Otpimal_best:=1.5765, Avg_counts: =17.1667] 80%|████████  | 24/30 [00:11<00:02,  2.29it/s, Sum_GNN_time:=2.1457, Sum_Search_time:=4.2382, Avg_Gap_init:=11.5477, Avg_Gap_best:=7.8798, Avg_Cost_init:=1.7529, Avg_Cost_best:=1.6955, Avg_Otpimal_best:=1.5706, Avg_counts: =17.4400] 83%|████████▎ | 25/30 [00:11<00:02,  2.32it/s, Sum_GNN_time:=2.1457, Sum_Search_time:=4.2382, Avg_Gap_init:=11.5477, Avg_Gap_best:=7.8798, Avg_Cost_init:=1.7529, Avg_Cost_best:=1.6955, Avg_Otpimal_best:=1.5706, Avg_counts: =17.4400] 83%|████████▎ | 25/30 [00:12<00:02,  2.32it/s, Sum_GNN_time:=2.2020, Sum_Search_time:=4.4109, Avg_Gap_init:=11.3578, Avg_Gap_best:=7.8126, Avg_Cost_init:=1.7457, Avg_Cost_best:=1.6902, Avg_Otpimal_best:=1.5667, Avg_counts: =17.4615] 87%|████████▋ | 26/30 [00:12<00:01,  2.37it/s, Sum_GNN_time:=2.2020, Sum_Search_time:=4.4109, Avg_Gap_init:=11.3578, Avg_Gap_best:=7.8126, Avg_Cost_init:=1.7457, Avg_Cost_best:=1.6902, Avg_Otpimal_best:=1.5667, Avg_counts: =17.4615] 87%|████████▋ | 26/30 [00:12<00:01,  2.37it/s, Sum_GNN_time:=2.2598, Sum_Search_time:=4.5795, Avg_Gap_init:=11.3107, Avg_Gap_best:=7.8968, Avg_Cost_init:=1.7399, Avg_Cost_best:=1.6864, Avg_Otpimal_best:=1.5621, Avg_counts: =17.4074] 90%|█████████ | 27/30 [00:12<00:01,  2.41it/s, Sum_GNN_time:=2.2598, Sum_Search_time:=4.5795, Avg_Gap_init:=11.3107, Avg_Gap_best:=7.8968, Avg_Cost_init:=1.7399, Avg_Cost_best:=1.6864, Avg_Otpimal_best:=1.5621, Avg_counts: =17.4074] 90%|█████████ | 27/30 [00:12<00:01,  2.41it/s, Sum_GNN_time:=2.3164, Sum_Search_time:=4.7612, Avg_Gap_init:=11.2604, Avg_Gap_best:=7.8381, Avg_Cost_init:=1.7374, Avg_Cost_best:=1.6839, Avg_Otpimal_best:=1.5606, Avg_counts: =17.6429] 93%|█████████▎| 28/30 [00:12<00:00,  2.36it/s, Sum_GNN_time:=2.3164, Sum_Search_time:=4.7612, Avg_Gap_init:=11.2604, Avg_Gap_best:=7.8381, Avg_Cost_init:=1.7374, Avg_Cost_best:=1.6839, Avg_Otpimal_best:=1.5606, Avg_counts: =17.6429] 93%|█████████▎| 28/30 [00:13<00:00,  2.36it/s, Sum_GNN_time:=2.3761, Sum_Search_time:=4.9239, Avg_Gap_init:=11.3544, Avg_Gap_best:=7.9136, Avg_Cost_init:=1.7421, Avg_Cost_best:=1.6882, Avg_Otpimal_best:=1.5635, Avg_counts: =17.7241] 97%|█████████▋| 29/30 [00:13<00:00,  2.23it/s, Sum_GNN_time:=2.3761, Sum_Search_time:=4.9239, Avg_Gap_init:=11.3544, Avg_Gap_best:=7.9136, Avg_Cost_init:=1.7421, Avg_Cost_best:=1.6882, Avg_Otpimal_best:=1.5635, Avg_counts: =17.7241] 97%|█████████▋| 29/30 [00:13<00:00,  2.23it/s, Sum_GNN_time:=2.4365, Sum_Search_time:=5.0863, Avg_Gap_init:=11.4942, Avg_Gap_best:=7.9860, Avg_Cost_init:=1.7418, Avg_Cost_best:=1.6869, Avg_Otpimal_best:=1.5613, Avg_counts: =17.8000]100%|██████████| 30/30 [00:13<00:00,  2.29it/s, Sum_GNN_time:=2.4365, Sum_Search_time:=5.0863, Avg_Gap_init:=11.4942, Avg_Gap_best:=7.9860, Avg_Cost_init:=1.7418, Avg_Cost_best:=1.6869, Avg_Otpimal_best:=1.5613, Avg_counts: =17.8000]100%|██████████| 30/30 [00:13<00:00,  2.18it/s, Sum_GNN_time:=2.4365, Sum_Search_time:=5.0863, Avg_Gap_init:=11.4942, Avg_Gap_best:=7.9860, Avg_Cost_init:=1.7418, Avg_Cost_best:=1.6869, Avg_Otpimal_best:=1.5613, Avg_counts: =17.8000]
Total time for model prediction: 2.4365 seconds
Total time for guided local search: 5.0863 seconds
